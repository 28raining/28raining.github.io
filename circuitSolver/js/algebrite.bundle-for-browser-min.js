(()=>{var FE=Object.create;var Ad=Object.defineProperty;var jE=Object.getOwnPropertyDescriptor;var zE=Object.getOwnPropertyNames;var YE=Object.getPrototypeOf,VE=Object.prototype.hasOwnProperty;var ZE=e=>Ad(e,"__esModule",{value:!0});var N=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var XE=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of zE(t))!VE.call(e,n)&&n!=="default"&&Ad(e,n,{get:()=>t[n],enumerable:!(r=jE(t,n))||r.enumerable});return e},HE=e=>XE(ZE(Ad(e!=null?FE(YE(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var Ps=N((a4,yu)=>{var Qt=function(e){"use strict";var t=1e7,r=7,n=9007199254740992,s=R(n),i="0123456789abcdefghijklmnopqrstuvwxyz",l=typeof BigInt=="function";function u(f,m,g,x){return typeof f=="undefined"?u[0]:typeof m!="undefined"?+m==10&&!g?Te(f):UE(f,m,g,x):Te(f)}function c(f,m){this.value=f,this.sign=m,this.isSmall=!1}c.prototype=Object.create(u.prototype);function d(f){this.value=f,this.sign=f<0,this.isSmall=!0}d.prototype=Object.create(u.prototype);function _(f){this.value=f}_.prototype=Object.create(u.prototype);function L(f){return-n<f&&f<n}function R(f){return f<1e7?[f]:f<1e14?[f%1e7,Math.floor(f/1e7)]:[f%1e7,Math.floor(f/1e7)%1e7,Math.floor(f/1e14)]}function C(f){Y(f);var m=f.length;if(m<4&&Kn(f,s)<0)switch(m){case 0:return 0;case 1:return f[0];case 2:return f[0]+f[1]*t;default:return f[0]+(f[1]+f[2]*t)*t}return f}function Y(f){for(var m=f.length;f[--m]===0;);f.length=m+1}function H(f){for(var m=new Array(f),g=-1;++g<f;)m[g]=0;return m}function Se(f){return f>0?Math.floor(f):Math.ceil(f)}function it(f,m){var g=f.length,x=m.length,I=new Array(g),O=0,U=t,P,G;for(G=0;G<x;G++)P=f[G]+m[G]+O,O=P>=U?1:0,I[G]=P-O*U;for(;G<g;)P=f[G]+O,O=P===U?1:0,I[G++]=P-O*U;return O>0&&I.push(O),I}function ct(f,m){return f.length>=m.length?it(f,m):it(m,f)}function Ye(f,m){var g=f.length,x=new Array(g),I=t,O,U;for(U=0;U<g;U++)O=f[U]-I+m,m=Math.floor(O/I),x[U]=O-m*I,m+=1;for(;m>0;)x[U++]=m%I,m=Math.floor(m/I);return x}c.prototype.add=function(f){var m=Te(f);if(this.sign!==m.sign)return this.subtract(m.negate());var g=this.value,x=m.value;return m.isSmall?new c(Ye(g,Math.abs(x)),this.sign):new c(ct(g,x),this.sign)},c.prototype.plus=c.prototype.add,d.prototype.add=function(f){var m=Te(f),g=this.value;if(g<0!==m.sign)return this.subtract(m.negate());var x=m.value;if(m.isSmall){if(L(g+x))return new d(g+x);x=R(Math.abs(x))}return new c(Ye(x,Math.abs(g)),g<0)},d.prototype.plus=d.prototype.add,_.prototype.add=function(f){return new _(this.value+Te(f).value)},_.prototype.plus=_.prototype.add;function xe(f,m){var g=f.length,x=m.length,I=new Array(g),O=0,U=t,P,G;for(P=0;P<x;P++)G=f[P]-O-m[P],G<0?(G+=U,O=1):O=0,I[P]=G;for(P=x;P<g;P++){if(G=f[P]-O,G<0)G+=U;else{I[P++]=G;break}I[P]=G}for(;P<g;P++)I[P]=f[P];return Y(I),I}function We(f,m,g){var x;return Kn(f,m)>=0?x=xe(f,m):(x=xe(m,f),g=!g),x=C(x),typeof x=="number"?(g&&(x=-x),new d(x)):new c(x,g)}function _t(f,m,g){var x=f.length,I=new Array(x),O=-m,U=t,P,G;for(P=0;P<x;P++)G=f[P]+O,O=Math.floor(G/U),G%=U,I[P]=G<0?G+U:G;return I=C(I),typeof I=="number"?(g&&(I=-I),new d(I)):new c(I,g)}c.prototype.subtract=function(f){var m=Te(f);if(this.sign!==m.sign)return this.add(m.negate());var g=this.value,x=m.value;return m.isSmall?_t(g,Math.abs(x),this.sign):We(g,x,this.sign)},c.prototype.minus=c.prototype.subtract,d.prototype.subtract=function(f){var m=Te(f),g=this.value;if(g<0!==m.sign)return this.add(m.negate());var x=m.value;return m.isSmall?new d(g-x):_t(x,Math.abs(g),g>=0)},d.prototype.minus=d.prototype.subtract,_.prototype.subtract=function(f){return new _(this.value-Te(f).value)},_.prototype.minus=_.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},d.prototype.negate=function(){var f=this.sign,m=new d(-this.value);return m.sign=!f,m},_.prototype.negate=function(){return new _(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},d.prototype.abs=function(){return new d(Math.abs(this.value))},_.prototype.abs=function(){return new _(this.value>=0?this.value:-this.value)};function hr(f,m){var g=f.length,x=m.length,I=g+x,O=H(I),U=t,P,G,Me,Xe,we;for(Me=0;Me<g;++Me){Xe=f[Me];for(var lt=0;lt<x;++lt)we=m[lt],P=Xe*we+O[Me+lt],G=Math.floor(P/U),O[Me+lt]=P-G*U,O[Me+lt+1]+=G}return Y(O),O}function _r(f,m){var g=f.length,x=new Array(g),I=t,O=0,U,P;for(P=0;P<g;P++)U=f[P]*m+O,O=Math.floor(U/I),x[P]=U-O*I;for(;O>0;)x[P++]=O%I,O=Math.floor(O/I);return x}function At(f,m){for(var g=[];m-- >0;)g.push(0);return g.concat(f)}function Fr(f,m){var g=Math.max(f.length,m.length);if(g<=30)return hr(f,m);g=Math.ceil(g/2);var x=f.slice(g),I=f.slice(0,g),O=m.slice(g),U=m.slice(0,g),P=Fr(I,U),G=Fr(x,O),Me=Fr(ct(I,x),ct(U,O)),Xe=ct(ct(P,At(xe(xe(Me,P),G),g)),At(G,2*g));return Y(Xe),Xe}function fu(f,m){return-.012*f-.012*m+15e-6*f*m>0}c.prototype.multiply=function(f){var m=Te(f),g=this.value,x=m.value,I=this.sign!==m.sign,O;if(m.isSmall){if(x===0)return u[0];if(x===1)return this;if(x===-1)return this.negate();if(O=Math.abs(x),O<t)return new c(_r(g,O),I);x=R(O)}return fu(g.length,x.length)?new c(Fr(g,x),I):new c(hr(g,x),I)},c.prototype.times=c.prototype.multiply;function Jn(f,m,g){return f<t?new c(_r(m,f),g):new c(hr(m,R(f)),g)}d.prototype._multiplyBySmall=function(f){return L(f.value*this.value)?new d(f.value*this.value):Jn(Math.abs(f.value),R(Math.abs(this.value)),this.sign!==f.sign)},c.prototype._multiplyBySmall=function(f){return f.value===0?u[0]:f.value===1?this:f.value===-1?this.negate():Jn(Math.abs(f.value),this.value,this.sign!==f.sign)},d.prototype.multiply=function(f){return Te(f)._multiplyBySmall(this)},d.prototype.times=d.prototype.multiply,_.prototype.multiply=function(f){return new _(this.value*Te(f).value)},_.prototype.times=_.prototype.multiply;function Xa(f){var m=f.length,g=H(m+m),x=t,I,O,U,P,G;for(U=0;U<m;U++){P=f[U],O=0-P*P;for(var Me=U;Me<m;Me++)G=f[Me],I=2*(P*G)+g[U+Me]+O,O=Math.floor(I/x),g[U+Me]=I-O*x;g[U+m]=O}return Y(g),g}c.prototype.square=function(){return new c(Xa(this.value),!1)},d.prototype.square=function(){var f=this.value*this.value;return L(f)?new d(f):new c(Xa(R(Math.abs(this.value))),!1)},_.prototype.square=function(f){return new _(this.value*this.value)};function du(f,m){var g=f.length,x=m.length,I=t,O=H(m.length),U=m[x-1],P=Math.ceil(I/(2*U)),G=_r(f,P),Me=_r(m,P),Xe,we,lt,jr,wr,xd,hd;for(G.length<=g&&G.push(0),Me.push(0),U=Me[x-1],we=g-x;we>=0;we--){for(Xe=I-1,G[we+x]!==U&&(Xe=Math.floor((G[we+x]*I+G[we+x-1])/U)),lt=0,jr=0,xd=Me.length,wr=0;wr<xd;wr++)lt+=Xe*Me[wr],hd=Math.floor(lt/I),jr+=G[we+wr]-(lt-hd*I),lt=hd,jr<0?(G[we+wr]=jr+I,jr=-1):(G[we+wr]=jr,jr=0);for(;jr!==0;){for(Xe-=1,lt=0,wr=0;wr<xd;wr++)lt+=G[we+wr]-I+Me[wr],lt<0?(G[we+wr]=lt+I,lt=0):(G[we+wr]=lt,lt=1);jr+=lt}O[we]=Xe}return G=Ha(G,P)[0],[C(O),C(G)]}function mu(f,m){for(var g=f.length,x=m.length,I=[],O=[],U=t,P,G,Me,Xe,we;g;){if(O.unshift(f[--g]),Y(O),Kn(O,m)<0){I.push(0);continue}G=O.length,Me=O[G-1]*U+O[G-2],Xe=m[x-1]*U+m[x-2],G>x&&(Me=(Me+1)*U),P=Math.ceil(Me/Xe);do{if(we=_r(m,P),Kn(we,O)<=0)break;P--}while(P);I.push(P),O=xe(O,we)}return I.reverse(),[C(I),C(O)]}function Ha(f,m){var g=f.length,x=H(g),I=t,O,U,P,G;for(P=0,O=g-1;O>=0;--O)G=P*I+f[O],U=Se(G/m),P=G-U*m,x[O]=U|0;return[x,P|0]}function ln(f,m){var g,x=Te(m);if(l)return[new _(f.value/x.value),new _(f.value%x.value)];var I=f.value,O=x.value,U;if(O===0)throw new Error("Cannot divide by zero");if(f.isSmall)return x.isSmall?[new d(Se(I/O)),new d(I%O)]:[u[0],f];if(x.isSmall){if(O===1)return[f,u[0]];if(O==-1)return[f.negate(),u[0]];var P=Math.abs(O);if(P<t){g=Ha(I,P),U=C(g[0]);var G=g[1];return f.sign&&(G=-G),typeof U=="number"?(f.sign!==x.sign&&(U=-U),[new d(U),new d(G)]):[new c(U,f.sign!==x.sign),new d(G)]}O=R(P)}var Me=Kn(I,O);if(Me===-1)return[u[0],f];if(Me===0)return[u[f.sign===x.sign?1:-1],u[0]];I.length+O.length<=200?g=du(I,O):g=mu(I,O),U=g[0];var Xe=f.sign!==x.sign,we=g[1],lt=f.sign;return typeof U=="number"?(Xe&&(U=-U),U=new d(U)):U=new c(U,Xe),typeof we=="number"?(lt&&(we=-we),we=new d(we)):we=new c(we,lt),[U,we]}c.prototype.divmod=function(f){var m=ln(this,f);return{quotient:m[0],remainder:m[1]}},_.prototype.divmod=d.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(f){return ln(this,f)[0]},_.prototype.over=_.prototype.divide=function(f){return new _(this.value/Te(f).value)},d.prototype.over=d.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(f){return ln(this,f)[1]},_.prototype.mod=_.prototype.remainder=function(f){return new _(this.value%Te(f).value)},d.prototype.remainder=d.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(f){var m=Te(f),g=this.value,x=m.value,I,O,U;if(x===0)return u[1];if(g===0)return u[0];if(g===1)return u[1];if(g===-1)return m.isEven()?u[1]:u[-1];if(m.sign)return u[0];if(!m.isSmall)throw new Error("The exponent "+m.toString()+" is too large.");if(this.isSmall&&L(I=Math.pow(g,x)))return new d(Se(I));for(O=this,U=u[1];x&!0&&(U=U.times(O),--x),x!==0;)x/=2,O=O.square();return U},d.prototype.pow=c.prototype.pow,_.prototype.pow=function(f){var m=Te(f),g=this.value,x=m.value,I=BigInt(0),O=BigInt(1),U=BigInt(2);if(x===I)return u[1];if(g===I)return u[0];if(g===O)return u[1];if(g===BigInt(-1))return m.isEven()?u[1]:u[-1];if(m.isNegative())return new _(I);for(var P=this,G=u[1];(x&O)===O&&(G=G.times(P),--x),x!==I;)x/=U,P=P.square();return G},c.prototype.modPow=function(f,m){if(f=Te(f),m=Te(m),m.isZero())throw new Error("Cannot take modPow with modulus 0");var g=u[1],x=this.mod(m);for(f.isNegative()&&(f=f.multiply(u[-1]),x=x.modInv(m));f.isPositive();){if(x.isZero())return u[0];f.isOdd()&&(g=g.multiply(x).mod(m)),f=f.divide(2),x=x.square().mod(m)}return g},_.prototype.modPow=d.prototype.modPow=c.prototype.modPow;function Kn(f,m){if(f.length!==m.length)return f.length>m.length?1:-1;for(var g=f.length-1;g>=0;g--)if(f[g]!==m[g])return f[g]>m[g]?1:-1;return 0}c.prototype.compareAbs=function(f){var m=Te(f),g=this.value,x=m.value;return m.isSmall?1:Kn(g,x)},d.prototype.compareAbs=function(f){var m=Te(f),g=Math.abs(this.value),x=m.value;return m.isSmall?(x=Math.abs(x),g===x?0:g>x?1:-1):-1},_.prototype.compareAbs=function(f){var m=this.value,g=Te(f).value;return m=m>=0?m:-m,g=g>=0?g:-g,m===g?0:m>g?1:-1},c.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var m=Te(f),g=this.value,x=m.value;return this.sign!==m.sign?m.sign?1:-1:m.isSmall?this.sign?-1:1:Kn(g,x)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,d.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var m=Te(f),g=this.value,x=m.value;return m.isSmall?g==x?0:g>x?1:-1:g<0!==m.sign?g<0?-1:1:g<0?1:-1},d.prototype.compareTo=d.prototype.compare,_.prototype.compare=function(f){if(f===1/0)return-1;if(f===-1/0)return 1;var m=this.value,g=Te(f).value;return m===g?0:m>g?1:-1},_.prototype.compareTo=_.prototype.compare,c.prototype.equals=function(f){return this.compare(f)===0},_.prototype.eq=_.prototype.equals=d.prototype.eq=d.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(f){return this.compare(f)!==0},_.prototype.neq=_.prototype.notEquals=d.prototype.neq=d.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(f){return this.compare(f)>0},_.prototype.gt=_.prototype.greater=d.prototype.gt=d.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(f){return this.compare(f)<0},_.prototype.lt=_.prototype.lesser=d.prototype.lt=d.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(f){return this.compare(f)>=0},_.prototype.geq=_.prototype.greaterOrEquals=d.prototype.geq=d.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(f){return this.compare(f)<=0},_.prototype.leq=_.prototype.lesserOrEquals=d.prototype.leq=d.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return(this.value[0]&1)==0},d.prototype.isEven=function(){return(this.value&1)==0},_.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return(this.value[0]&1)==1},d.prototype.isOdd=function(){return(this.value&1)==1},_.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},d.prototype.isPositive=function(){return this.value>0},_.prototype.isPositive=d.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},d.prototype.isNegative=function(){return this.value<0},_.prototype.isNegative=d.prototype.isNegative,c.prototype.isUnit=function(){return!1},d.prototype.isUnit=function(){return Math.abs(this.value)===1},_.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},d.prototype.isZero=function(){return this.value===0},_.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(f){var m=Te(f);return m.isZero()?!1:m.isUnit()?!0:m.compareAbs(2)===0?this.isEven():this.mod(m).isZero()},_.prototype.isDivisibleBy=d.prototype.isDivisibleBy=c.prototype.isDivisibleBy;function _u(f){var m=f.abs();if(m.isUnit())return!1;if(m.equals(2)||m.equals(3)||m.equals(5))return!0;if(m.isEven()||m.isDivisibleBy(3)||m.isDivisibleBy(5))return!1;if(m.lesser(49))return!0}function Qa(f,m){for(var g=f.prev(),x=g,I=0,O,U,P,G;x.isEven();)x=x.divide(2),I++;e:for(P=0;P<m.length;P++)if(!f.lesser(m[P])&&(G=Qt(m[P]).modPow(x,f),!(G.isUnit()||G.equals(g)))){for(O=I-1;O!=0;O--){if(G=G.square().mod(f),G.isUnit())return!1;if(G.equals(g))continue e}return!1}return!0}c.prototype.isPrime=function(f){var m=_u(this);if(m!==e)return m;var g=this.abs(),x=g.bitLength();if(x<=64)return Qa(g,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var I=Math.log(2)*x.toJSNumber(),O=Math.ceil(f===!0?2*Math.pow(I,2):I),U=[],P=0;P<O;P++)U.push(Qt(P+2));return Qa(g,U)},_.prototype.isPrime=d.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(f,m){var g=_u(this);if(g!==e)return g;for(var x=this.abs(),I=f===e?5:f,O=[],U=0;U<I;U++)O.push(Qt.randBetween(2,x.minus(2),m));return Qa(x,O)},_.prototype.isProbablePrime=d.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(f){for(var m=Qt.zero,g=Qt.one,x=Te(f),I=this.abs(),O,U,P;!I.isZero();)O=x.divide(I),U=m,P=x,m=g,x=I,g=U.subtract(O.multiply(g)),I=P.subtract(O.multiply(I));if(!x.isUnit())throw new Error(this.toString()+" and "+f.toString()+" are not co-prime");return m.compare(0)===-1&&(m=m.add(f)),this.isNegative()?m.negate():m},_.prototype.modInv=d.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var f=this.value;return this.sign?_t(f,1,this.sign):new c(Ye(f,1),this.sign)},d.prototype.next=function(){var f=this.value;return f+1<n?new d(f+1):new c(s,!1)},_.prototype.next=function(){return new _(this.value+BigInt(1))},c.prototype.prev=function(){var f=this.value;return this.sign?new c(Ye(f,1),!0):_t(f,1,this.sign)},d.prototype.prev=function(){var f=this.value;return f-1>-n?new d(f-1):new c(s,!0)},_.prototype.prev=function(){return new _(this.value-BigInt(1))};for(var un=[1];2*un[un.length-1]<=t;)un.push(2*un[un.length-1]);var _i=un.length,es=un[_i-1];function bu(f){return Math.abs(f)<=t}c.prototype.shiftLeft=function(f){var m=Te(f).toJSNumber();if(!bu(m))throw new Error(String(m)+" is too large for shifting.");if(m<0)return this.shiftRight(-m);var g=this;if(g.isZero())return g;for(;m>=_i;)g=g.multiply(es),m-=_i-1;return g.multiply(un[m])},_.prototype.shiftLeft=d.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(f){var m,g=Te(f).toJSNumber();if(!bu(g))throw new Error(String(g)+" is too large for shifting.");if(g<0)return this.shiftLeft(-g);for(var x=this;g>=_i;){if(x.isZero()||x.isNegative()&&x.isUnit())return x;m=ln(x,es),x=m[1].isNegative()?m[0].prev():m[0],g-=_i-1}return m=ln(x,un[g]),m[1].isNegative()?m[0].prev():m[0]},_.prototype.shiftRight=d.prototype.shiftRight=c.prototype.shiftRight;function Wa(f,m,g){m=Te(m);for(var x=f.isNegative(),I=m.isNegative(),O=x?f.not():f,U=I?m.not():m,P=0,G=0,Me=null,Xe=null,we=[];!O.isZero()||!U.isZero();)Me=ln(O,es),P=Me[1].toJSNumber(),x&&(P=es-1-P),Xe=ln(U,es),G=Xe[1].toJSNumber(),I&&(G=es-1-G),O=Me[0],U=Xe[0],we.push(g(P,G));for(var lt=g(x?1:0,I?1:0)!==0?Qt(-1):Qt(0),jr=we.length-1;jr>=0;jr-=1)lt=lt.multiply(es).add(Qt(we[jr]));return lt}c.prototype.not=function(){return this.negate().prev()},_.prototype.not=d.prototype.not=c.prototype.not,c.prototype.and=function(f){return Wa(this,f,function(m,g){return m&g})},_.prototype.and=d.prototype.and=c.prototype.and,c.prototype.or=function(f){return Wa(this,f,function(m,g){return m|g})},_.prototype.or=d.prototype.or=c.prototype.or,c.prototype.xor=function(f){return Wa(this,f,function(m,g){return m^g})},_.prototype.xor=d.prototype.xor=c.prototype.xor;var Ja=1<<30,Ed=(t&-t)*(t&-t)|Ja;function eo(f){var m=f.value,g=typeof m=="number"?m|Ja:typeof m=="bigint"?m|BigInt(Ja):m[0]+m[1]*t|Ed;return g&-g}function gu(f,m){if(m.compareTo(f)<=0){var g=gu(f,m.square(m)),x=g.p,I=g.e,O=x.multiply(m);return O.compareTo(f)<=0?{p:O,e:I*2+1}:{p:x,e:I*2}}return{p:Qt(1),e:0}}c.prototype.bitLength=function(){var f=this;return f.compareTo(Qt(0))<0&&(f=f.negate().subtract(Qt(1))),f.compareTo(Qt(0))===0?Qt(0):Qt(gu(f,Qt(2)).e).add(Qt(1))},_.prototype.bitLength=d.prototype.bitLength=c.prototype.bitLength;function Ka(f,m){return f=Te(f),m=Te(m),f.greater(m)?f:m}function to(f,m){return f=Te(f),m=Te(m),f.lesser(m)?f:m}function Rb(f,m){if(f=Te(f).abs(),m=Te(m).abs(),f.equals(m))return f;if(f.isZero())return m;if(m.isZero())return f;for(var g=u[1],x,I;f.isEven()&&m.isEven();)x=to(eo(f),eo(m)),f=f.divide(x),m=m.divide(x),g=g.multiply(x);for(;f.isEven();)f=f.divide(eo(f));do{for(;m.isEven();)m=m.divide(eo(m));f.greater(m)&&(I=m,m=f,f=I),m=m.subtract(f)}while(!m.isZero());return g.isUnit()?f:f.multiply(g)}function DE(f,m){return f=Te(f).abs(),m=Te(m).abs(),f.divide(Rb(f,m)).multiply(m)}function $E(f,m,g){f=Te(f),m=Te(m);var x=g||Math.random,I=to(f,m),O=Ka(f,m),U=O.subtract(I).add(1);if(U.isSmall)return I.add(Math.floor(x()*U));for(var P=el(U,t).value,G=[],Me=!0,Xe=0;Xe<P.length;Xe++){var we=Me?P[Xe]+(Xe+1<P.length?P[Xe+1]/t:0):t,lt=Se(x()*we);G.push(lt),lt<P[Xe]&&(Me=!1)}return I.add(u.fromArray(G,t,!1))}var UE=function(f,m,g,x){g=g||i,f=String(f),x||(f=f.toLowerCase(),g=g.toLowerCase());var I=f.length,O,U=Math.abs(m),P={};for(O=0;O<g.length;O++)P[g[O]]=O;for(O=0;O<I;O++){var G=f[O];if(G!=="-"&&G in P&&P[G]>=U){if(G==="1"&&U===1)continue;throw new Error(G+" is not a valid digit in base "+m+".")}}m=Te(m);var Me=[],Xe=f[0]==="-";for(O=Xe?1:0;O<f.length;O++){var G=f[O];if(G in P)Me.push(Te(P[G]));else if(G==="<"){var we=O;do O++;while(f[O]!==">"&&O<f.length);Me.push(Te(f.slice(we+1,O)))}else throw new Error(G+" is not a valid character")}return wb(Me,m,Xe)};function wb(f,m,g){var x=u[0],I=u[1],O;for(O=f.length-1;O>=0;O--)x=x.add(f[O].times(I)),I=I.times(m);return g?x.negate():x}function BE(f,m){return m=m||i,f<m.length?m[f]:"<"+f+">"}function el(f,m){if(m=Qt(m),m.isZero()){if(f.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(m.equals(-1)){if(f.isZero())return{value:[0],isNegative:!1};if(f.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-f.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var g=Array.apply(null,Array(f.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return g.unshift([1]),{value:[].concat.apply([],g),isNegative:!1}}var x=!1;if(f.isNegative()&&m.isPositive()&&(x=!0,f=f.abs()),m.isUnit())return f.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(f.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:x};for(var I=[],O=f,U;O.isNegative()||O.compareAbs(m)>=0;){U=O.divmod(m),O=U.quotient;var P=U.remainder;P.isNegative()&&(P=m.minus(P).abs(),O=O.next()),I.push(P.toJSNumber())}return I.push(O.toJSNumber()),{value:I.reverse(),isNegative:x}}function Lb(f,m,g){var x=el(f,m);return(x.isNegative?"-":"")+x.value.map(function(I){return BE(I,g)}).join("")}c.prototype.toArray=function(f){return el(this,f)},d.prototype.toArray=function(f){return el(this,f)},_.prototype.toArray=function(f){return el(this,f)},c.prototype.toString=function(f,m){if(f===e&&(f=10),f!==10)return Lb(this,f,m);for(var g=this.value,x=g.length,I=String(g[--x]),O="0000000",U;--x>=0;)U=String(g[x]),I+=O.slice(U.length)+U;var P=this.sign?"-":"";return P+I},d.prototype.toString=function(f,m){return f===e&&(f=10),f!=10?Lb(this,f,m):String(this.value)},_.prototype.toString=d.prototype.toString,_.prototype.toJSON=c.prototype.toJSON=d.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,d.prototype.valueOf=function(){return this.value},d.prototype.toJSNumber=d.prototype.valueOf,_.prototype.valueOf=_.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function Cb(f){if(L(+f)){var m=+f;if(m===Se(m))return l?new _(BigInt(m)):new d(m);throw new Error("Invalid integer: "+f)}var g=f[0]==="-";g&&(f=f.slice(1));var x=f.split(/e/i);if(x.length>2)throw new Error("Invalid integer: "+x.join("e"));if(x.length===2){var I=x[1];if(I[0]==="+"&&(I=I.slice(1)),I=+I,I!==Se(I)||!L(I))throw new Error("Invalid integer: "+I+" is not a valid exponent.");var O=x[0],U=O.indexOf(".");if(U>=0&&(I-=O.length-U-1,O=O.slice(0,U)+O.slice(U+1)),I<0)throw new Error("Cannot include negative exponent part for integers");O+=new Array(I+1).join("0"),f=O}var P=/^([0-9][0-9]*)$/.test(f);if(!P)throw new Error("Invalid integer: "+f);if(l)return new _(BigInt(g?"-"+f:f));for(var G=[],Me=f.length,Xe=r,we=Me-Xe;Me>0;)G.push(+f.slice(we,Me)),we-=Xe,we<0&&(we=0),Me-=Xe;return Y(G),new c(G,g)}function GE(f){if(l)return new _(BigInt(f));if(L(f)){if(f!==Se(f))throw new Error(f+" is not an integer.");return new d(f)}return Cb(f.toString())}function Te(f){return typeof f=="number"?GE(f):typeof f=="string"?Cb(f):typeof f=="bigint"?new _(f):f}for(var bi=0;bi<1e3;bi++)u[bi]=Te(bi),bi>0&&(u[-bi]=Te(-bi));return u.one=u[1],u.zero=u[0],u.minusOne=u[-1],u.max=Ka,u.min=to,u.gcd=Rb,u.lcm=DE,u.isInstance=function(f){return f instanceof c||f instanceof d||f instanceof _},u.randBetween=$E,u.fromArray=function(f,m,g){return wb(f.map(Te),Te(m||10),g)},u}();typeof yu!="undefined"&&yu.hasOwnProperty("exports")&&(yu.exports=Qt);typeof define=="function"&&define.amd&&define(function(){return Qt})});var vu=N(ro=>{"use strict";var QE=ro&&ro.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ro,"__esModule",{value:!0});ro.mcmp=void 0;var l4=QE(Ps());function WE(e,t){return e.compare(t)}ro.mcmp=WE});var Db=N(no=>{"use strict";Object.defineProperty(no,"__esModule",{value:!0});no.set_component=no.index_function=void 0;var kb=Pt(),ts=w(),An=Oe(),pu=B(),Pb=Z(),gi=Et();function JE(e){let t=0,r=e[t],{ndim:n}=r.tensor,s=e.length-1;s>n&&An.stop("too many indices for tensor");let i=0;for(let c=0;c<s;c++){let d=Pb.nativeInt(e[t+c+1]);(d<1||d>r.tensor.dim[c])&&An.stop("index out of range"),i=i*r.tensor.dim[c]+d-1}if(n===s)return r.tensor.elem[i];i=r.tensor.dim.slice(s).reduce((c,d)=>c*d,i);let l=r.tensor.dim.slice(s).reduce((c,d)=>c*d,1),u=kb.alloc_tensor(l);u.tensor.ndim=n-s,u.tensor.dim=r.tensor.dim.slice(s);for(let c=0;c<l;c++)u.tensor.elem[c]=r.tensor.elem[i+c];return gi.check_tensor_dimensions(r),gi.check_tensor_dimensions(u),u}no.index_function=JE;function KE(e){e<3&&An.stop("error in indexed assign");let t=ts.defs.tos-e,r=ts.defs.stack[t],n=ts.defs.stack[t+1];ts.istensor(n)||An.stop("error in indexed assign: assigning to something that is not a tensor");let{ndim:s}=n.tensor,i=e-2;i>s&&An.stop("error in indexed assign");let l=0;for(let c=0;c<i;c++){let d=Pb.nativeInt(ts.defs.stack[t+c+2]);(d<1||d>n.tensor.dim[c])&&An.stop(`error in indexed assign
`),l=l*n.tensor.dim[c]+d-1}for(let c=i;c<s;c++)l=l*n.tensor.dim[c]+0;let u=kb.alloc_tensor(n.tensor.nelem);if(u.tensor.ndim=n.tensor.ndim,u.tensor.dim=Array.from(n.tensor.dim),u.tensor.elem=Array.from(n.tensor.elem),gi.check_tensor_dimensions(n),gi.check_tensor_dimensions(u),n=u,s===i){ts.istensor(r)&&An.stop("error in indexed assign"),n.tensor.elem[l]=r,gi.check_tensor_dimensions(n),pu.moveTos(ts.defs.tos-e),pu.push(n);return}ts.istensor(r)||An.stop("error in indexed assign"),s-i!==r.tensor.ndim&&An.stop("error in indexed assign");for(let c=0;c<r.tensor.ndim;c++)n.tensor.dim[i+c]!==r.tensor.dim[c]&&An.stop("error in indexed assign");for(let c=0;c<r.tensor.nelem;c++)n.tensor.elem[l+c]=r.tensor.elem[c];gi.check_tensor_dimensions(n),gi.check_tensor_dimensions(r),pu.moveTos(ts.defs.tos-e),pu.push(n)}no.set_component=KE});var xu=N(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.countsize=Ds.countOccurrencesOfSymbol=Ds.count=void 0;var ex=Re(),qu=w(),Od=e=>e.reduce((t,r)=>t+r,0);function Eu(e){let t;if(qu.iscons(e)){let r=[...e];t=Od(r.map(Eu))+r.length}else t=1;return t}Ds.count=Eu;function $b(e,t){let r=0;return qu.iscons(t)?r=Od([...t].map(n=>$b(e,n))):ex.equal(e,t)&&(r=1),r}Ds.countOccurrencesOfSymbol=$b;function tx(e){let t=0;if(qu.istensor(e))for(let r=0;r<e.tensor.nelem;r++)t+=Eu(e.tensor.elem[r]);else if(qu.iscons(e)){let r=[...e];t=Od(r.map(Eu))+r.length}else t=1;return t}Ds.countsize=tx});var dt=N(Dt=>{"use strict";Object.defineProperty(Dt,"__esModule",{value:!0});Dt.collectUserSymbols=Dt.clear_symbols=Dt.push_symbol=Dt.symnum=Dt.get_binding=Dt.set_binding=Dt.get_printname=Dt.usr_symbol=Dt.std_symbol=Dt.Eval_symbolsinfo=void 0;var tl=Oe(),rx=B(),nx=Re(),sx=xu(),ue=w();function ix(){let e=ox();e!==""?nx.new_string(e):Gb(ue.NIL)}Dt.Eval_symbolsinfo=ix;function ox(){let e="";for(let t=ue.NIL+1;t<ue.symtab.length;t++){if(ue.symtab[t].printname===""){if(ue.isSymbolReclaimable[t]===!1)break;continue}let r=ue.symtab[t]+"",n=(ue.binding[t]+"").substring(0,4);e+="symbol: "+r+" size: "+sx.countsize(ue.binding[t])+" value: "+n+`...
`}return e}function ax(e,t,r){let n=ue.symtab[t];n==null&&ue.breakpoint,n.printname=e,r!=null?n.latexPrint=r:n.latexPrint=e}Dt.std_symbol=ax;function lx(e){let t=0;for(t=0;t<ue.NSYM;t++){if(e===ue.symtab[t].printname)return ue.symtab[t];if(ue.symtab[t].printname==="")break}return t===ue.NSYM&&tl.stop("symbol table overflow"),ue.symtab[t]=new ue.Sym(e),ue.binding[t]=ue.symtab[t],ue.isSymbolReclaimable[t]=!1,ue.symtab[t]}Dt.usr_symbol=lx;function ux(e){return e.k!==ue.SYM&&tl.stop("symbol error"),e.printname}Dt.get_printname=ux;function cx(e,t){e.k!==ue.SYM&&tl.stop("symbol error");let r=ue.symtab.indexOf(e);ue.symtab.indexOf(e,r+1)!==-1&&(console.log("ops, more than one element!"),ue.breakpoint),ue.DEBUG&&console.log(`lookup >> set_binding lookup ${r}`),ue.isSymbolReclaimable[r]=!1,ue.binding[r]=t}Dt.set_binding=cx;function fx(e){e.k!==ue.SYM&&tl.stop("symbol error");let t=ue.symtab.indexOf(e);return ue.symtab.indexOf(e,t+1)!==-1&&(console.log("ops, more than one element!"),ue.breakpoint),ue.DEBUG&&console.log(`lookup >> get_binding lookup ${t}`),ue.binding[t]}Dt.get_binding=fx;function dx(e){if(e.k!==ue.SYM)return!1;let t=Bb(e);return t>ue.PI&&t!==ue.SYMBOL_I&&t!==ue.SYMBOL_IDENTITY_MATRIX}var Ub=0;function Bb(e){Ub++,e.k!==ue.SYM&&tl.stop("symbol error");let t=ue.symtab.indexOf(e);return ue.symtab.indexOf(e,t+1)!==-1&&(console.log("ops, more than one element!"),ue.breakpoint),ue.DEBUG&&console.log(`lookup >> symnum lookup ${t} lookup # ${Ub}`),t}Dt.symnum=Bb;function Gb(e){rx.push(ue.symtab[e])}Dt.push_symbol=Gb;function mx(){for(let e=ue.NIL+1;e<ue.NSYM;e++){if(ue.symtab[e].printname===""){if(ue.isSymbolReclaimable[e]===!1)break;continue}ue.symtab[e]=new ue.Sym(""),ue.binding[e]=ue.symtab[e],ue.isSymbolReclaimable[e]=!1}}Dt.clear_symbols=mx;function Td(e,t){if(t==null&&(t=[]),dx(e)&&t.indexOf(e)===-1){t.push(e);return}if(ue.istensor(e)){for(let r=0;r<e.tensor.nelem;r++)Td(e.tensor.elem[r],t);return}for(;ue.iscons(e);)Td(ue.car(e),t),e=ue.cdr(e)}Dt.collectUserSymbols=Td});var oe=N(io=>{"use strict";Object.defineProperty(io,"__esModule",{value:!0});io.makeList=io.list=void 0;var so=w(),hu=B();function _x(e){hu.push(so.symbol(so.NIL));for(let t=0;t<e;t++){let r=hu.pop(),n=hu.pop();hu.push(new so.Cons(n,r))}}io.list=_x;function bx(...e){let t=so.symbol(so.NIL);for(let r=e.length-1;r>=0;r--)t=new so.Cons(e[r],t);return t}io.makeList=bx});var rs=N(ao=>{"use strict";Object.defineProperty(ao,"__esModule",{value:!0});ao.sine=ao.Eval_sin=void 0;var xt=w(),gx=B(),Md=ge(),Wt=Z(),Fb=$s(),yx=j(),jb=se(),zb=oe(),cn=ee(),oo=Ot();function vx(e){let t=rl(yx.Eval(xt.cadr(e)));gx.push(t)}ao.Eval_sin=vx;function rl(e){return xt.isadd(e)?px(e):Yb(e)}ao.sine=rl;function px(e){let t=xt.cdr(e);for(;xt.iscons(t);){let r=xt.car(t);if(jb.isnpi(r)){let n=Md.subtract(e,r);return Md.add(cn.multiply(rl(n),Fb.cosine(r)),cn.multiply(Fb.cosine(n),rl(r)))}t=xt.cdr(t)}return Yb(e)}function Yb(e){if(xt.car(e)===xt.symbol(xt.ARCSIN))return xt.cadr(e);if(xt.isdouble(e)){let r=Math.sin(e.d);return Math.abs(r)<1e-10&&(r=0),Wt.double(r)}if(jb.isnegative(e))return cn.negate(rl(cn.negate(e)));if(xt.car(e)===xt.symbol(xt.ARCTAN))return cn.multiply(xt.cadr(e),oo.power(Md.add(xt.Constants.one,oo.power(xt.cadr(e),Wt.integer(2))),Wt.rational(-1,2)));let t=Wt.nativeInt(cn.divide(cn.multiply(e,Wt.integer(180)),xt.Constants.Pi()));if(t<0||isNaN(t))return zb.makeList(xt.symbol(xt.SIN),e);switch(t%360){case 0:case 180:return xt.Constants.zero;case 30:case 150:return Wt.rational(1,2);case 210:case 330:return Wt.rational(-1,2);case 45:case 135:return cn.multiply(Wt.rational(1,2),oo.power(Wt.integer(2),Wt.rational(1,2)));case 225:case 315:return cn.multiply(Wt.rational(-1,2),oo.power(Wt.integer(2),Wt.rational(1,2)));case 60:case 120:return cn.multiply(Wt.rational(1,2),oo.power(Wt.integer(3),Wt.rational(1,2)));case 240:case 300:return cn.multiply(Wt.rational(-1,2),oo.power(Wt.integer(3),Wt.rational(1,2)));case 90:return xt.Constants.one;case 270:return xt.Constants.negOne;default:return zb.makeList(xt.symbol(xt.SIN),e)}}});var $s=N(uo=>{"use strict";Object.defineProperty(uo,"__esModule",{value:!0});uo.cosine=uo.Eval_cos=void 0;var zt=w(),qx=B(),Nd=ge(),Jt=Z(),Ex=j(),Vb=se(),Zb=oe(),ns=ee(),lo=Ot(),Xb=rs();function xx(e){let t=Au(Ex.Eval(zt.cadr(e)));qx.push(t)}uo.Eval_cos=xx;function Au(e){return zt.isadd(e)?hx(e):Hb(e)}uo.cosine=Au;function hx(e){if(zt.iscons(e)){for(let t of e.tail())if(Vb.isnpi(t)){let r=Nd.subtract(e,t);return Nd.subtract(ns.multiply(Au(r),Au(t)),ns.multiply(Xb.sine(r),Xb.sine(t)))}}return Hb(e)}function Hb(e){if(zt.car(e)===zt.symbol(zt.ARCCOS))return zt.cadr(e);if(zt.isdouble(e)){let r=Math.cos(e.d);return Math.abs(r)<1e-10&&(r=0),Jt.double(r)}if(Vb.isnegative(e)&&(e=ns.negate(e)),zt.car(e)===zt.symbol(zt.ARCTAN)){let r=Nd.add(zt.Constants.one,lo.power(zt.cadr(e),Jt.integer(2)));return lo.power(r,Jt.rational(-1,2))}let t=Jt.nativeInt(ns.divide(ns.multiply(e,Jt.integer(180)),zt.Constants.Pi()));if(t<0||isNaN(t))return Zb.makeList(zt.symbol(zt.COS),e);switch(t%360){case 90:case 270:return zt.Constants.zero;case 60:case 300:return Jt.rational(1,2);case 120:case 240:return Jt.rational(-1,2);case 45:case 315:return ns.multiply(Jt.rational(1,2),lo.power(Jt.integer(2),Jt.rational(1,2)));case 135:case 225:return ns.multiply(Jt.rational(-1,2),lo.power(Jt.integer(2),Jt.rational(1,2)));case 30:case 330:return ns.multiply(Jt.rational(1,2),lo.power(Jt.integer(3),Jt.rational(1,2)));case 150:case 210:return ns.multiply(Jt.rational(-1,2),lo.power(Jt.integer(3),Jt.rational(1,2)));case 0:return zt.Constants.one;case 180:return zt.Constants.negOne;default:return Zb.makeList(zt.symbol(zt.COS),e)}}});var Qb=N(Ou=>{"use strict";Object.defineProperty(Ou,"__esModule",{value:!0});Ou.dpow=void 0;var Ax=w(),Ox=Oe(),Tx=ge(),Id=Z(),Mx=ee();function Nx(e,t){if(e===0&&t<0&&Ox.stop("divide by zero"),e>=0||t%1==0)return Id.double(Math.pow(e,t));let r=Math.pow(Math.abs(e),t),n=Math.PI*t,s=0,i=0;return t%.5==0?(s=0,i=Math.sin(n)):(s=Math.cos(n),i=Math.sin(n)),Tx.add(Id.double(s*r),Mx.multiply(Id.double(i*r),Ax.Constants.imaginaryunit))}Ou.dpow=Nx});var yi=N(Tu=>{"use strict";Object.defineProperty(Tu,"__esModule",{value:!0});Tu.factorial=void 0;var Wb=w(),y4=B(),v4=Re(),p4=ge(),Jb=Z(),Ix=oe(),q4=ee(),E4=Ot();function Sx(e){let t=Jb.nativeInt(e);return t<0||isNaN(t)?Ix.makeList(Wb.symbol(Wb.FACTORIAL),e):Jb.bignum_factorial(t)}Tu.factorial=Sx});var Nu=N(Mu=>{"use strict";Object.defineProperty(Mu,"__esModule",{value:!0});Mu.mpow=void 0;function Rx(e,t){return e.pow(t)}Mu.mpow=Rx});var Kb=N(co=>{"use strict";var wx=co&&co.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(co,"__esModule",{value:!0});co.mroot=void 0;var Iu=wx(Ps()),Lx=vu(),Cx=Oe(),kx=Z(),Px=Nu();function Dx(e,t){e=e.abs(),t===0&&Cx.stop("root index is zero");let r=0;for(;e.shiftRight(r).toJSNumber()>0;)r++;if(r===0)return kx.mint(0);r=Math.floor((r-1)/t);let n=Math.floor(r/32+1),s=Iu.default(n);for(let i=0;i<n;i++)s=s.and(Iu.default(1).shiftLeft(i).not());for(;r>=0;){s=s.or(Iu.default(1).shiftLeft(r));let i=Px.mpow(s,t);switch(Lx.mcmp(i,e)){case 0:return s;case 1:s=s.and(Iu.default(1).shiftLeft(r).not());break}r--}return 0}co.mroot=Dx});var pi=N(Bs=>{"use strict";Object.defineProperty(Bs,"__esModule",{value:!0});Bs.areunivarpolysfactoredorexpandedform=Bs.gcd=Bs.Eval_gcd=void 0;var K=w(),$x=B(),vi=Re(),Ux=ge(),Bx=Z(),eg=j(),Sd=se(),Us=ee(),Rd=Ot(),tg=fo(),rg=oe();function Gx(e){e=K.cdr(e);let t=eg.Eval(K.car(e));K.iscons(e)&&(t=e.tail().reduce((r,n)=>ss(r,eg.Eval(n)),t)),$x.push(t)}Bs.Eval_gcd=Gx;function ss(e,t){return K.doexpand(Fx,e,t)}Bs.gcd=ss;function Fx(e,t){let r;return vi.equal(e,t)?e:K.isrational(e)&&K.isrational(t)?Bx.gcd_numbers(e,t):(r=ng(e,t))?jx(e,t,r):K.isadd(e)&&K.isadd(t)?zx(e,t):(K.isadd(e)&&(e=og(e)),K.isadd(t)&&(t=og(t)),K.ismultiply(e)?Yx(e,t):K.ismultiply(t)?Vx(e,t):K.ismultiply(e)&&K.ismultiply(t)?sg(e,t):ig(e,t))}function ng(e,t){let r;if((r=Sd.isunivarpolyfactoredorexpandedform(e))&&Sd.isunivarpolyfactoredorexpandedform(t,r))return r}Bs.areunivarpolysfactoredorexpandedform=ng;function jx(e,t,r){return e=tg.factorpoly(e,r),t=tg.factorpoly(t,r),(K.ismultiply(e)||K.ismultiply(t))&&(K.ismultiply(e)||(e=rg.makeList(K.symbol(K.MULTIPLY),e,K.Constants.one)),K.ismultiply(t)||(t=rg.makeList(K.symbol(K.MULTIPLY),t,K.Constants.one))),K.ismultiply(e)&&K.ismultiply(t)?sg(e,t):ig(e,t)}function sg(e,t){let r=K.cdr(e),n=K.cdr(t);if(K.iscons(r))return[...r].reduce((s,i)=>{if(K.iscons(n))return Us.multiply(s,[...n].reduce((l,u)=>Us.multiply(l,ss(i,u)),K.Constants.one))},K.Constants.one)}function ig(e,t){let r,n,s;if(K.ispower(e)?(r=K.caddr(e),e=K.cadr(e)):r=K.Constants.one,K.ispower(t)?(n=K.caddr(t),t=K.cadr(t)):n=K.Constants.one,!vi.equal(e,t))return K.Constants.one;if(K.isNumericAtom(r)&&K.isNumericAtom(n)){let u=vi.lessp(r,n)?r:n;return Rd.power(e,u)}let i=Us.divide(r,n);if(K.isNumericAtom(i)){i=K.ismultiply(r)&&K.isNumericAtom(K.cadr(r))?K.cadr(r):K.Constants.one,s=K.ismultiply(n)&&K.isNumericAtom(K.cadr(n))?K.cadr(n):K.Constants.one;let u=vi.lessp(i,s)?r:n;return Rd.power(e,u)}if(i=Ux.subtract(r,n),!K.isNumericAtom(i))return K.Constants.one;let l=Sd.isnegativenumber(i)?r:n;return Rd.power(e,l)}function zx(e,t){let r,n,s,i;return vi.length(e)!==vi.length(t)?K.Constants.one:(r=K.iscons(e)?e.tail().reduce(ss):K.car(K.cdr(e)),n=K.iscons(t)?t.tail().reduce(ss):K.car(K.cdr(t)),s=Us.divide(e,r),i=Us.divide(t,n),vi.equal(s,i)?Us.multiply(s,ss(r,n)):K.Constants.one)}function og(e){return K.iscons(e)?e.tail().reduce(ss):K.car(K.cdr(e))}function Yx(e,t){return K.iscons(e)?e.tail().reduce((r,n)=>Us.multiply(r,ss(n,t)),K.Constants.one):K.Constants.one}function Vx(e,t){return K.iscons(t)?t.tail().reduce((r,n)=>Us.multiply(r,ss(e,n)),K.Constants.one):K.Constants.one}});var Ld=N(mo=>{"use strict";Object.defineProperty(mo,"__esModule",{value:!0});mo.lcm=mo.Eval_lcm=void 0;var Zx=pi(),Su=w(),Xx=B(),ag=j(),wd=ee();function Hx(e){e=Su.cdr(e);let t=ag.Eval(Su.car(e));Su.iscons(e)&&(t=e.tail().reduce((r,n)=>lg(r,ag.Eval(n)),t)),Xx.push(t)}mo.Eval_lcm=Hx;function lg(e,t){return Su.doexpand(Qx,e,t)}mo.lcm=lg;function Qx(e,t){return wd.inverse(wd.divide(wd.divide(Zx.gcd(e,t),e),t))}});var nl=N(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.filter=_o.Eval_filter=void 0;var Wx=Pt(),is=w(),Jx=br(),Kx=B(),e0=ge(),ug=j();function t0(e){e=is.cdr(e);let t=ug.Eval(is.car(e));is.iscons(e)&&(t=e.tail().reduce((r,n)=>Ru(r,ug.Eval(n)),t)),Kx.push(t)}_o.Eval_filter=t0;function Ru(e,t){return r0(e,t)}_o.filter=Ru;function r0(e,t){return is.isadd(e)?n0(e,t):is.istensor(e)?s0(e,t):Jx.Find(e,t)?is.Constants.zero:e}function n0(e,t){return is.iscons(e)?e.tail().reduce((r,n)=>e0.add(r,Ru(n,t)),is.Constants.zero):is.Constants.zero}function s0(e,t){let r=e.tensor.nelem,n=Wx.alloc_tensor(r);return n.tensor.ndim=e.tensor.ndim,n.tensor.dim=Array.from(e.tensor.dim),n.tensor.elem=e.tensor.elem.map(s=>Ru(s,t)),n}});var en=N(Lu=>{"use strict";Object.defineProperty(Lu,"__esModule",{value:!0});Lu.subst=void 0;var i0=Pt(),os=w(),o0=Re(),a0=Et();function wu(e,t,r){if(t===os.symbol(os.NIL)||r===os.symbol(os.NIL))return e;if(os.istensor(e)){let n=i0.alloc_tensor(e.tensor.nelem);return n.tensor.ndim=e.tensor.ndim,n.tensor.dim=Array.from(e.tensor.dim),n.tensor.elem=e.tensor.elem.map(s=>{let i=wu(s,t,r);return a0.check_tensor_dimensions(n),i}),n}return o0.equal(e,t)?r:os.iscons(e)?new os.Cons(wu(os.car(e),t,r),wu(os.cdr(e),t,r)):e}Lu.subst=wu});var qi=N(bo=>{"use strict";Object.defineProperty(bo,"__esModule",{value:!0});bo.coeff=bo.Eval_coeff=void 0;var On=w(),l0=B(),u0=Re(),c0=ge(),Cu=j(),f0=nl(),cg=ee(),d0=Ot(),m0=en();function _0(e){let t=Cu.Eval(On.cadddr(e)),r=Cu.Eval(On.caddr(e)),n=Cu.Eval(On.cadr(e));t===On.symbol(On.NIL)&&(t=r,r=On.symbol(On.SYMBOL_X)),l0.push(f0.filter(cg.divide(n,d0.power(r,t)),r))}bo.Eval_coeff=_0;function b0(e,t){let r=[];for(;;){let n=Cu.Eval(m0.subst(e,t,On.Constants.zero));if(r.push(n),e=c0.subtract(e,n),u0.equal(e,On.Constants.zero))return r;e=On.doexpand(cg.divide,e,t)}}bo.coeff=b0});var sl=N(Gs=>{"use strict";Object.defineProperty(Gs,"__esModule",{value:!0});Gs.yycondense=Gs.Condense=Gs.Eval_condense=void 0;var g0=pi(),ku=w(),y0=B(),v0=Re(),p0=ge(),q0=j(),Cd=ee();function E0(e){let t=fg(q0.Eval(ku.cadr(e)));y0.push(t)}Gs.Eval_condense=E0;function fg(e){return ku.noexpand(dg,e)}Gs.Condense=fg;function dg(e){if(!ku.isadd(e))return e;let t=e.tail().reduce(g0.gcd),r=Cd.inverse(t),n=e.tail().reduce((i,l)=>p0.add(i,Cd.multiply_noexpand(r,l)),ku.Constants.zero),s=v0.yyexpand(n);return Cd.divide(s,r)}Gs.yycondense=dg});var Pd=N(yo=>{"use strict";Object.defineProperty(yo,"__esModule",{value:!0});yo.ydivisors=yo.divisors=void 0;var x0=pi(),h0=Pt(),Ve=w(),mg=Re(),A0=ge(),go=Z(),Pu=il(),O0=se(),kd=ee(),T0=Ot();function M0(e){let t=_g(e),r=t.length;t.sort(mg.cmp_expr);let n=h0.alloc_tensor(r);return n.tensor.ndim=1,n.tensor.dim[0]=r,n.tensor.elem=t,n}yo.divisors=M0;var N0=e=>[].concat(...e);function _g(e){let t=[];if(Ve.isNumericAtom(e))t.push(...Pu.factor_small_number(go.nativeInt(e)));else if(Ve.isadd(e))t.push(...I0(e));else if(Ve.ismultiply(e)){if(e=Ve.cdr(e),Ve.isNumericAtom(Ve.car(e))&&(t.push(...Pu.factor_small_number(go.nativeInt(Ve.car(e)))),e=Ve.cdr(e)),Ve.iscons(e)){let n=[...e].map(s=>Ve.ispower(s)?[Ve.cadr(s),Ve.caddr(s)]:[s,Ve.Constants.one]);t.push(...N0(n))}}else Ve.ispower(e)?t.push(Ve.cadr(e),Ve.caddr(e)):t.push(e,Ve.Constants.one);let r=t.length;return t.push(Ve.Constants.one),bg(t,0,r),t.slice(r)}yo.ydivisors=_g;function bg(e,t,r){let n=e.pop();if(t===r){e.push(n);return}let s=e[t+0],i=e[t+1],l=go.nativeInt(i);if(!isNaN(l))for(let u=0;u<=Math.abs(l);u++)e.push(kd.multiply(n,T0.power(s,go.integer(mg.sign(l)*u)))),bg(e,t+2,r)}function I0(e){let t=Ve.iscons(e)?e.tail().reduce(x0.gcd):Ve.car(e),r=[],n=t;if(O0.isplusone(n))return r.push(e,Ve.Constants.one),r;if(Ve.isNumericAtom(n))r.push(...Pu.factor_small_number(go.nativeInt(n)));else if(Ve.ismultiply(n)){let i=Ve.cdr(n);Ve.isNumericAtom(Ve.car(i))?r.push(...Pu.factor_small_number(go.nativeInt(Ve.car(i)))):r.push(Ve.car(i),Ve.Constants.one),Ve.iscons(i)&&i.tail().forEach(l=>r.push(l,Ve.Constants.one))}else r.push(n,Ve.Constants.one);n=kd.inverse(n);let s=Ve.iscons(e)?e.tail().reduce((i,l)=>A0.add(i,kd.multiply(n,l)),Ve.Constants.zero):Ve.cdr(e);return r.push(s,Ve.Constants.one),r}});var ol=N(po=>{"use strict";Object.defineProperty(po,"__esModule",{value:!0});po.rationalize=po.Eval_rationalize=void 0;var S0=pi(),gr=w(),R0=B(),w0=ge(),L0=sl(),gg=j(),yg=se(),vo=ee(),C0=Et();function k0(e){let t=Dd(gg.Eval(gr.cadr(e)));R0.push(t)}po.Eval_rationalize=k0;function Dd(e){let t=gr.defs.expanding,r=P0(e);return gr.defs.expanding=t,r}po.rationalize=Dd;function P0(e){if(gr.istensor(e))return $0(e);if(gr.defs.expanding=!1,!gr.isadd(e))return e;let t=D0(e),r=gr.Constants.zero;return gr.iscons(e)&&(r=e.tail().reduce((n,s)=>w0.add(n,vo.multiply(t,s)),r)),vo.divide(L0.Condense(r),t)}function D0(e){return gr.isadd(e)?e.tail().reduce((t,r)=>vg(r,t),gr.Constants.one):vg(e,gr.Constants.one)}function vg(e,t){return gr.ismultiply(e)?e.tail().reduce((r,n)=>pg(n,r),t):pg(e,t)}function pg(e,t){if(!gr.ispower(e))return t;let r=e;return e=gr.caddr(e),yg.isnegativenumber(e)||gr.ismultiply(e)&&yg.isnegativenumber(gr.cadr(e))?qg(t,vo.inverse(r)):t}function $0(e){return e=gg.Eval(e),gr.istensor(e)&&(e.tensor.elem=e.tensor.elem.map(Dd),C0.check_tensor_dimensions(e)),e}function qg(e,t){return vo.divide(vo.multiply(e,t),S0.gcd(e,t))}});var ls=N(qo=>{"use strict";Object.defineProperty(qo,"__esModule",{value:!0});qo.numerator=qo.Eval_numerator=void 0;var as=w(),U0=B(),B0=Z(),G0=j(),Eg=se(),F0=ee(),j0=ol();function z0(e){let t=$d(G0.Eval(as.cadr(e)));U0.push(t)}qo.Eval_numerator=z0;function $d(e){return as.isadd(e)&&(e=j0.rationalize(e)),as.ismultiply(e)&&!Eg.isplusone(as.car(as.cdr(e)))?F0.multiply_all(e.tail().map($d)):as.isrational(e)?B0.mp_numerator(e):as.ispower(e)&&Eg.isnegativeterm(as.caddr(e))?as.Constants.one:e}qo.numerator=$d});var jd=N($u=>{"use strict";Object.defineProperty($u,"__esModule",{value:!0});$u.print2dascii=void 0;var p=w(),Y0=cs(),V0=dt(),al=dn(),Eo=Z(),sr=se(),Z0=Nn(),xg=1e4,hg=class{constructor(){this.c=0,this.x=0,this.y=0}},bt=[];for(let e=0;e<xg;e++)bt[e]=new hg;var ft=0,Tn=0,Mn=0,Ag=0;function Ud(e){let t="";return t+=e,t}function X0(e){return Ud(e)}function H0(e){ft=0,Tn=0,Mn=0,Q0(e);let[t,r,n]=Array.from(Ao(0,ft));if(r>100){Z0.printline(e);return}return uh()}$u.print2dascii=H0;function Q0(e){if(p.car(e)===p.symbol(p.SETQ)){Ar(p.cadr(e)),Fd(" = "),Ar(p.caddr(e));return}p.istensor(e)?fh(e):Ar(e)}function Og(e){if(Tn>0)return!1;if(sr.isfraction(e))return!0;if(!p.ismultiply(e))return!1;if(sr.isfraction(p.cadr(e)))return!0;for(;p.iscons(e);){if(Ei(p.car(e)))return!0;e=p.cdr(e)}return!1}function Ar(e){if(Ag++,p.isadd(e))for(e=p.cdr(e),xo(p.car(e))&&(ve("-"),Og(p.car(e))&&ve(" ")),ho(p.car(e)),e=p.cdr(e);p.iscons(e);)xo(p.car(e))?(ve(" "),ve("-"),ve(" ")):(ve(" "),ve("+"),ve(" ")),ho(p.car(e)),e=p.cdr(e);else xo(e)&&(ve("-"),Og(e)&&ve(" ")),ho(e);Ag--}function W0(e){if(p.isadd(e))for(e=p.cdr(e),ho(p.car(e)),e=p.cdr(e);p.iscons(e);)xo(p.car(e))?(ve(" "),ve("-"),ve(" ")):(ve(" "),ve("+"),ve(" ")),ho(p.car(e)),e=p.cdr(e);else ho(e)}function xo(e){return!!(sr.isnegativenumber(e)||p.ismultiply(e)&&sr.isnegativenumber(p.cadr(e)))}function ho(e){if(p.ismultiply(e)){let t=J0(e);t&&Tn===0?eh(e,t):K0(e,t)}else fn(e)}function Ei(e){return p.ispower(e)&&p.cadr(e)!==p.symbol(p.E)&&xo(p.caddr(e))}function J0(e){let t=0;for(e=p.cdr(e);p.iscons(e);){let r=p.car(e);Ei(r)&&t++,e=p.cdr(e)}return t}function K0(e,t){if(t===0)for(e=p.cdr(e),(sr.isplusone(p.car(e))||sr.isminusone(p.car(e)))&&(e=p.cdr(e)),fn(p.car(e)),e=p.cdr(e);p.iscons(e);)ve(" "),fn(p.car(e)),e=p.cdr(e);else th(e),ve("/"),t>1||sr.isfraction(p.cadr(e))?(ve("("),Tg(e),ve(")")):Tg(e)}function eh(e,t){let r,n,s=0,i=0,l=0,u=0,c=0,d=p.Constants.one,_=p.Constants.one;for(p.isrational(p.cadr(e))&&(d=al.absval(Eo.mp_numerator(p.cadr(e))),_=Eo.mp_denominator(p.cadr(e))),p.isdouble(p.cadr(e))&&(d=al.absval(p.cadr(e))),u=sr.isplusone(d)?0:1,r=p.cdr(e),p.isNumericAtom(p.car(r))&&(r=p.cdr(r));p.iscons(r);)n=p.car(r),Ei(n)||u++,r=p.cdr(r);for(c=Mn,i=ft,s=0,sr.isplusone(d)||(us(d,0),s++),r=p.cdr(e),p.isNumericAtom(p.car(r))&&(r=p.cdr(r));p.iscons(r);)n=p.car(r),Ei(n)||(s>0&&ve(" "),u===1?Ar(n):fn(n),s++),r=p.cdr(r);for(s===0&&ve("1"),l=ft,s=0,sr.isplusone(_)||(us(_,0),s++,t++),r=p.cdr(e),p.isrational(p.car(r))&&(r=p.cdr(r));p.iscons(r);)n=p.car(r),Ei(n)&&(s>0&&ve(" "),Bd(n,t),s++),r=p.cdr(r);Gd(c,i,l)}function th(e){let t=p.Constants.one;e=p.cdr(e),p.isrational(p.car(e))?(t=al.absval(Eo.mp_numerator(p.car(e))),e=p.cdr(e)):p.isdouble(p.car(e))&&(t=al.absval(p.car(e)),e=p.cdr(e));let r=0;for(sr.isplusone(t)||(us(t,0),r++);p.iscons(e);)Ei(p.car(e))||(r>0&&ve(" "),fn(p.car(e)),r++),e=p.cdr(e);r===0&&ve("1")}function Tg(e){let t=0;if(e=p.cdr(e),sr.isfraction(p.car(e))){let r=Eo.mp_denominator(p.car(e));us(r,0),t++,e=p.cdr(e)}for(;p.iscons(e);)Ei(p.car(e))&&(t>0&&ve(" "),Bd(p.car(e),0),t++),e=p.cdr(e)}function fn(e){if(p.istensor(e)){Du(e);return}if(p.isdouble(e)){us(e,0);return}if(p.isadd(e)||p.ismultiply(e)){Fs(e);return}if(p.ispower(e)){nh(e);return}if(p.iscons(e)){sh(e);return}if(p.isNumericAtom(e)){Tn===0?rh(e):us(e,0);return}if(p.issymbol(e)){Mg(e);return}p.isstr(e)&&ah(e)}function rh(e){let t=al.absval(Eo.mp_numerator(e)),r=Eo.mp_denominator(e);if(sr.isplusone(r)){us(t,0);return}let n=Mn,s=ft;us(t,0);let i=ft;us(r,0),Gd(n,s,i)}function ll(e){return p.iscons(e)&&!p.isadd(e)&&!p.ismultiply(e)&&!p.ispower(e)||p.issymbol(e)?!0:sr.isfraction(e)||sr.isnegativenumber(e)?!1:!!p.isNumericAtom(e)}function nh(e){let t=0,r=0,n=0;if(p.cadr(e)===p.symbol(p.E)){Fd("exp("),Ar(p.caddr(e)),ve(")");return}if(Tn>0){sr.isminusone(p.caddr(e))?(ve("1"),ve("/"),ll(p.cadr(e))?fn(p.cadr(e)):Fs(p.cadr(e))):(ll(p.cadr(e))?fn(p.cadr(e)):Fs(p.cadr(e)),ve("^"),ll(p.caddr(e))?fn(p.caddr(e)):Fs(p.caddr(e)));return}if(xo(p.caddr(e))){n=Mn,t=ft,ve("1"),r=ft,Bd(e,1),Gd(n,t,r);return}t=ft,ll(p.cadr(e))?fn(p.cadr(e)):Fs(p.cadr(e)),r=ft,Tn++,Ar(p.caddr(e)),Tn--,Ng(t,r)}function Bd(e,t){let r=0,n=0;if(sr.isminusone(p.caddr(e))){t===1?Ar(p.cadr(e)):fn(p.cadr(e));return}r=ft,ll(p.cadr(e))?fn(p.cadr(e)):Fs(p.cadr(e)),n=ft,Tn++,W0(p.caddr(e)),Tn--,Ng(r,n)}function sh(e){if(p.car(e)===p.symbol(p.INDEX)&&p.issymbol(p.cadr(e))){ih(e);return}if(p.isfactorial(e)){oh(e);return}if(p.car(e)===p.symbol(p.DERIVATIVE)?ve("d"):Mg(p.car(e)),ve("("),e=p.cdr(e),p.iscons(e))for(Ar(p.car(e)),e=p.cdr(e);p.iscons(e);)ve(","),Ar(p.car(e)),e=p.cdr(e);ve(")")}function ih(e){if(e=p.cdr(e),p.caar(e)===p.symbol(p.ADD)||p.caar(e)===p.symbol(p.MULTIPLY)||p.caar(e)===p.symbol(p.POWER)||p.caar(e)===p.symbol(p.FACTORIAL)?Fs(p.car(e)):Ar(p.car(e)),ve("["),e=p.cdr(e),p.iscons(e))for(Ar(p.car(e)),e=p.cdr(e);p.iscons(e);)ve(","),Ar(p.car(e)),e=p.cdr(e);ve("]")}function oh(e){e=p.cadr(e),sr.isfraction(e)||p.isadd(e)||p.ismultiply(e)||p.ispower(e)||p.isfactorial(e)?Fs(e):Ar(e),ve("!")}function Fs(e){ve("("),Ar(e),ve(")")}function Mg(e){if(e===p.symbol(p.E)){Fd("exp(1)");return}let t=V0.get_printname(e);for(let r=0;r<t.length;r++)ve(t[r])}function ah(e){let t=e.str;ve('"');for(let r=0;r<t.length;r++)ve(t[r]);ve('"')}function Gd(e,t,r){let n=0,s=0,[i,l,u]=Array.from(Ao(t,r)),[c,d,_]=Array.from(Ao(r,ft));d>l?n=(d-l)/2:n=0,n++,s=-(u+i-1)-1,ul(t,r,n,s),d>l?n=-l:n=-l+(l-d)/2,n++,s=-_+1,ul(r,ft,n,s);let R=0;d>l?R=d:R=l,R+=2,Mn=e;for(let C=0;C<R;C++)ve("-")}function Ng(e,t){let r=0,n=0,s=0,i=0,l=0,u=0,c=0;[n,s,i]=Array.from(Ao(e,t)),[l,u,c]=Array.from(Ao(t,ft)),r=-c-l+1,r+=i-1,ul(t,ft,0,r)}function ul(e,t,r,n){for(let s=e;s<t;s++)bt[s].x+=r,bt[s].y+=n}function Ao(e,t){let r=bt[e].x,n=bt[e].x,s=bt[e].y,i=bt[e].y;for(let d=e+1;d<t;d++)bt[d].x<r&&(r=bt[d].x),bt[d].x>n&&(n=bt[d].x),bt[d].y<s&&(s=bt[d].y),bt[d].y>i&&(i=bt[d].y);let l=i-s+1,u=n-r+1;return[l,u,s]}function ve(e){if(ft!==xg)return bt[ft]==null&&p.breakpoint,bt[ft].c=e,bt[ft].x=Mn,bt[ft].y=0,ft++,Mn++}function Fd(e){for(let t=0;t<e.length;t++)ve(e[t])}function us(e,t){let r="";switch(e.k){case p.NUM:r=e.q.a.toString(),r[0]==="-"&&t===0&&(r=r.substring(1));for(let n=0;n<r.length;n++)ve(r[n]);if(r=e.q.b.toString(),r==="1")break;ve("/");for(let n=0;n<r.length;n++)ve(r[n]);break;case p.DOUBLE:r=Y0.doubleToReasonableString(e.d),r[0]==="-"&&t===0&&(r=r.substring(1));for(let n=0;n<r.length;n++)ve(r[n]);break}}function lh(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0}function uh(){let e="",t=bt.slice(0,ft);t.sort(lh),bt=[].concat(t).concat(bt.slice(ft));let r=0,{y:n}=bt[0];for(let s=0;s<ft;s++){for(;bt[s].y>n;)e+=X0(`
`),r=0,n++;for(;bt[s].x>r;)e+=Ud(" "),r++;e+=Ud(bt[s].c),r++}return e}var ch=100,Ig=class{constructor(){this.x=0,this.y=0,this.h=0,this.w=0,this.index=0,this.count=0}},Lt=[];for(let e=0;e<1e4;e++)Lt[e]=new Ig;var Sg=3,Rg=1;function fh(e){let t=0,r=0,n=0;if(e.tensor.ndim>2){Du(e);return}let s=e.tensor.dim[0];e.tensor.ndim===2?t=e.tensor.dim[1]:t=1;let i=s*t;if(i>ch){Du(e);return}let l=Mn;for(let R=0;R<i;R++)Lt[R].index=ft,Lt[R].x=Mn,Ar(e.tensor.elem[R]),Lt[R].count=ft-Lt[R].index,[Lt[R].h,Lt[R].w,Lt[R].y]=Array.from(Ao(Lt[R].index,ft));let u=0,c=0;for(let R=0;R<i;R++)Lt[R].h>u&&(u=Lt[R].h),Lt[R].w>c&&(c=Lt[R].w);let d=s*u+(s-1)*Rg,_=t*c+(t-1)*Sg,L=-(d/2);for(let R=0;R<s;R++)for(let C=0;C<t;C++){let Y=R*t+C;r=l-Lt[Y].x,n=L-Lt[Y].y,ul(Lt[Y].index,Lt[Y].index+Lt[Y].count,r,n),r=0,C>0&&(r=C*(c+Sg)),n=0,R>0&&(n=R*(u+Rg)),r+=(c-Lt[Y].w)/2,n+=(u-Lt[Y].h)/2,ul(Lt[Y].index,Lt[Y].index+Lt[Y].count,r,n)}Mn=l+_}function Du(e){wg(e,0,0)}function wg(e,t,r){ve("(");for(let n=0;n<e.tensor.dim[t];n++)t+1===e.tensor.ndim?(Ar(e.tensor.elem[r]),r=r+1):r=wg(e,t+1,r),n+1<e.tensor.dim[t]&&ve(",");return ve(")"),r}});var Vs=N(Mo=>{"use strict";Object.defineProperty(Mo,"__esModule",{value:!0});Mo.scan_meta=Mo.scan=void 0;var dh=Pt(),F=w(),js=cs(),mh=Oe(),De=B(),ir=dt(),_h=Re(),Lg=Z(),bh=se(),Kt=oe(),Uu=ee(),gh=Et(),zd=1001,Yd=1002,Bu=1003,Vd=1004,Zd=1006,Xd=1007,Cg=1008,kg=1009,Pg=1010,Dg=1011,Hd=1012,ce="",cl=0,Qd=0,zr=0,ie=0,xi=0,gt="",Gu=null,Je=null,fl=null,zs=null,Oo=null,et=null,Ys=!1,Wd=null,he="";function yh(e){F.DEBUG&&console.log(`#### scanning ${e}`),Gu=null,Je=[],fl=[],zs=!0,Oo=[],et=[""],Wd=!1,he=e,Qd=0;let t=F.defs.expanding;return F.defs.expanding=!0,zr=0,ie=0,Ue(),ce===""?(De.push(F.symbol(F.NIL)),F.defs.expanding=t,0):(fs(),F.defs.expanding=t,Wd||(F.defs.symbolsInExpressionsWithoutAssignments=F.defs.symbolsInExpressionsWithoutAssignments.concat(fl)),xi-zr)}Mo.scan=yh;function vh(e){he=e,Qd=1;let t=F.defs.expanding;if(F.defs.expanding=!0,zr=0,ie=0,Ue(),ce===""){De.push(F.symbol(F.NIL)),F.defs.expanding=t;return}fs(),F.defs.expanding=t,xi-zr}Mo.scan_meta=vh;function fs(){$g();let e=!1;if(ce===Hd&&(e=!0),ce===Hd||ce==="="){let t=Gu;if(F.DEBUG&&console.log("assignment!"),Wd=!0,zs=!1,Ue(),ir.push_symbol(F.SETQ),De.swap(),e&&ir.push_symbol(F.QUOTE),$g(),e&&Kt.list(2),Kt.list(3),zs=!0,F.defs.codeGen){let r=Je.indexOf(t);if(r!==-1&&(Je.splice(r,1),F.defs.symbolsHavingReassignments.push(t)),F.DEBUG){console.log(`locally, ${t} depends on: `);for(let s of Array.from(Je))console.log(`  ${s}`)}F.defs.symbolsDependencies[t]==null&&(F.defs.symbolsDependencies[t]=[]);let n=F.defs.symbolsDependencies[t];for(let s of Array.from(Je))n.indexOf(s)===-1&&n.push(s);Je=[]}}}function $g(){switch(ds(),ce){case Pg:return ir.push_symbol(F.TESTEQ),De.swap(),Ue(),ds(),Kt.list(3);case Dg:return ir.push_symbol(F.NOT),De.swap(),ir.push_symbol(F.TESTEQ),De.swap(),Ue(),ds(),Kt.list(3),Kt.list(2);case kg:return ir.push_symbol(F.TESTLE),De.swap(),Ue(),ds(),Kt.list(3);case Cg:return ir.push_symbol(F.TESTGE),De.swap(),Ue(),ds(),Kt.list(3);case"<":return ir.push_symbol(F.TESTLT),De.swap(),Ue(),ds(),Kt.list(3);case">":return ir.push_symbol(F.TESTGT),De.swap(),Ue(),ds(),Kt.list(3)}}function ds(){let e=F.defs.tos;switch(ce){case"+":Ue(),dl();break;case"-":Ue(),dl(),De.push(Uu.negate(De.pop()));break;default:dl()}for(;cl===0&&(ce==="+"||ce==="-");)ce==="+"?(Ue(),dl()):(Ue(),dl(),De.push(Uu.negate(De.pop())));F.defs.tos-e>1&&(Kt.list(F.defs.tos-e),De.push(new F.Cons(F.symbol(F.ADD),De.pop())))}function Jd(){if(typeof ce=="string")return ce.charCodeAt(0)}function ph(){if(Jd()===F.dotprod_unicode)return!0;switch(ce){case"*":case"/":return!0;case"(":case Bu:case Vd:case zd:case Yd:case Xd:return cl?(ie=xi,!1):!0}return!1}function Kd(e,t){e>t&&F.isrational(F.defs.stack[e-1])&&bh.equaln(F.defs.stack[e-1],1)&&De.pop()}function qh(e,t){if(e>t+1&&F.isNumericAtom(F.defs.stack[e-2])&&F.isNumericAtom(F.defs.stack[e-1])){let r=De.pop(),n=De.pop();De.push(Uu.multiply(n,r))}}function dl(){let e=F.defs.tos;for(To(),F.parse_time_simplifications&&Kd(F.defs.tos,e);ph();)ce==="*"?(Ue(),To()):ce==="/"?(Kd(F.defs.tos,e),Ue(),To(),De.push(Uu.inverse(De.pop()))):Jd()===F.dotprod_unicode?(Ue(),ir.push_symbol(F.INNER),De.swap(),To(),Kt.list(3)):To(),F.parse_time_simplifications&&(qh(F.defs.tos,e),Kd(F.defs.tos,e));e===F.defs.tos?De.push(F.Constants.one):F.defs.tos-e>1&&(Kt.list(F.defs.tos-e),De.push(new F.Cons(F.symbol(F.MULTIPLY),De.pop())))}function Eh(){ce==="^"&&(Ue(),ir.push_symbol(F.POWER),De.swap(),To(),Kt.list(3))}function xh(e){for(Ue(),ir.push_symbol(F.INDEX),De.swap(),ds();ce===",";)Ue(),ds();ce!=="]"&&In("] expected"),Ue(),Kt.list(F.defs.tos-e)}function To(){let e=F.defs.tos,t=!1;for(ce==="("?Nh():ce===Bu?Ah():ce===Vd?Th():ce==="["?Ih():ce===zd?(t=!0,Lg.bignum_scan_integer(gt),Ue()):ce===Yd?(t=!0,Lg.bignum_scan_float(gt),Ue()):ce===Xd?Oh():In("syntax error");ce==="["||ce==="("&&cl===0&&!t;)ce==="["?xh(e):ce==="("&&Mh();for(;ce==="!";)Ue(),ir.push_symbol(F.FACTORIAL),De.swap(),Kt.list(2);for(;Jd()===F.transpose_unicode;)Ue(),ir.push_symbol(F.TRANSPOSE),De.swap(),Kt.list(2);Eh()}function em(e){if(F.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(e)===-1&&Je.indexOf(e)===-1&&Je.indexOf("'"+e)===-1&&!Ys){F.DEBUG&&console.log(`... adding symbol: ${e} to the set of the symbols right of assignment`);let t="";for(let r=1;r<et.length;r++)et[r]!==""&&(t+=et[r]+"_"+r+"_");e=t+e,Je.push(e)}}function hh(e){if(F.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(e)===-1&&fl.indexOf(e)===-1&&fl.indexOf("'"+e)===-1&&!Ys){F.DEBUG&&console.log(`... adding symbol: ${e} to the set of the symbols left of assignment`);let t="";for(let r=1;r<et.length;r++)et[r]!==""&&(t+=et[r]+"_"+r+"_");e=t+e,fl.push(e)}}function Ah(){if(ce!==Bu&&In("symbol expected"),Qd&&typeof gt=="string"&&gt.length===1)switch(gt[0]){case"a":De.push(F.symbol(F.METAA));break;case"b":De.push(F.symbol(F.METAB));break;case"x":De.push(F.symbol(F.METAX));break;default:De.push(ir.usr_symbol(gt))}else De.push(ir.usr_symbol(gt));Oo.length===0?(F.DEBUG&&console.log(`out of scanning parameters, processing ${gt}`),Gu=gt,zs&&hh(gt)):(F.DEBUG&&console.log(`still scanning parameters, skipping ${gt}`),zs&&em("'"+gt)),F.DEBUG&&console.log(`found symbol: ${gt} left of assignment: ${zs}`),zs||em(gt),Ue()}function Oh(){_h.new_string(gt),Ue()}function Th(){F.DEBUG&&console.log("-- scan_function_call_with_function_name start");let e=1,t=ir.usr_symbol(gt);De.push(t);let r=gt;if((r==="roots"||r==="defint"||r==="sum"||r==="product"||r==="for")&&et.push(gt),Gu=gt,zs||em(gt),Ue(),Ue(),Oo.push(!0),ce!==")"){for(fs(),e++;ce===",";)Ue(),e===2&&et[et.length-1].indexOf("roots")!==-1&&(Je=Je.filter(n=>!new RegExp("roots_"+(et.length-1)+"_"+gt).test(n)),Ys=!0),e===2&&et[et.length-1].indexOf("sum")!==-1&&(Je=Je.filter(n=>!new RegExp("sum_"+(et.length-1)+"_"+gt).test(n)),Ys=!0),e===2&&et[et.length-1].indexOf("product")!==-1&&(Je=Je.filter(n=>!new RegExp("product_"+(et.length-1)+"_"+gt).test(n)),Ys=!0),e===2&&et[et.length-1].indexOf("for")!==-1&&(Je=Je.filter(n=>!new RegExp("for_"+(et.length-1)+"_"+gt).test(n)),Ys=!0),et[et.length-1].indexOf("defint")!==-1&&(e===2||e>2&&(e-2)%3==0)&&(Je=Je.filter(n=>!new RegExp("defint_"+(et.length-1)+"_"+gt).test(n)),Ys=!0),fs(),Ys=!1,e++;e===2&&et[et.length-1].indexOf("roots")!==-1&&(Je=Je.filter(n=>!new RegExp("roots_"+(et.length-1)+"_x").test(n)))}Oo.pop();for(let n=0;n<=Je.length;n++)Je[n]!=null&&(r==="roots"&&(Je[n]=Je[n].replace(new RegExp("roots_"+(et.length-1)+"_"),"")),r==="defint"&&(Je[n]=Je[n].replace(new RegExp("defint_"+(et.length-1)+"_"),"")),r==="sum"&&(Je[n]=Je[n].replace(new RegExp("sum_"+(et.length-1)+"_"),"")),r==="product"&&(Je[n]=Je[n].replace(new RegExp("product_"+(et.length-1)+"_"),"")),r==="for"&&(Je[n]=Je[n].replace(new RegExp("for_"+(et.length-1)+"_"),"")));ce!==")"&&In(") expected"),Ue(),Kt.list(e),(r==="roots"||r==="defint"||r==="sum"||r==="product"||r==="for")&&et.pop(),r===F.symbol(F.PATTERN).printname&&(F.defs.patternHasBeenFound=!0),F.DEBUG&&console.log("-- scan_function_call_with_function_name end")}function Mh(){F.DEBUG&&console.log("-- scan_function_call_without_function_name start"),ir.push_symbol(F.EVAL),De.swap(),Kt.list(2);let e=1;if(Ue(),Oo.push(!0),ce!==")")for(fs(),e++;ce===",";)Ue(),fs(),e++;Oo.pop(),ce!==")"&&In(") expected"),Ue(),Kt.list(e),F.DEBUG&&console.log(`-- scan_function_call_without_function_name end: ${De.top()}`)}function Nh(){let e=0;ce!=="("&&In("( expected"),Ue(),fs(),ce!==")"&&In(") expected"),Ue()}function Ih(){ce!=="["&&In("[ expected"),Ue(),fs();let e=1;for(;ce===",";)Ue(),fs(),e++;Sh(e),ce!=="]"&&In("] expected"),Ue()}function In(e){for(F.defs.errorMessage="";zr!==ie&&!((he[zr]===`
`||he[zr]==="\r")&&zr+1===ie);)F.defs.errorMessage+=he[zr++];for(F.defs.errorMessage+=" ? ";he[zr]&&he[zr]!==`
`&&he[zr]!=="\r";)F.defs.errorMessage+=he[zr++];F.defs.errorMessage+=`
`,mh.stop(e)}function Sh(e){let t=dh.alloc_tensor(e);t.tensor.ndim=1,t.tensor.dim[0]=e;for(let r=0;r<e;r++)t.tensor.elem[r]=F.defs.stack[F.defs.tos-e+r];gh.check_tensor_dimensions(t),De.moveTos(F.defs.tos-e),De.push(t)}function Ue(){for(cl=0;Rh(),ce===Zd;)cl=1;F.DEBUG&&console.log(`get_next_token token: ${ce}`)}function Rh(){for(;js.isspace(he[ie]);){if(he[ie]===`
`||he[ie]==="\r"){ce=Zd,ie++;return}ie++}if(xi=ie,ie===he.length){ce="";return}if(js.isdigit(he[ie])||he[ie]==="."){for(;js.isdigit(he[ie]);)ie++;if(he[ie]==="."){for(ie++;js.isdigit(he[ie]);)ie++;if(he[ie]==="e"&&(he[ie+1]==="+"||he[ie+1]==="-"||js.isdigit(he[ie+1])))for(ie+=2;js.isdigit(he[ie]);)ie++;ce=Yd}else ce=zd;tm(xi,ie);return}if(js.isalpha(he[ie])){for(;js.isalnumorunderscore(he[ie]);)ie++;he[ie]==="("?ce=Vd:ce=Bu,tm(xi,ie);return}if(he[ie]==='"'){for(ie++;he[ie]!=='"';)ie===he.length-1&&(ie++,In("runaway string"),ie--),ie++;ie++,ce=Xd,tm(xi+1,ie-1);return}if(he[ie]==="#"||he[ie]==="-"&&he[ie+1]==="-"){for(;he[ie]&&he[ie]!==`
`&&he[ie]!=="\r";)ie++;he[ie]&&ie++,ce=Zd;return}if(he[ie]===":"&&he[ie+1]==="="){ie+=2,ce=Hd;return}if(he[ie]==="="&&he[ie+1]==="="){ie+=2,ce=Pg;return}if(he[ie]==="!"&&he[ie+1]==="="){ie+=2,ce=Dg;return}if(he[ie]==="<"&&he[ie+1]==="="){ie+=2,ce=kg;return}if(he[ie]===">"&&he[ie+1]==="="){ie+=2,ce=Cg;return}ce=he[ie++]}function tm(e,t){gt=he.substring(e,t)}});var Nn=N(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.print_list=Mt.print_expr=Mt.printline=Mt.collectLatexStringFromReturnValue=Mt.print_str=Mt.Eval_printlist=Mt.Eval_printhuman=Mt.Eval_printlatex=Mt.Eval_printcomputer=Mt.Eval_print2dascii=Mt.Eval_print=void 0;var a=w(),hi=B(),ml=dt(),Ai=Re(),wh=dn(),Fu=Z(),Lh=Sn(),Ch=j(),Tt=se(),Ug=ee(),kh=ls(),Ph=jd(),Dh=Vs(),$h="^";function Uh(e){a.defs.stringsEmittedByUserPrintouts+=No(a.cdr(e),a.defs.printMode),hi.push(a.symbol(a.NIL))}Mt.Eval_print=Uh;function Bh(e){a.defs.stringsEmittedByUserPrintouts+=No(a.cdr(e),a.PRINTMODE_2DASCII),hi.push(a.symbol(a.NIL))}Mt.Eval_print2dascii=Bh;function Gh(e){a.defs.stringsEmittedByUserPrintouts+=No(a.cdr(e),a.PRINTMODE_COMPUTER),hi.push(a.symbol(a.NIL))}Mt.Eval_printcomputer=Gh;function Fh(e){a.defs.stringsEmittedByUserPrintouts+=No(a.cdr(e),a.PRINTMODE_LATEX),hi.push(a.symbol(a.NIL))}Mt.Eval_printlatex=Fh;function jh(e){let t=a.defs.test_flag;a.defs.test_flag=!1,a.defs.stringsEmittedByUserPrintouts+=No(a.cdr(e),a.PRINTMODE_HUMAN),a.defs.test_flag=t,hi.push(a.symbol(a.NIL))}Mt.Eval_printhuman=jh;function zh(e){let t=No(a.cdr(e),a.PRINTMODE_LIST);a.defs.stringsEmittedByUserPrintouts+=t,hi.push(a.symbol(a.NIL))}Mt.Eval_printlist=zh;function No(e,t){let r="";for(;a.iscons(e);){let n=Ch.Eval(a.car(e)),s=a.defs.printMode;t===a.PRINTMODE_COMPUTER?(a.defs.printMode=a.PRINTMODE_COMPUTER,r=ju(n),_l(r,a.LAST_FULL_PRINT)):t===a.PRINTMODE_HUMAN?(a.defs.printMode=a.PRINTMODE_HUMAN,r=ju(n),_l(r,a.LAST_PLAIN_PRINT)):t===a.PRINTMODE_2DASCII?(a.defs.printMode=a.PRINTMODE_2DASCII,r=Ph.print2dascii(n),_l(r,a.LAST_2DASCII_PRINT)):t===a.PRINTMODE_LATEX?(a.defs.printMode=a.PRINTMODE_LATEX,r=ju(n),_l(r,a.LAST_LATEX_PRINT)):t===a.PRINTMODE_LIST&&(a.defs.printMode=a.PRINTMODE_LIST,r=Io(n),_l(r,a.LAST_LIST_PRINT)),a.defs.printMode=s,e=a.cdr(e)}return a.DEBUG&&console.log(`emttedString from display: ${a.defs.stringsEmittedByUserPrintouts}`),r}function _l(e,t){Dh.scan('"'+e+'"');let r=hi.pop();ml.set_binding(a.symbol(t),r)}function k(e){return a.DEBUG&&console.log(`emttedString from print_str: ${a.defs.stringsEmittedByUserPrintouts}`),e}Mt.print_str=k;function Yr(e){return e}function Yh(e){let t=a.defs.printMode;a.defs.printMode=a.PRINTMODE_LATEX;let r=a.defs.codeGen;a.defs.codeGen=!1;let n=D(e);return n=n.replace(/_/g,"\\_"),a.defs.printMode=t,a.defs.codeGen=r,a.DEBUG&&console.log(`emttedString from collectLatexStringFromReturnValue: ${a.defs.stringsEmittedByUserPrintouts}`),n}Mt.collectLatexStringFromReturnValue=Yh;function ju(e){let t="";return t+=D(e),t}Mt.printline=ju;function Bg(e){let t="";return Tt.isfraction(e)||a.isadd(e)||a.ismultiply(e)||a.ispower(e)||Ai.lessp(e,a.Constants.zero)?(t+=Yr("("),t+=D(e),t+=Yr(")")):t+=D(e),t}function Gg(e){let t="";return Tt.isfraction(e)||a.isadd(e)||a.ismultiply(e)||a.ispower(e)?(t+=Yr("("),t+=D(e),t+=Yr(")")):t+=D(e),t}function Vh(e,t){let r="",n=a.cadr(e),s=a.caddr(e);return Tt.isminusone(s)?(r+=Bg(n),r):(t===1&&(r+=Yr("(")),s=Ug.negate(s),r+=gl(n,s),t===1&&(r+=Yr(")")),r)}function Zh(e){let t,r,n="",s=0,i=0,l=0,u=a.cdr(e),c=a.car(u);for(a.isrational(c)?(t=wh.absval(Fu.mp_numerator(c)),r=Fu.mp_denominator(c),Tt.isplusone(t)||i++,Tt.isplusone(r)||l++,u=a.cdr(u)):(t=a.Constants.one,r=a.Constants.one);a.iscons(u);)c=a.car(u),zu(c)?l++:i++,u=a.cdr(u);if(a.defs.printMode===a.PRINTMODE_LATEX&&(n+=k("\\frac{")),i===0)n+=Yr("1");else for(s=0,u=a.cdr(e),a.isrational(a.car(u))&&(u=a.cdr(u)),Tt.isplusone(t)||(n+=mn(t),s=1);a.iscons(u);)c=a.car(u),zu(c)||(s&&(n+=nm()),n+=mn(c),s=1),u=a.cdr(u);for(a.defs.printMode===a.PRINTMODE_LATEX?n+=k("}{"):a.defs.printMode===a.PRINTMODE_HUMAN&&!a.defs.test_flag?n+=k(" / "):n+=k("/"),l>1&&a.defs.printMode!==a.PRINTMODE_LATEX&&(n+=Yr("(")),s=0,u=a.cdr(e),a.isrational(a.car(u))&&(u=a.cdr(u)),Tt.isplusone(r)||(n+=mn(r),s=1);a.iscons(u);)c=a.car(u),zu(c)&&(s&&(n+=nm()),n+=Vh(c,l),s=1),u=a.cdr(u);return l>1&&a.defs.printMode!==a.PRINTMODE_LATEX&&(n+=Yr(")")),a.defs.printMode===a.PRINTMODE_LATEX&&(n+=k("}")),n}function D(e){let t="";if(a.isadd(e))for(e=a.cdr(e),bl(a.car(e))==="-"&&(t+=k("-")),t+=rm(a.car(e)),e=a.cdr(e);a.iscons(e);)bl(a.car(e))==="+"?a.defs.printMode===a.PRINTMODE_HUMAN&&!a.defs.test_flag?t+=k(" + "):t+=k("+"):a.defs.printMode===a.PRINTMODE_HUMAN&&!a.defs.test_flag?t+=k(" - "):t+=k("-"),t+=rm(a.car(e)),e=a.cdr(e);else bl(e)==="-"&&(t+=k("-")),t+=rm(e);return t}Mt.print_expr=D;function bl(e){let t="";return a.ismultiply(e)&&a.isNumericAtom(a.cadr(e))&&Ai.lessp(a.cadr(e),a.Constants.zero)||a.isNumericAtom(e)&&Ai.lessp(e,a.Constants.zero)?t+="-":t+="+",t}function rm(e){let t="";if(a.ismultiply(e)&&I2(e))return t+=Zh(e),t;if(a.ismultiply(e)){let r,n;e=a.cdr(e),Tt.isminusone(a.car(e))&&(e=a.cdr(e));let s=!1;a.isNumericAtom(a.car(e))&&(s=!0);let i=!1;for(a.defs.printMode===a.PRINTMODE_LATEX&&a.iscons(a.cdr(e))&&Tt.isNumberOneOverSomething(a.car(e))&&(i=!0,r=a.car(e).q.b.toString()),i?(n=t,t=""):t+=mn(a.car(e)),e=a.cdr(e);a.iscons(e);)a.defs.printMode===a.PRINTMODE_LATEX&&s&&a.caar(e)===a.symbol(a.POWER)&&a.isNumericAtom(a.car(a.cdr(a.car(e))))&&(Tt.isfraction(a.car(a.cdr(a.cdr(a.car(e)))))||(t+=" \\cdot ")),t+=nm(),t+=mn(a.car(e),!1,!0),s=!1,a.isNumericAtom(a.car(e))&&(s=!0),e=a.cdr(e);i&&(t=n+"\\frac{"+t+"}{"+r+"}")}else t+=mn(e);return t}function Fg(e){let t="";return t+=Yr("("),t+=D(e),t+=Yr(")"),t}function Xh(e){let t="";return e=a.cadr(e),Tt.isfraction(e)||a.isadd(e)||a.ismultiply(e)||a.ispower(e)||a.isfactorial(e)?t+=Fg(e):t+=D(e),t+=Yr("!"),t}function Hh(e){let t="";return t+=k("\\left |"),t+=D(a.cadr(e)),t+=k(" \\right |"),t}function Qh(e){let t="";return t+=k("\\binom{"),t+=D(a.cadr(e)),t+=k("}{"),t+=D(a.caddr(e)),t+=k("} "),t}function Wh(e){let t="";return t+=D(a.cadr(e)),t+=k(" \\cdot "),t+=D(a.caddr(e)),t}function Jh(e){let t="dot(";return t+=D(a.cadr(e)),t+=", ",t+=D(a.caddr(e)),t+=")",t}function Kh(e){let t="Math.sin(";return t+=D(a.cadr(e)),t+=")",t}function e2(e){let t="Math.cos(";return t+=D(a.cadr(e)),t+=")",t}function t2(e){let t="Math.tan(";return t+=D(a.cadr(e)),t+=")",t}function r2(e){let t="Math.asin(";return t+=D(a.cadr(e)),t+=")",t}function n2(e){let t="Math.acos(";return t+=D(a.cadr(e)),t+=")",t}function s2(e){let t="Math.atan(";return t+=D(a.cadr(e)),t+=")",t}function i2(e){let t="";return t+=k("\\sqrt{"),t+=D(a.cadr(e)),t+=k("} "),t}function o2(e){let t="";return t+=k("{"),a.iscons(a.cadr(e))&&(t+=k("(")),t+=D(a.cadr(e)),a.iscons(a.cadr(e))&&(t+=k(")")),t+=k("}"),t+=k("^T"),t}function a2(e){let t="";return t+=k("transpose("),t+=D(a.cadr(e)),t+=k(")"),t}function l2(e){let t="";return t+=k("identity("),t+=D(a.cadr(e)),t+=k(")"),t}function u2(e){let t="";return t+=k("{"),a.iscons(a.cadr(e))&&(t+=k("(")),t+=D(a.cadr(e)),a.iscons(a.cadr(e))&&(t+=k(")")),t+=k("}"),t+=k("^{-1}"),t}function c2(e){let t="";return t+=k("inv("),t+=D(a.cadr(e)),t+=k(")"),t}function f2(e){let t="",r=a.car(a.cdr(e));e=a.cdr(e);let n=e,s=0;for(;a.iscons(a.cdr(a.cdr(e)));){s++;let i=a.cdr(a.cdr(e));t+=k("\\int^{"),t+=D(a.car(a.cdr(i))),t+=k("}_{"),t+=D(a.car(i)),t+=k("} \\! "),e=a.cdr(i)}t+=D(r),t+=k(" \\,"),e=n;for(let i=1;i<=s;i++){let l=a.cdr(e);t+=k(" \\mathrm{d} "),t+=D(a.car(l)),i<s&&(t+=k(" \\, ")),e=a.cdr(a.cdr(l))}return t}function d2(e){let t="";return t+=jg(e,0,0)[1],t}function jg(e,t,r){let n="";if(n+=k("["),t<e.tensor.ndim-1)for(let s=0;s<e.tensor.dim[t];s++){let i;[r,i]=Array.from(jg(e,t+1,r)),n+=i,s!==e.tensor.dim[t]-1&&(n+=k(","))}else for(let s=0;s<e.tensor.dim[t];s++)n+=D(e.tensor.elem[r]),s!==e.tensor.dim[t]-1&&(n+=k(",")),r++;return n+=k("]"),[r,n]}function m2(e){let t="";return e.tensor.ndim<=2&&(t+=zg(!0,e,0,0)[1]),t}function zg(e,t,r,n){let s="";if(e&&(s+="\\begin{bmatrix} "),r<t.tensor.ndim-1)for(let i=0;i<t.tensor.dim[r];i++){let l;[n,l]=Array.from(zg(!1,t,r+1,n)),s+=l,i!==t.tensor.dim[r]-1&&(s+=k(" \\\\ "))}else for(let i=0;i<t.tensor.dim[r];i++)s+=D(t.tensor.elem[n]),i!==t.tensor.dim[r]-1&&(s+=k(" & ")),n++;return e&&(s+=" \\end{bmatrix}"),[n,s]}function _2(e){let t="\\sum_{";return t+=D(a.caddr(e)),t+="=",t+=D(a.cadddr(e)),t+="}^{",t+=D(a.caddddr(e)),t+="}{",t+=D(a.cadr(e)),t+="}",t}function b2(e){let t=a.cadr(e),r=a.caddr(e),n=a.cadddr(e),s=a.caddddr(e);return"(function(){ var "+r+";  var holderSum = 0;  var lowerlimit = "+D(n)+";  var upperlimit = "+D(s)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    holderSum += "+D(t)+"; }  return holderSum;})()"}function g2(e){let t="\\left\\{ \\begin{array}{ll}";for(e=a.cdr(e);a.iscons(e);){if(a.cdr(e)===a.symbol(a.NIL)){t+="{",t+=D(a.car(e)),t+="} & otherwise ",t+=" \\\\\\\\";break}t+="{",t+=D(a.cadr(e)),t+="} & if & ",t+=D(a.car(e)),t+=" \\\\\\\\",e=a.cddr(e)}return t=t.substring(0,t.length-4),t+="\\end{array} \\right."}function y2(e){let t="(function(){";e=a.cdr(e);let r=0;for(;a.iscons(e);){if(a.cdr(e)===a.symbol(a.NIL)){t+="else {",t+="return ("+D(a.car(e))+");",t+="}";break}r&&(t+=" else "),t+="if ("+D(a.car(e))+"){",t+="return ("+D(a.cadr(e))+");",t+="}",r++,e=a.cddr(e)}return t+="})()",t}function v2(e){let t="{";return t+=D(a.cadr(e)),t+="}",t+=" < ",t+="{",t+=D(a.caddr(e)),t+="}"}function p2(e){let t="{";return t+=D(a.cadr(e)),t+="}",t+=" \\leq ",t+="{",t+=D(a.caddr(e)),t+="}"}function q2(e){let t="{";return t+=D(a.cadr(e)),t+="}",t+=" > ",t+="{",t+=D(a.caddr(e)),t+="}"}function E2(e){let t="{";return t+=D(a.cadr(e)),t+="}",t+=" \\geq ",t+="{",t+=D(a.caddr(e)),t+="}"}function x2(e){let t="{";return t+=D(a.cadr(e)),t+="}",t+=" = ",t+="{",t+=D(a.caddr(e)),t+="}"}function h2(e){let t=a.cadr(e),r=a.caddr(e),n=a.cadddr(e),s=a.caddddr(e);return"(function(){ var "+r+";  var lowerlimit = "+D(n)+";  var upperlimit = "+D(s)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    "+D(t)+" } })()"}function A2(e){let t="";for(e=a.cdr(e);a.iscons(e);)t+=D(a.car(e)),e=a.cdr(e);return t}function O2(e){let t="";return t+=D(a.cadr(e)),t+=" = ",t+=D(a.caddr(e)),t+="; ",t}function T2(e){let t="\\prod_{";return t+=D(a.caddr(e)),t+="=",t+=D(a.cadddr(e)),t+="}^{",t+=D(a.caddddr(e)),t+="}{",t+=D(a.cadr(e)),t+="}",t}function M2(e){let t=a.cadr(e),r=a.caddr(e),n=a.cadddr(e),s=a.caddddr(e);return"(function(){ var "+r+";  var holderProduct = 1;  var lowerlimit = "+D(n)+";  var upperlimit = "+D(s)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    holderProduct *= "+D(t)+"; }  return holderProduct;})()"}function gl(e,t){let r="";if(a.DEBUG&&console.log("power base: "+e+"  exponent: "+t),Tt.isoneovertwo(t))if(Tt.equaln(e,2)){if(a.defs.codeGen)return r+=k("Math.SQRT2"),r}else{if(a.defs.printMode===a.PRINTMODE_LATEX)return r+=k("\\sqrt{"),r+=D(e),r+=k("}"),r;if(a.defs.codeGen)return r+=k("Math.sqrt("),r+=D(e),r+=k(")"),r}if(Tt.equaln(ml.get_binding(a.symbol(a.PRINT_LEAVE_E_ALONE)),1)&&e===a.symbol(a.E))return a.defs.codeGen?(r+=k("Math.exp("),r+=Gg(t),r+=k(")"),r):(a.defs.printMode===a.PRINTMODE_LATEX?(r+=k("e^{"),r+=D(t),r+=k("}")):(r+=k("exp("),r+=D(t),r+=k(")")),r);if(a.defs.codeGen)return r+=k("Math.pow("),r+=Bg(e),r+=k(", "),r+=Gg(t),r+=k(")"),r;if(Tt.equaln(ml.get_binding(a.symbol(a.PRINT_LEAVE_X_ALONE)),0)||e.printname!=="x"){if(e!==a.symbol(a.E)){if(Tt.isminusone(t))return a.defs.printMode===a.PRINTMODE_LATEX?r+=k("\\frac{1}{"):a.defs.printMode===a.PRINTMODE_HUMAN&&!a.defs.test_flag?r+=k("1 / "):r+=k("1/"),a.iscons(e)&&a.defs.printMode!==a.PRINTMODE_LATEX?(r+=k("("),r+=D(e),r+=k(")")):r+=D(e),a.defs.printMode===a.PRINTMODE_LATEX&&(r+=k("}")),r;if(Tt.isnegativeterm(t)){a.defs.printMode===a.PRINTMODE_LATEX?r+=k("\\frac{1}{"):a.defs.printMode===a.PRINTMODE_HUMAN&&!a.defs.test_flag?r+=k("1 / "):r+=k("1/");let n=Ug.multiply(t,a.Constants.negOne);return a.iscons(e)&&a.defs.printMode!==a.PRINTMODE_LATEX?(r+=k("("),r+=gl(e,n),r+=k(")")):r+=gl(e,n),a.defs.printMode===a.PRINTMODE_LATEX&&(r+=k("}")),r}}if(Tt.isfraction(t)&&a.defs.printMode===a.PRINTMODE_LATEX){r+=k("\\sqrt");let n=Lh.denominator(t);return Tt.isplustwo(n)||(r+=k("["),r+=D(n),r+=k("]")),r+=k("{"),t=kh.numerator(t),r+=gl(e,t),r+=k("}"),r}}return a.defs.printMode===a.PRINTMODE_LATEX&&Tt.isplusone(t)?r+=D(e):(a.isadd(e)||Tt.isnegativenumber(e)?(r+=k("("),r+=D(e),r+=k(")")):a.ismultiply(e)||a.ispower(e)?(a.defs.printMode!==a.PRINTMODE_LATEX&&(r+=k("(")),r+=mn(e,!0),a.defs.printMode!==a.PRINTMODE_LATEX&&(r+=k(")"))):a.isNumericAtom(e)&&(Ai.lessp(e,a.Constants.zero)||Tt.isfraction(e))?(r+=k("("),r+=mn(e),r+=k(")")):r+=mn(e),a.defs.printMode===a.PRINTMODE_HUMAN&&!a.defs.test_flag?r+=k($h):r+=k("^"),a.defs.printMode===a.PRINTMODE_LATEX?D(t).length>1?(r+=k("{"),r+=D(t),r+=k("}")):r+=D(t):a.iscons(t)||Tt.isfraction(t)||a.isNumericAtom(t)&&Ai.lessp(t,a.Constants.zero)?(r+=k("("),r+=D(t),r+=k(")")):r+=mn(t)),r}function N2(e){let t="";if(e=a.cdr(e),a.caar(e)===a.symbol(a.ADD)||a.caar(e)===a.symbol(a.MULTIPLY)||a.caar(e)===a.symbol(a.POWER)||a.caar(e)===a.symbol(a.FACTORIAL)?t+=Fg(a.car(e)):t+=D(a.car(e)),t+=k("["),e=a.cdr(e),a.iscons(e))for(t+=D(a.car(e)),e=a.cdr(e);a.iscons(e);)t+=k(","),t+=D(a.car(e)),e=a.cdr(e);return t+=k("]"),t}function mn(e,t=!1,r=!1){let n="";if(a.isNumericAtom(e))return r&&Ai.lessp(e,a.Constants.zero)&&(n+="("),n+=Fu.print_number(e,r),r&&Ai.lessp(e,a.Constants.zero)&&(n+=")"),n;if(a.isstr(e))return n+=k('"'),n+=k(e.str),n+=k('"'),n;if(a.istensor(e))return a.defs.printMode===a.PRINTMODE_LATEX?n+=m2(e):n+=d2(e),n;if(a.ismultiply(e))return t||(bl(e)==="-"||a.defs.printMode!==a.PRINTMODE_LATEX)&&(a.defs.printMode===a.PRINTMODE_LATEX?n+=k(" \\left ("):n+=k("(")),n+=D(e),t||(bl(e)==="-"||a.defs.printMode!==a.PRINTMODE_LATEX)&&(a.defs.printMode===a.PRINTMODE_LATEX?n+=k(" \\right ) "):n+=k(")")),n;if(a.isadd(e))return t||(n+=k("(")),n+=D(e),t||(n+=k(")")),n;if(a.ispower(e)){let s=a.cadr(e),i=a.caddr(e);return n+=gl(s,i),n}if(a.car(e)===a.symbol(a.FUNCTION)){let s=a.cadr(e);if(!a.defs.codeGen){let i=a.caddr(e);n+=k("function "),a.DEBUG&&console.log(`emittedString from print_factor ${a.defs.stringsEmittedByUserPrintouts}`),n+=Io(i),n+=k(" -> ")}return n+=D(s),n}if(a.car(e)===a.symbol(a.PATTERN))return n+=D(a.caadr(e)),a.defs.printMode===a.PRINTMODE_LATEX?n+=k(" \\rightarrow "):a.defs.printMode===a.PRINTMODE_HUMAN&&!a.defs.test_flag?n+=k(" -> "):n+=k("->"),n+=D(a.car(a.cdr(a.cadr(e)))),n;if(a.car(e)===a.symbol(a.INDEX)&&a.issymbol(a.cadr(e)))return n+=N2(e),n;if(a.isfactorial(e))return n+=Xh(e),n;if(a.car(e)===a.symbol(a.ABS)&&a.defs.printMode===a.PRINTMODE_LATEX)return n+=Hh(e),n;if(a.car(e)===a.symbol(a.SQRT)&&a.defs.printMode===a.PRINTMODE_LATEX)return n+=i2(e),n;if(a.isfactorial(e)){if(a.defs.printMode===a.PRINTMODE_LATEX)return n+=o2(e),n;if(a.defs.codeGen)return n+=a2(e),n}else if(a.car(e)===a.symbol(a.UNIT)){if(a.defs.codeGen)return n+=l2(e),n}else if(a.isinv(e)){if(a.defs.printMode===a.PRINTMODE_LATEX)return n+=u2(e),n;if(a.defs.codeGen)return n+=c2(e),n}else{if(a.car(e)===a.symbol(a.BINOMIAL)&&a.defs.printMode===a.PRINTMODE_LATEX)return n+=Qh(e),n;if(a.car(e)===a.symbol(a.DEFINT)&&a.defs.printMode===a.PRINTMODE_LATEX)return n+=f2(e),n;if(a.isinnerordot(e)){if(a.defs.printMode===a.PRINTMODE_LATEX)return n+=Wh(e),n;if(a.defs.codeGen)return n+=Jh(e),n}else if(a.car(e)===a.symbol(a.SIN)){if(a.defs.codeGen)return n+=Kh(e),n}else if(a.car(e)===a.symbol(a.COS)){if(a.defs.codeGen)return n+=e2(e),n}else if(a.car(e)===a.symbol(a.TAN)){if(a.defs.codeGen)return n+=t2(e),n}else if(a.car(e)===a.symbol(a.ARCSIN)){if(a.defs.codeGen)return n+=r2(e),n}else if(a.car(e)===a.symbol(a.ARCCOS)){if(a.defs.codeGen)return n+=n2(e),n}else if(a.car(e)===a.symbol(a.ARCTAN)){if(a.defs.codeGen)return n+=s2(e),n}else if(a.car(e)===a.symbol(a.SUM)){if(a.defs.printMode===a.PRINTMODE_LATEX)return n+=_2(e),n;if(a.defs.codeGen)return n+=b2(e),n}else if(a.car(e)===a.symbol(a.PRODUCT)){if(a.defs.printMode===a.PRINTMODE_LATEX)return n+=T2(e),n;if(a.defs.codeGen)return n+=M2(e),n}else if(a.car(e)===a.symbol(a.FOR)){if(a.defs.codeGen)return n+=h2(e),n}else if(a.car(e)===a.symbol(a.DO)){if(a.defs.codeGen)return n+=A2(e),n}else if(a.car(e)===a.symbol(a.TEST)){if(a.defs.codeGen)return n+=y2(e),n;if(a.defs.printMode===a.PRINTMODE_LATEX)return n+=g2(e),n}else if(a.car(e)===a.symbol(a.TESTLT)){if(a.defs.codeGen)return n+="(("+D(a.cadr(e))+") < ("+D(a.caddr(e))+"))",n;if(a.defs.printMode===a.PRINTMODE_LATEX)return n+=v2(e),n}else if(a.car(e)===a.symbol(a.TESTLE)){if(a.defs.codeGen)return n+="(("+D(a.cadr(e))+") <= ("+D(a.caddr(e))+"))",n;if(a.defs.printMode===a.PRINTMODE_LATEX)return n+=p2(e),n}else if(a.car(e)===a.symbol(a.TESTGT)){if(a.defs.codeGen)return n+="(("+D(a.cadr(e))+") > ("+D(a.caddr(e))+"))",n;if(a.defs.printMode===a.PRINTMODE_LATEX)return n+=q2(e),n}else if(a.car(e)===a.symbol(a.TESTGE)){if(a.defs.codeGen)return n+="(("+D(a.cadr(e))+") >= ("+D(a.caddr(e))+"))",n;if(a.defs.printMode===a.PRINTMODE_LATEX)return n+=E2(e),n}else if(a.car(e)===a.symbol(a.TESTEQ)){if(a.defs.codeGen)return n+="(("+D(a.cadr(e))+") === ("+D(a.caddr(e))+"))",n;if(a.defs.printMode===a.PRINTMODE_LATEX)return n+=x2(e),n}else if(a.car(e)===a.symbol(a.FLOOR)){if(a.defs.codeGen)return n+="Math.floor("+D(a.cadr(e))+")",n;if(a.defs.printMode===a.PRINTMODE_LATEX)return n+=" \\lfloor {"+D(a.cadr(e))+"} \\rfloor ",n}else if(a.car(e)===a.symbol(a.CEILING)){if(a.defs.codeGen)return n+="Math.ceiling("+D(a.cadr(e))+")",n;if(a.defs.printMode===a.PRINTMODE_LATEX)return n+=" \\lceil {"+D(a.cadr(e))+"} \\rceil ",n}else if(a.car(e)===a.symbol(a.ROUND)){if(a.defs.codeGen)return n+="Math.round("+D(a.cadr(e))+")",n}else if(a.car(e)===a.symbol(a.SETQ))return a.defs.codeGen?(n+=O2(e),n):(n+=D(a.cadr(e)),n+=k("="),n+=D(a.caddr(e)),n)}if(a.iscons(e)){if(n+=mn(a.car(e)),e=a.cdr(e),t||(n+=k("(")),a.iscons(e))for(n+=D(a.car(e)),e=a.cdr(e);a.iscons(e);)n+=k(","),n+=D(a.car(e)),e=a.cdr(e);return t||(n+=k(")")),n}return e===a.symbol(a.DERIVATIVE)?n+=Yr("d"):e===a.symbol(a.E)?a.defs.codeGen?n+=k("Math.E"):n+=k("e"):e===a.symbol(a.PI)?a.defs.printMode===a.PRINTMODE_LATEX?n+=k("\\pi"):n+=k("pi"):n+=k(ml.get_printname(e)),n}function Io(e){let t="";switch(e.k){case a.CONS:for(t+="(",t+=Io(a.car(e)),e===a.cdr(e)&&(console.log("oh no recursive!"),a.breakpoint),e=a.cdr(e);a.iscons(e);)t+=" ",t+=Io(a.car(e)),e=a.cdr(e),e===a.cdr(e)&&e!==a.symbol(a.NIL)&&(console.log("oh no recursive!"),a.breakpoint);e!==a.symbol(a.NIL)&&(t+=" . ",t+=Io(e)),t+=")";break;case a.STR:t+=e.str;break;case a.NUM:case a.DOUBLE:t+=Fu.print_number(e,!0);break;case a.SYM:t+=ml.get_printname(e);break;default:t+="<tensor>"}return t}Mt.print_list=Io;function nm(){let e="";return a.defs.printMode===a.PRINTMODE_LATEX||(a.defs.printMode===a.PRINTMODE_HUMAN&&!a.defs.test_flag&&!a.defs.codeGen?e+=k(" "):e+=k("*")),e}function zu(e){return a.ispower(e)&&a.cadr(e)!==a.symbol(a.E)&&Tt.isnegativeterm(a.caddr(e))}function I2(e){for(e=a.cdr(e);a.iscons(e);){let t=a.car(e);if(zu(t))return!0;e=a.cdr(e)}return!1}});var Yu=N(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});So.divpoly=So.Eval_quotient=void 0;var Zs=w(),S2=B(),Yg=ge(),R2=Z(),Vg=qi(),sm=j(),im=ee(),w2=Ot();function L2(e){let t=sm.Eval(Zs.cadr(e)),r=sm.Eval(Zs.caddr(e)),n=sm.Eval(Zs.cadddr(e));n===Zs.symbol(Zs.NIL)&&(n=Zs.symbol(Zs.SYMBOL_X)),S2.push(Zg(t,r,n))}So.Eval_quotient=L2;function Zg(e,t,r){let n=Vg.coeff(e,r),s=n.length-1,i=Vg.coeff(t,r),l=i.length-1,u=s-l,c=Zs.Constants.zero;for(;u>=0;){let d=im.divide(n[s],i[l]);for(let _=0;_<=l;_++)n[u+_]=Yg.subtract(n[u+_],im.multiply(i[_],d));c=Yg.add(c,im.multiply(d,w2.power(r,R2.integer(u)))),s--,u--}return c}So.divpoly=Zg});var ms=N(wo=>{"use strict";Object.defineProperty(wo,"__esModule",{value:!0});wo.rect=wo.Eval_rect=void 0;var $t=w(),Ro=br(),C2=B(),om=dt(),Xg=dn(),am=ge(),Oi=Lo(),lm=$s(),k2=j(),Vu=se(),P2=oe(),Zu=ee(),Xu=rs(),yl=!1;function D2(e){let t=um(k2.Eval($t.cadr(e)));C2.push(t)}wo.Eval_rect=D2;function um(e){let t=e;if(yl&&(console.log(`RECT of ${t}`),console.log(`any clock forms in : ${t} ? ${Ro.findPossibleClockForm(t,e)}`)),$t.issymbol(e))return yl&&console.log(` rect: simple symbol: ${t}`),Vu.isZeroAtomOrTensor(om.get_binding($t.symbol($t.ASSUME_REAL_VARIABLES)))?P2.makeList($t.symbol($t.YYRECT),e):e;if(!Vu.isZeroAtomOrTensor(om.get_binding($t.symbol($t.ASSUME_REAL_VARIABLES)))&&!Ro.findPossibleExponentialForm(e)&&!Ro.findPossibleClockForm(e,e)&&!(Ro.Find(e,$t.symbol($t.SIN))&&Ro.Find(e,$t.symbol($t.COS))&&Ro.Find(e,$t.Constants.imaginaryunit)))return yl&&console.log(` rect: simple symbol: ${t}`),e;if($t.ismultiply(e)&&Vu.isimaginaryunit($t.cadr(e))&&!Vu.isZeroAtomOrTensor(om.get_binding($t.symbol($t.ASSUME_REAL_VARIABLES))))return e;if($t.isadd(e))return yl&&console.log(` rect - ${t} is a sum `),e.tail().reduce((n,s)=>am.add(n,um(s)),$t.Constants.zero);let r=Zu.multiply(Xg.abs(e),am.add(lm.cosine(Oi.arg(e)),Zu.multiply($t.Constants.imaginaryunit,Xu.sine(Oi.arg(e)))));return yl&&(console.log(` rect - ${t} is NOT a sum `),console.log(` rect - ${t} abs: ${Xg.abs(e)}`),console.log(` rect - ${t} arg of ${e} : ${e}`),console.log(` rect - ${t} cosine: ${lm.cosine(Oi.arg(e))}`),console.log(` rect - ${t} sine: ${Xu.sine(Oi.arg(e))}`),console.log(` rect - ${t} i * sine: ${Zu.multiply($t.Constants.imaginaryunit,Xu.sine(Oi.arg(e)))}`),console.log(` rect - ${t} cos + i * sine: ${am.add(lm.cosine(Oi.arg(e)),Zu.multiply($t.Constants.imaginaryunit,Xu.sine(Oi.arg(e))))}`),console.log(`rect of ${t} : ${r}`)),r}wo.rect=um});var fo=N(Hu=>{"use strict";Object.defineProperty(Hu,"__esModule",{value:!0});Hu.factorpoly=void 0;var $2=Ld(),qe=w(),U2=br(),B2=Oe(),Lr=B(),G2=Re(),Rn=ge(),Xs=Z(),Hg=qi(),Qg=sl(),F2=Ti(),j2=Sn(),Wg=Pd(),wn=se(),Ct=ee(),Co=Ot(),z2=Nn(),Y2=Yu(),cm=ms();function V2(e,t){return!U2.Find(e,t)||!wn.ispolyexpandedform(e,t)||!qe.issymbol(t)?e:Z2(e,t)}Hu.factorpoly=V2;function Z2(e,t){let r,n,s,i;wn.isfloating(e)&&B2.stop("floating point numbers in polynomial");let l=Hg.coeff(e,t),u=l.length-1,c=X2(l),d="real",_=null;for(;u>0;){var L,R;if(wn.isZeroAtomOrTensor(l[0])?(r=qe.Constants.one,n=qe.Constants.zero):d==="real"?[R,r,n]=H2(l,u,t,r,n):d==="complex"&&([L,r]=Q2(_,l,u)),d==="real")if(R===!1){d="complex";continue}else{for(s=Rn.add(Ct.multiply(r,t),n),qe.DEBUG&&console.log(`success
FACTOR=${s}`),c=Ct.multiply_noexpand(c,s),W2(r,n,l,u);u&&wn.isZeroAtomOrTensor(l[u]);)u--;let Y=qe.Constants.zero;for(let H=0;H<=u;H++)Y=Rn.add(Y,Ct.multiply(l[H],Co.power(t,Xs.integer(H))));_=Y}else if(d==="complex"){if(L===!1)break;{let Y=Rn.subtract(r,t),H=Rn.subtract(F2.conjugate(r),t);s=Ct.multiply(Y,H),qe.DEBUG&&console.log(`success
FACTOR=${s}`);let Se=c;if(c=Ct.multiply_noexpand(c,s),_==null){let We=qe.Constants.zero;for(let _t=0;_t<=u;_t++)We=Rn.add(We,Ct.multiply(l[_t],Co.power(t,Xs.integer(_t))));_=We}let it=t,ct=s,Ye=_;_=Y2.divpoly(Ye,ct,it);let xe=Ct.multiply(_,s);if(!G2.equal(xe,Ye)){qe.DEBUG&&(console.log("we found a polynomial based on complex root and its conj but it doesn't divide the poly, quitting"),console.log(`so just returning previousFactorisation times dividend: ${Se} * ${Ye}`)),Lr.push(Se);let We=qe.noexpand(Qg.yycondense,Ye),_t=Lr.pop();return Ct.multiply_noexpand(_t,We)}for(let We=0;We<=u;We++)l.pop();l.push(...Hg.coeff(_,t)),u-=2}}}let C=qe.Constants.zero;for(let Y=0;Y<=u;Y++)C=Rn.add(C,Ct.multiply(l[Y],Co.power(t,Xs.integer(Y))));return e=C,qe.DEBUG&&console.log(`POLY=${e}`),e=qe.noexpand(Qg.yycondense,e),u>0&&wn.isnegativeterm(l[u])&&(e=Ct.negate(e),c=Ct.negate_noexpand(c)),c=Ct.multiply_noexpand(c,e),qe.DEBUG&&console.log(`RESULT=${c}`),c}function X2(e){let t=qe.Constants.one;for(let r of e)t=$2.lcm(j2.denominator(r),t);for(let r=0;r<e.length;r++)e[r]=Ct.multiply(t,e[r]);return t=Ct.reciprocate(t),qe.DEBUG&&console.log("rationalize_coefficients result"),t}function H2(e,t,r,n,s){let i,l,u;if(qe.DEBUG){let C=qe.Constants.zero;for(let Y=0;Y<=t;Y++)C=Rn.add(C,Ct.multiply(e[Y],Co.power(r,Xs.integer(Y))));i=C,console.log(`POLY=${i}`)}let c=qe.defs.tos,d=qe.defs.tos;Lr.push_all(Wg.ydivisors(e[t]));let _=qe.defs.tos-d,L=qe.defs.tos;Lr.push_all(Wg.ydivisors(e[0]));let R=qe.defs.tos-L;if(qe.DEBUG){console.log("divisors of base term");for(let C=0;C<R;C++)console.log(`, ${qe.defs.stack[L+C]}`);console.log("divisors of leading term");for(let C=0;C<_;C++)console.log(`, ${qe.defs.stack[d+C]}`)}for(let C=0;C<_;C++)for(let Y=0;Y<R;Y++){if(n=qe.defs.stack[d+C],s=qe.defs.stack[L+Y],l=Ct.negate(Ct.divide(s,n)),[u]=vl(l,e,t),qe.DEBUG&&console.log(`try A=${n}
, B=${s}
, root ${r}
=-B/A=${l}
, POLY(${l}
)=${u}`),wn.isZeroAtomOrTensor(u))return Lr.moveTos(c),qe.DEBUG&&console.log("get_factor_from_real_root returning true"),[!0,n,s];if(s=Ct.negate(s),l=Ct.negate(l),[u]=vl(l,e,t),qe.DEBUG&&console.log(`try A=${n}
, B=${s}
, root ${r}
=-B/A=${l}
, POLY(${l}
)=${u}`),wn.isZeroAtomOrTensor(u))return Lr.moveTos(c),qe.DEBUG&&console.log("get_factor_from_real_root returning true"),[!0,n,s]}return Lr.moveTos(c),qe.DEBUG&&console.log("get_factor_from_real_root returning false"),[!1,n,s]}function Q2(e,t,r){let n,s,i,l;if(r<=2)return qe.DEBUG&&console.log("no more factoring via complex roots to be found in polynomial of degree <= 2"),[!1,s];n=e,qe.DEBUG&&console.log(`complex root finding for POLY=${n}`);let u=qe.defs.tos;if(s=cm.rect(Co.power(qe.Constants.negOne,Xs.rational(2,3))),qe.DEBUG&&console.log(`complex root finding: trying with ${s}`),i=s,Lr.push(i),[l]=vl(i,t,r),qe.DEBUG&&console.log(`complex root finding result: ${l}`),wn.isZeroAtomOrTensor(l))return Lr.moveTos(u),qe.DEBUG&&console.log("get_factor_from_complex_root returning true"),[!0,s];if(s=cm.rect(Co.power(qe.Constants.one,Xs.rational(2,3))),qe.DEBUG&&console.log(`complex root finding: trying with ${s}`),i=s,Lr.push(i),[l]=vl(i,t,r),qe.DEBUG&&console.log(`complex root finding result: ${l}`),wn.isZeroAtomOrTensor(l))return Lr.moveTos(u),qe.DEBUG&&console.log("get_factor_from_complex_root returning true"),[!0,s];for(let c=-10;c<=10;c++)for(let d=1;d<=5;d++){s=cm.rect(Rn.add(Xs.integer(c),Ct.multiply(Xs.integer(d),qe.Constants.imaginaryunit)));let _=s;Lr.push(_);let[L]=vl(_,t,r);if(wn.isZeroAtomOrTensor(L))return Lr.moveTos(u),qe.DEBUG&&console.log(`found complex root: ${L}`),[!0,s]}return Lr.moveTos(u),qe.DEBUG&&console.log("get_factor_from_complex_root returning false"),[!1,s]}function W2(e,t,r,n){let s=qe.Constants.zero;for(let i=n;i>0;i--){let l=Ct.divide(r[i],e);r[i]=s,s=l,r[i-1]=Rn.subtract(r[i-1],Ct.multiply(s,t))}r[0]=s,qe.DEBUG&&console.log("yydivpoly Q:")}function vl(e,t,r){let n=qe.Constants.zero;for(let i=r;i>=0;i--)qe.DEBUG&&(console.log("Evalpoly top of stack:"),console.log(z2.print_list(n))),n=Rn.add(Ct.multiply(n,e),t[i]);return[n]}});var tn=N(Qu=>{"use strict";Object.defineProperty(Qu,"__esModule",{value:!0});Qu.guess=void 0;var Ut=w(),pl=br();function J2(e){return pl.Find(e,Ut.symbol(Ut.SYMBOL_X))?Ut.symbol(Ut.SYMBOL_X):pl.Find(e,Ut.symbol(Ut.SYMBOL_Y))?Ut.symbol(Ut.SYMBOL_Y):pl.Find(e,Ut.symbol(Ut.SYMBOL_Z))?Ut.symbol(Ut.SYMBOL_Z):pl.Find(e,Ut.symbol(Ut.SYMBOL_T))?Ut.symbol(Ut.SYMBOL_T):pl.Find(e,Ut.symbol(Ut.SYMBOL_S))?Ut.symbol(Ut.SYMBOL_S):Ut.symbol(Ut.SYMBOL_X)}Qu.guess=J2});var fm=N(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.msub=ko.madd=void 0;function K2(e,t){return e.add(t)}ko.madd=K2;function eA(e,t){return e.subtract(t)}ko.msub=eA});var Do=N(Po=>{"use strict";var tA=Po&&Po.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Po,"__esModule",{value:!0});Po.mgcd=void 0;var rA=tA(Ps());function nA(e,t){return rA.default.gcd(e,t)}Po.mgcd=nA});var _n=N(Ln=>{"use strict";Object.defineProperty(Ln,"__esModule",{value:!0});Ln.mdivrem=Ln.mmod=Ln.mdiv=Ln.mmul=void 0;function sA(e,t){return e.multiply(t)}Ln.mmul=sA;function iA(e,t){return e.divide(t)}Ln.mdiv=iA;function oA(e,t){return e.mod(t)}Ln.mmod=oA;function aA(e,t){let r=e.divmod(t);return[r.quotient,r.remainder]}Ln.mdivrem=aA});var dm=N(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0});Wu.mprime=void 0;function lA(e){return e.isProbablePrime()}Wu.mprime=lA});var ty=N(Uo=>{"use strict";var uA=Uo&&Uo.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Uo,"__esModule",{value:!0});Uo.factor_number=void 0;var cA=uA(Ps()),bn=w(),Jg=vu(),fA=Oe(),Hs=Z(),mm=se(),Kg=oe(),ey=fm(),dA=Do(),$o=_n(),mA=dm(),er=cA.default(0);function _A(e){if(mm.equaln(e,0)||mm.equaln(e,1)||mm.equaln(e,-1))return e;er=e.q.a;let t=bA();if(t.length===0,t.length===1)return t[0];if(t.length>1)return new bn.Cons(bn.symbol(bn.MULTIPLY),Kg.makeList(...t))}Uo.factor_number=_A;function bA(){let e=[];er.isNegative()&&(er=Hs.setSignTo(er,1),e.push(bn.Constants.negOne));for(let t=0;t<1e4;t++)if(e.push(...gA(t)),er.compare(1)===0)return e;return e.push(...yA()),e}function gA(e){let t=[],r,n=Hs.mint(bn.primetab[e]),s=0;for(;;){if(er.compare(1)===0)return s&&t.push(ql(n,s)),t;let i;if([r,i]=Array.from($o.mdivrem(er,n)),i.isZero())s++,er=r;else break}return s&&t.push(ql(n,s)),Jg.mcmp(r,n)===-1&&(t.push(ql(er,1)),er=Hs.mint(1)),t}function yA(){let e=[],t=Hs.mint(1),r=Hs.mint(5),n=Hs.mint(2),s=1,i=1;for(;;){if(mA.mprime(er))return e.push(ql(er,1)),e;for(;;){bn.defs.esc_flag&&fA.stop("esc");let l=ey.msub(n,r);l=Hs.setSignTo(l,1);let u=dA.mgcd(l,er);if(bn.MEQUAL(u,1)){--s==0&&(n=r,i*=2,s=i),l=$o.mmul(r,r),r=ey.madd(l,t),l=$o.mmod(r,er),r=l;continue}if(e.push(ql(u,1)),Jg.mcmp(u,er)===0)return e;l=$o.mdiv(er,u),er=l,l=$o.mmod(r,er),r=l,l=$o.mmod(n,er),n=l;break}}}function ql(e,t){let r=new bn.Num(e);return t>1&&(r=Kg.makeList(bn.symbol(bn.POWER),r,new bn.Num(Hs.mint(t)))),r}});var il=N(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});Qs.factor_small_number=Qs.factor=Qs.Eval_factor=void 0;var gn=w(),vA=Oe(),pA=B(),_m=Z(),bm=j(),ry=fo(),qA=tn(),EA=se(),xA=ee(),hA=ty();function AA(e){let t=bm.Eval(gn.cadr(e)),r=bm.Eval(gn.caddr(e)),n=r===gn.symbol(gn.NIL)?qA.guess(t):r,s=sy(t,n);e=gn.cdddr(e),gn.iscons(e)&&(s=[...e].reduce((i,l)=>OA(i,bm.Eval(l)),s)),pA.push(s)}Qs.Eval_factor=AA;function OA(e,t){if(gn.ismultiply(e)){let n=[];return e.tail().forEach(s=>ny(n,s,t)),xA.multiply_all_noexpand(n)}let r=[];return ny(r,e,t),r[0]}function ny(e,t,r){let n=ry.factorpoly(t,r);if(gn.ismultiply(n)){e.push(...n.tail());return}e.push(n)}function sy(e,t){return EA.isinteger(e)?hA.factor_number(e):ry.factorpoly(e,t)}Qs.factor=sy;function TA(e){isNaN(e)&&vA.stop("number too big to factor");let t=[];e<0&&(e=-e);for(let r=0;r<gn.MAXPRIMETAB;r++){let n=gn.primetab[r];if(n>e/n)break;let s=0;for(;e%n==0;)e/=n,s++;s&&(t.push(_m.integer(n)),t.push(_m.integer(s)))}return e>1&&(t.push(_m.integer(e)),t.push(gn.Constants.one)),t}Qs.factor_small_number=TA});var ly=N(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:!0});Bo.quickpower=Bo.quickfactor=void 0;var Ju=w(),MA=ge(),Ku=Z(),NA=il(),IA=se(),iy=oe(),oy=ee();function SA(e,t){let r=NA.factor_small_number(Ku.nativeInt(e)),n=r.length;for(let s=0;s<n;s+=2)r.push(...ay(r[s],oy.multiply(r[s+1],t)));return oy.multiply_all(r.slice(n))}Bo.quickfactor=SA;function ay(e,t){let r=Ku.bignum_truncate(t),n=MA.subtract(t,r),s;IA.isZeroAtomOrTensor(n)||(s=iy.makeList(Ju.symbol(Ju.POWER),e,n));let i=Ku.nativeInt(r);if(isNaN(i)){let u=iy.makeList(Ju.symbol(Ju.POWER),e,r);return s?[s,u]:[u]}if(i===0)return[s];let l=Ku.bignum_power_number(e,i);return s?[s,l]:[l]}Bo.quickpower=ay});var cy=N(Go=>{"use strict";var RA=Go&&Go.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Go,"__esModule",{value:!0});Go.qpow=void 0;var wA=RA(Ps()),tr=w(),LA=Oe(),uy=ge(),_s=Z(),Vr=se(),ec=oe(),gm=Nu(),CA=Kb(),El=ee(),kA=ly();function xl(e,t){return PA(e,t)}Go.qpow=xl;function PA(e,t){if(Vr.isplusone(e)||Vr.isZeroAtomOrTensor(t))return tr.Constants.one;if(Vr.isminusone(e)&&Vr.isoneovertwo(t))return tr.Constants.imaginaryunit;if(Vr.isZeroAtomOrTensor(e))return Vr.isnegativenumber(t)&&LA.stop("divide by zero"),tr.Constants.zero;if(Vr.isplusone(t))return e;let r=0,n,s;if(Vr.isinteger(t)){if(r=_s.nativeInt(t),isNaN(r))return ec.makeList(tr.symbol(tr.POWER),e,t);if(n=gm.mpow(e.q.a,Math.abs(r)),s=gm.mpow(e.q.b,Math.abs(r)),r<0){let u=n;n=s,s=u,n=_s.makeSignSameAs(n,s),s=_s.makePositive(s)}return new tr.Num(n,s)}if(Vr.isminusone(e))return DA(t);if(Vr.isnegativenumber(e))return El.multiply(xl(El.negate(e),t),xl(tr.Constants.negOne,t));if(!Vr.isinteger(e))return El.multiply(xl(_s.mp_numerator(e),t),xl(_s.mp_denominator(e),El.negate(t)));if($A(e))return kA.quickfactor(e,t);if(!_s.isSmall(t.q.a)||!_s.isSmall(t.q.b))return ec.makeList(tr.symbol(tr.POWER),e,t);let{a:i,b:l}=t.q;return n=CA.mroot(e.q.a,l.toJSNumber()),n===0?ec.makeList(tr.symbol(tr.POWER),e,t):(s=gm.mpow(n,i),t.q.a.isNegative()?new tr.Num(wA.default.one,s):new tr.Num(s))}function DA(e){if(Vr.isinteger(e))return e.q.a.isOdd()?tr.Constants.negOne:tr.Constants.one;let t=_s.bignum_truncate(e);Vr.isnegativenumber(e)&&(t=uy.add(t,tr.Constants.negOne));let r=uy.subtract(e,t),n=ec.makeList(tr.symbol(tr.POWER),tr.Constants.negOne,r);return t.q.a.isOdd()&&(n=El.negate(n)),n}function $A(e){return _s.isSmall(e.q.a)}});var Ot=N(jo=>{"use strict";Object.defineProperty(jo,"__esModule",{value:!0});jo.power=jo.Eval_power=void 0;var $=w(),tc=br(),fy=B(),UA=dt(),hl=Re(),dy=dn(),rc=ge(),BA=Lo(),Cr=Z(),GA=Ti(),FA=$s(),jA=Qb(),my=j(),_y=yi(),Nt=se(),Fo=oe(),or=ee(),zA=cy(),by=ms(),YA=rs(),VA=Et(),tt=!1;function ZA(e){tt&&$.breakpoint;let t=my.Eval($.caddr(e)),r=my.Eval($.cadr(e));fy.push(kr(r,t))}jo.Eval_power=ZA;function kr(e,t){return XA(e,t)}jo.power=kr;function XA(e,t){tt&&$.breakpoint;let r=t,n=e;if(tt&&console.log(`POWER: ${e} ^ ${t}`),hl.equal(e,$.Constants.one)||Nt.isZeroAtomOrTensor(t)){let d=$.Constants.One();return tt&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(hl.equal(t,$.Constants.one))return tt&&console.log(`   power of ${n} ^ ${r}: ${e}`),e;if(Nt.isminusone(e)&&Nt.isminusone(t)){let d=or.negate($.Constants.One());return tt&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(Nt.isminusone(e)&&Nt.isoneovertwo(t)){let d=$.Constants.imaginaryunit;return tt&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(Nt.isminusone(e)&&Nt.isminusoneovertwo(t)){let d=or.negate($.Constants.imaginaryunit);return tt&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}let s;if(Nt.isminusone(e)&&!$.isdouble(e)&&$.isrational(t)&&!Nt.isinteger(t)&&Nt.ispositivenumber(t)&&!$.defs.evaluatingAsFloats){tt&&(console.log("   power: -1 ^ rational"),console.log(` trick: exponent.q.a , exponent.q.b ${t.q.a} , ${t.q.b}`)),t.q.a<t.q.b?s=Fo.makeList($.symbol($.POWER),e,t):(s=Fo.makeList($.symbol($.MULTIPLY),e,Fo.makeList($.symbol($.POWER),e,Cr.rational(t.q.a.mod(t.q.b),t.q.b))),tt&&console.log(` trick applied : ${s}`));let d=by.rect(s);return tt&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if($.isrational(e)&&$.isrational(t)){tt&&console.log("   power: isrational(base) && isrational(exponent)");let d=zA.qpow(e,t);return tt&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if($.isNumericAtom(e)&&$.isNumericAtom(t)){let d=jA.dpow(Cr.nativeDouble(e),Cr.nativeDouble(t));return tt&&(console.log("   power: both base and exponent are either rational or double "),console.log("POWER - isNumericAtom(base) && isNumericAtom(exponent)"),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if($.istensor(e)){let d=VA.power_tensor(e,t);return tt&&(console.log("   power: istensor(base) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if($.car(e)===$.symbol($.ABS)&&Nt.iseveninteger(t)&&!Nt.isZeroAtomOrTensor(UA.get_binding($.symbol($.ASSUME_REAL_VARIABLES)))){let d=kr($.cadr(e),t);return tt&&(console.log("   power: even power of absolute of real value "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(e===$.symbol($.E)&&$.car(t)===$.symbol($.LOG)){let d=$.cadr(t);return tt&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}if(e===$.symbol($.E)&&$.isdouble(t)){let d=Cr.double(Math.exp(t.d));return tt&&(console.log("   power: base == symbol(E) && isdouble(exponent) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(e===$.symbol($.E)&&tc.Find(t,$.Constants.imaginaryunit)&&tc.Find(t,$.symbol($.PI))&&!$.defs.evaluatingPolar){let d=Fo.makeList($.symbol($.POWER),e,t);tt&&console.log(`   power: turning complex exponential to rect: ${fy.top()}`);let _=by.rect(d);if(!tc.Find(_,$.symbol($.PI)))return tt&&console.log(`   power: turned complex exponential to rect: ${_}`),_}if($.ismultiply(e)&&Nt.isinteger(t)){e=$.cdr(e);let d=kr($.car(e),t);return $.iscons(e)&&(d=e.tail().reduce((_,L)=>or.multiply(_,kr(L,t)),d)),tt&&(console.log("   power: (a * b) ^ c  ->  (a ^ c) * (b ^ c) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}let i=!1;if($.isNumericAtom($.cadr(e))&&(i=hl.sign(Cr.compare_numbers($.cadr(e),$.Constants.zero))>0),$.ispower(e)&&(Nt.isinteger(t)||i)){let d=kr($.cadr(e),or.multiply($.caddr(e),t));return tt&&console.log(`   power of ${n} ^ ${r}: ${d}`),d}let l=!1;if(Nt.iseveninteger($.caddr(e))){let d=or.multiply($.caddr(e),t);Nt.isone(d)&&(l=!0)}if($.ispower(e)&&l){let d=dy.abs($.cadr(e));return tt&&(console.log("   power: car(base) == symbol(POWER) && b_isEven_and_c_isItsInverse "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if($.defs.expanding&&$.isadd(e)&&$.isNumericAtom(t)){let d=Cr.nativeInt(t);if(d>1&&!isNaN(d)){tt&&console.log("   power: expanding && isadd(base) && isNumericAtom(exponent) ");let _=HA(d,e);return tt&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}}if($.defs.trigmode===1&&$.car(e)===$.symbol($.SIN)&&Nt.iseveninteger(t)){let d=kr(rc.subtract($.Constants.one,kr(FA.cosine($.cadr(e)),Cr.integer(2))),or.multiply(t,Cr.rational(1,2)));return tt&&(console.log("   power: trigmode == 1 && car(base) == symbol(SIN) && iseveninteger(exponent) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if($.defs.trigmode===2&&$.car(e)===$.symbol($.COS)&&Nt.iseveninteger(t)){let d=kr(rc.subtract($.Constants.one,kr(YA.sine($.cadr(e)),Cr.integer(2))),or.multiply(t,Cr.rational(1,2)));return tt&&(console.log("   power: trigmode == 2 && car(base) == symbol(COS) && iseveninteger(exponent) "),console.log(`   power of ${n} ^ ${r}: ${d}`)),d}if(Nt.iscomplexnumber(e)){if(tt&&console.log(" power - handling the case (a + ib) ^ n"),Nt.isinteger(t)){let d=GA.conjugate(e),_=or.divide(d,or.multiply(d,e));return Nt.isone(t)||(_=kr(_,or.negate(t))),tt&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}if($.isNumericAtom(t)){let d=$.defs.evaluatingAsFloats||Nt.iscomplexnumberdouble(e)&&$.isdouble(t)?Cr.double(Math.PI):$.symbol($.PI),_=or.multiply(kr(dy.abs(e),t),kr($.Constants.negOne,or.divide(or.multiply(BA.arg(e),t),d)));return $.avoidCalculatingPowersIntoArctans&&tc.Find(_,$.symbol($.ARCTAN))&&(_=Fo.makeList($.symbol($.POWER),e,t)),tt&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}}let u=QA(t);if(u!==void 0)return tt&&console.log("   power: using simplify_polar"),u;let c=Fo.makeList($.symbol($.POWER),e,t);return tt&&(console.log("   power: nothing can be done "),console.log(`   power of ${n} ^ ${r}: ${c}`)),c}function HA(e,t){let r=[],n=hl.length(t)-1,s=[];t=$.cdr(t);for(let i=0;i<n;i++){for(let l=0;l<=e;l++)s[i*(e+1)+l]=kr($.car(t),Cr.integer(l));t=$.cdr(t)}t=_y.factorial(Cr.integer(e));for(let i=0;i<n;i++)r[i]=0;return gy(n,e,r,0,e,s,t,$.Constants.zero)}function gy(e,t,r,n,s,i,l,u){if(n<e-1){for(let d=0;d<=s;d++)r[n]=d,u=gy(e,t,r,n+1,s-d,i,l,u);return u}r[n]=s;let c=l;for(let d=0;d<e;d++)c=or.divide(c,_y.factorial(Cr.integer(r[d])));for(let d=0;d<e;d++)c=or.multiply(c,i[d*(t+1)+r[d]]);return rc.add(u,c)}function QA(e){let t=Nt.isquarterturn(e);switch(t){case 0:break;case 1:return $.Constants.one;case 2:return $.Constants.negOne;case 3:return $.Constants.imaginaryunit;case 4:return or.negate($.Constants.imaginaryunit)}if($.isadd(e)){let r=$.cdr(e);for(;$.iscons(r)&&(t=Nt.isquarterturn($.car(r)),!t);)r=$.cdr(r);let n;switch(t){case 0:return;case 1:n=$.Constants.one;break;case 2:n=$.Constants.negOne;break;case 3:n=$.Constants.imaginaryunit;break;case 4:n=or.negate($.Constants.imaginaryunit);break}return or.multiply(n,hl.exponential(rc.subtract(e,$.car(r))))}}});var ee=N(Bt=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.negate_noexpand=Bt.negate=Bt.reciprocate=Bt.inverse=Bt.divide=Bt.multiply_all_noexpand=Bt.multiply_all=Bt.multiply_noexpand=Bt.multiply=Bt.Eval_multiply=void 0;var M=w(),yy=Oe(),ar=B(),WA=Re(),Al=ge(),bs=Z(),vy=j(),yr=se(),zo=oe(),py=Ot(),qy=Et(),JA=cs();function KA(e){let t=vy.Eval(M.cadr(e));e=M.cddr(e),M.iscons(e)&&(t=[...e].reduce((r,n)=>Ws(r,vy.Eval(n)),t)),ar.push(t)}Bt.Eval_multiply=KA;function Ws(e,t){return M.defs.esc_flag&&yy.stop("escape key stop"),M.isNumericAtom(e)&&M.isNumericAtom(t)?bs.multiply_numbers(e,t):eO(e,t)}Bt.multiply=Ws;function eO(e,t){let r=M.defs.tos;if(yr.isZeroAtom(e)||yr.isZeroAtom(t))return M.Constants.Zero();if(M.defs.expanding&&M.isadd(e))return e.tail().reduce((_,L)=>Al.add(_,Ws(L,t)),M.Constants.Zero());if(M.defs.expanding&&M.isadd(t))return t.tail().reduce((_,L)=>Al.add(_,Ws(e,L)),M.Constants.Zero());if(!M.istensor(e)&&M.istensor(t))return qy.scalar_times_tensor(e,t);if(M.istensor(e)&&!M.istensor(t))return qy.tensor_times_scalar(e,t);if(e=M.ismultiply(e)?M.cdr(e):zo.makeList(e),t=M.ismultiply(t)?M.cdr(t):zo.makeList(t),M.isNumericAtom(M.car(e))&&M.isNumericAtom(M.car(t))){let _=M.car(e),L=M.car(t);ar.push(bs.multiply_numbers(_,L)),e=M.cdr(e),t=M.cdr(t)}else M.isNumericAtom(M.car(e))?(ar.push(M.car(e)),e=M.cdr(e)):M.isNumericAtom(M.car(t))?(ar.push(M.car(t)),t=M.cdr(t)):ar.push(M.Constants.One());let[n,s]=nc(e),[i,l]=sc(t);for(;M.iscons(e)&&M.iscons(t);){if(M.caar(e)===M.symbol(M.OPERATOR)&&M.caar(t)===M.symbol(M.OPERATOR)){ar.push(new M.Cons(M.symbol(M.OPERATOR),JA.append(M.cdar(e),M.cdar(t)))),e=M.cdr(e),t=M.cdr(t),[n,s]=nc(e),[i,l]=sc(t);continue}switch(WA.cmp_expr(n,i)){case-1:ar.push(M.car(e)),e=M.cdr(e),[n,s]=nc(e);break;case 1:ar.push(M.car(t)),t=M.cdr(t),[i,l]=sc(t);break;case 0:tO(r,i,s,l),e=M.cdr(e),t=M.cdr(t),[n,s]=nc(e),[i,l]=sc(t);break;default:yy.stop("internal error 2")}}let u=[];if(M.iscons(e)&&u.push(...e),M.iscons(t)&&u.push(...t),ar.push_all(u),oO(r),M.defs.expanding){for(let _=r;_<M.defs.tos;_++)if(M.isadd(M.defs.stack[_])){let L=ar.pop_n_items(M.defs.tos-r);return ym(L)}}let c=M.defs.tos-r;if(c===1)return ar.pop();if(M.isrational(M.defs.stack[r])&&yr.equaln(M.defs.stack[r],1))if(c===2){let _=ar.pop();return ar.pop(),_}else return M.defs.stack[r]=M.symbol(M.MULTIPLY),zo.list(c),ar.pop();zo.list(c);let d=ar.pop();return new M.Cons(M.symbol(M.MULTIPLY),d)}function nc(e){let t=M.car(e),r=M.Constants.One();return M.ispower(t)&&(r=M.caddr(t),t=M.cadr(t)),[t,r]}function sc(e){let t=M.car(e),r=M.Constants.One();return M.ispower(t)&&(r=M.caddr(t),t=M.cadr(t)),[t,r]}function tO(e,t,r,n){let s=py.power(t,Al.add(r,n));if(M.isNumericAtom(s))M.defs.stack[e]=bs.multiply_numbers(M.defs.stack[e],s);else if(M.ismultiply(s))if(M.isNumericAtom(M.cadr(s))&&M.cdddr(s)===M.symbol(M.NIL)){let i=M.defs.stack[e],l=M.cadr(s);M.defs.stack[e]=bs.multiply_numbers(i,l),ar.push(M.caddr(s))}else ar.push(s);else ar.push(s)}function rO(e,t){return M.noexpand(Ws,e,t)}Bt.multiply_noexpand=rO;function ym(e){if(e.length===1)return e[0];if(e.length===0)return M.Constants.One();let t=e[0];for(let r=1;r<e.length;r++)t=Ws(t,e[r]);return t}Bt.multiply_all=ym;function nO(e){return M.noexpand(ym,e)}Bt.multiply_all_noexpand=nO;function Ol(e,t){return M.isNumericAtom(e)&&M.isNumericAtom(t)?bs.divide_numbers(e,t):Ws(e,vm(t))}Bt.divide=Ol;function vm(e){return M.isNumericAtom(e)?bs.invert_number(e):py.power(e,M.Constants.negOne)}Bt.inverse=vm;function sO(e){return vm(e)}Bt.reciprocate=sO;function Ey(e){return M.isNumericAtom(e)?bs.negate_number(e):Ws(e,M.Constants.NegOne())}Bt.negate=Ey;function iO(e){return M.noexpand(Ey,e)}Bt.negate_noexpand=iO;function oO(e){let t=0;if(yr.isplusone(M.defs.stack[e])||yr.isminusone(M.defs.stack[e])||M.isdouble(M.defs.stack[e]))return;for(t=e+1;t<M.defs.tos&&!pm(M.defs.stack[t]);t++);if(t===M.defs.tos)return;let r=bs.mp_numerator(M.defs.stack[e]);for(let s=e+1;s<M.defs.tos&&!(yr.isplusone(r)||yr.isminusone(r));s++){if(!pm(M.defs.stack[s]))continue;let i=M.cadr(M.defs.stack[s]),l=M.caddr(M.defs.stack[s]);if(!yr.isnegativenumber(l))continue;let u=Ol(r,i);!yr.isinteger(u)||(r=u,M.defs.stack[s]=zo.makeList(M.symbol(M.POWER),i,Al.add(M.Constants.One(),l)))}let n=bs.mp_denominator(M.defs.stack[e]);for(let s=e+1;s<M.defs.tos&&!yr.isplusone(n);s++){if(!pm(M.defs.stack[s]))continue;let i=M.cadr(M.defs.stack[s]),l=M.caddr(M.defs.stack[s]);if(yr.isnegativenumber(l))continue;let u=Ol(n,i);if(!yr.isinteger(u))continue;n=u;let c=Al.subtract(l,M.Constants.one);if(M.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication&&yr.isinteger(i)&&!yr.isinteger(c)&&yr.isnegativenumber(c)){r=Ol(r,i);break}M.defs.stack[s]=zo.makeList(M.symbol(M.POWER),i,c)}M.defs.stack[e]=Ol(r,n)}function pm(e){return M.ispower(e)&&M.isNumericAtom(M.cadr(e))&&yr.isfraction(M.caddr(e))&&!yr.isminusone(M.cadr(e))}});var Sn=N(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});Yo.denominator=Yo.Eval_denominator=void 0;var gs=w(),aO=B(),lO=Z(),uO=j(),xy=se(),hy=ee(),cO=ol();function fO(e){let t=qm(uO.Eval(gs.cadr(e)));aO.push(t)}Yo.Eval_denominator=fO;function qm(e){return gs.isadd(e)&&(e=cO.rationalize(e)),gs.ismultiply(e)&&!xy.isplusone(gs.car(gs.cdr(e)))?hy.multiply_all(e.tail().map(qm)):gs.isrational(e)?lO.mp_denominator(e):gs.ispower(e)&&xy.isnegativeterm(gs.caddr(e))?hy.reciprocate(e):gs.Constants.one}Yo.denominator=qm});var xm=N(Vo=>{"use strict";Object.defineProperty(Vo,"__esModule",{value:!0});Vo.arctan=Vo.Eval_arctan=void 0;var pe=w(),Ay=br(),dO=B(),mO=Re(),ic=Z(),_O=Sn(),bO=j(),Cn=se(),gO=oe(),Tl=ee(),yO=ls();function vO(e){dO.push(Em(bO.Eval(pe.cadr(e))))}Vo.Eval_arctan=vO;function Em(e){if(pe.car(e)===pe.symbol(pe.TAN))return pe.cadr(e);if(pe.isdouble(e))return ic.double(Math.atan(e.d));if(Cn.isZeroAtomOrTensor(e))return pe.Constants.zero;if(Cn.isnegative(e))return Tl.negate(Em(Tl.negate(e)));if(Ay.Find(e,pe.symbol(pe.SIN))&&Ay.Find(e,pe.symbol(pe.COS))){let t=yO.numerator(e),r=_O.denominator(e);if(pe.car(t)===pe.symbol(pe.SIN)&&pe.car(r)===pe.symbol(pe.COS)&&mO.equal(pe.cadr(t),pe.cadr(r)))return pe.cadr(t)}return pe.ispower(e)&&Cn.equaln(pe.cadr(e),3)&&Cn.equalq(pe.caddr(e),-1,2)||pe.ismultiply(e)&&Cn.equalq(pe.car(pe.cdr(e)),1,3)&&pe.car(pe.car(pe.cdr(pe.cdr(e))))===pe.symbol(pe.POWER)&&Cn.equaln(pe.car(pe.cdr(pe.car(pe.cdr(pe.cdr(e))))),3)&&Cn.equalq(pe.car(pe.cdr(pe.cdr(pe.car(pe.cdr(pe.cdr(e)))))),1,2)?Tl.multiply(ic.rational(1,6),pe.Constants.Pi()):Cn.equaln(e,1)?Tl.multiply(ic.rational(1,4),pe.Constants.Pi()):pe.ispower(e)&&Cn.equaln(pe.cadr(e),3)&&Cn.equalq(pe.caddr(e),1,2)?Tl.multiply(ic.rational(1,3),pe.Constants.Pi()):gO.makeList(pe.symbol(pe.ARCTAN),e)}Vo.arctan=Em});var Ml=N(Zo=>{"use strict";Object.defineProperty(Zo,"__esModule",{value:!0});Zo.imag=Zo.Eval_imag=void 0;var Oy=w(),pO=B(),qO=ge(),EO=Z(),xO=Ti(),hO=j(),Ty=ee(),AO=ms(),OO=!1;function TO(e){let t=My(hO.Eval(Oy.cadr(e)));pO.push(t)}Zo.Eval_imag=TO;function My(e){let t=AO.rect(e),r=xO.conjugate(t),n=Ty.divide(qO.subtract(t,r),EO.integer(2)),s=Ty.divide(n,Oy.Constants.imaginaryunit);return OO&&(console.log(`IMAGE of ${t}`),console.log(` image: conjugate result: ${r}`),console.log(` image: 1st divide result: ${n}`),console.log(` image: 2nd divide result: ${s}`)),s}Zo.imag=My});var Ho=N(Xo=>{"use strict";Object.defineProperty(Xo,"__esModule",{value:!0});Xo.real=Xo.Eval_real=void 0;var MO=w(),NO=B(),IO=ge(),SO=Z(),RO=Ti(),wO=j(),LO=ee(),CO=ms();function kO(e){let t=Ny(wO.Eval(MO.cadr(e)));NO.push(t)}Xo.Eval_real=kO;function Ny(e){let t=CO.rect(e);return LO.divide(IO.add(t,RO.conjugate(t)),SO.integer(2))}Xo.real=Ny});var Lo=N(Qo=>{"use strict";Object.defineProperty(Qo,"__esModule",{value:!0});Qo.arg=Qo.Eval_arg=void 0;var Ce=w(),PO=B(),DO=dt(),oc=ge(),$O=xm(),UO=Sn(),BO=j(),Iy=Ml(),ys=se(),Sy=oe(),Nl=ee(),GO=ls(),FO=Ho(),jO=ms(),zO=!1;function YO(e){PO.push(ac(BO.Eval(Ce.cadr(e))))}Qo.Eval_arg=YO;function ac(e){return oc.subtract(Ry(GO.numerator(e)),Ry(UO.denominator(e)))}Qo.arg=ac;function Ry(e){if(ys.ispositivenumber(e)||e===Ce.symbol(Ce.PI))return Ce.isdouble(e)||Ce.defs.evaluatingAsFloats?Ce.Constants.zeroAsDouble:Ce.Constants.zero;if(ys.isnegativenumber(e)){let t=Ce.isdouble(e)||Ce.defs.evaluatingAsFloats?Ce.Constants.piAsDouble:Ce.symbol(Ce.PI);return Nl.negate(t)}if(Ce.issymbol(e))return Sy.makeList(Ce.symbol(Ce.ARG),e);if(Ce.ispower(e)&&ys.equaln(Ce.cadr(e),-1))return Nl.multiply(Ce.Constants.Pi(),Ce.caddr(e));if(Ce.ispower(e)&&Ce.cadr(e)===Ce.symbol(Ce.E))return Iy.imag(Ce.caddr(e));if(Ce.ispower(e)&&ys.isoneovertwo(Ce.caddr(e))){let t=ac(Ce.cadr(e));return zO&&(console.log(`arg of a sqrt: ${e}`),Ce.breakpoint,console.log(` = 1/2 * ${t}`)),Nl.multiply(t,Ce.caddr(e))}if(Ce.ismultiply(e))return e.tail().map(ac).reduce(oc.add,Ce.Constants.zero);if(Ce.isadd(e)){e=jO.rect(e);let t=FO.real(e),r=Iy.imag(e);if(ys.isZeroAtomOrTensor(t))return ys.isnegative(r)?Nl.negate(Ce.Constants.Pi()):Ce.Constants.Pi();{let n=$O.arctan(Nl.divide(r,t));return ys.isnegative(t)?ys.isnegative(r)?oc.subtract(n,Ce.Constants.Pi()):oc.add(n,Ce.Constants.Pi()):n}}return ys.isZeroAtomOrTensor(DO.get_binding(Ce.symbol(Ce.ASSUME_REAL_VARIABLES)))?Sy.makeList(Ce.symbol(Ce.ARG),e):Ce.Constants.zero}});var lc=N(Jo=>{"use strict";Object.defineProperty(Jo,"__esModule",{value:!0});Jo.clockform=Jo.Eval_clock=void 0;var Wo=w(),VO=B(),wy=dn(),hm=Lo(),ZO=j(),XO=oe(),Am=ee(),HO=!1;function QO(e){let t=Ly(ZO.Eval(Wo.cadr(e)));VO.push(t)}Jo.Eval_clock=QO;function Ly(e){let t=XO.makeList(Wo.symbol(Wo.POWER),Wo.Constants.negOne,Am.divide(hm.arg(e),Wo.Constants.Pi())),r=Am.multiply(wy.abs(e),t);return HO&&(console.log(`clockform: abs of ${e} : ${wy.abs(e)}`),console.log(`clockform: arg of ${e} : ${hm.arg(e)}`),console.log(`clockform: divide : ${Am.divide(hm.arg(e),Wo.Constants.Pi())}`),console.log(`clockform: power : ${t}`),console.log(`clockform: multiply : ${r}`)),r}Jo.clockform=Ly});var uc=N(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:!0});Ko.polar=Ko.Eval_polar=void 0;var Om=w(),WO=B(),JO=Re(),KO=dn(),eT=Lo(),tT=j(),Cy=ee();function rT(e){let t=ky(tT.Eval(Om.cadr(e)));WO.push(t)}Ko.Eval_polar=rT;function ky(e){return Om.evalPolar(()=>Cy.multiply(KO.abs(e),JO.exponential(Cy.multiply(Om.Constants.imaginaryunit,eT.arg(e)))))}Ko.polar=ky});var Ti=N(ea=>{"use strict";Object.defineProperty(ea,"__esModule",{value:!0});ea.conjugate=ea.Eval_conj=void 0;var cc=w(),nT=br(),Py=B(),sT=lc(),Dy=j(),iT=ee(),oT=uc(),aT=en();function lT(e){e=Dy.Eval(cc.cadr(e)),nT.Find(e,cc.Constants.imaginaryunit)?Py.push(Tm(e)):Py.push(sT.clockform(Tm(oT.polar(e))))}ea.Eval_conj=lT;function Tm(e){return Dy.Eval(aT.subst(e,cc.Constants.imaginaryunit,iT.negate(cc.Constants.imaginaryunit)))}ea.conjugate=Tm});var kn=N(Js=>{"use strict";Object.defineProperty(Js,"__esModule",{value:!0});Js.yyfloat=Js.zzfloat=Js.Eval_float=void 0;var iG=xu(),rn=w(),oG=Oe(),uT=B(),$y=Z(),fc=j(),cT=oe(),fT=Et();function dT(e){rn.evalFloats(()=>{let t=fc.Eval(Mm(fc.Eval(rn.cadr(e))));uT.push(t)})}Js.Eval_float=dT;function mT(e){return rn.evalFloats(()=>fc.Eval(Mm(fc.Eval(e))))}Js.zzfloat=mT;function Mm(e){return rn.evalFloats(Nm,e)}Js.yyfloat=Mm;function Nm(e){return rn.iscons(e)?cT.makeList(...e.map(Nm)):rn.istensor(e)?(e=fT.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(Nm),e):rn.isrational(e)?$y.bignum_float(e):e===rn.symbol(rn.PI)?rn.Constants.piAsDouble:e===rn.symbol(rn.E)?$y.double(Math.E):e}});var mc=N(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.determinant=ta.det=void 0;var vs=w(),lG=B(),Uy=Re(),By=ge(),_T=Z(),bT=oe(),Mi=ee(),gT=Et();function yT(e){if(!gT.is_square_matrix(e))return bT.makeList(vs.symbol(vs.DET),e);let t=e.tensor.elem;return t.every(n=>vs.isNumericAtom(n))?vT(e):Gy(t,e.tensor.dim[0])}ta.det=yT;function Gy(e,t){let r=0,n=[];for(let l=0;l<t;l++)n[l]=l,n[l+t]=0,n[l+t+t]=1;let s=1,i=vs.Constants.zero;for(;;){let l=_T.integer(s);for(let L=0;L<t;L++){let R=t*n[L]+L;l=Mi.multiply(l,e[R])}i=By.add(i,l);let u=t-1,c=0,d=!1;for(;;){if(r=n[t+u]+n[t+t+u],r<0){n[t+t+u]=-n[t+t+u],u--;continue}if(r===u+1){if(u===0){d=!0;break}c++,n[t+t+u]=-n[t+t+u],u--;continue}break}if(d)break;let _=n[u-n[t+u]+c];n[u-n[t+u]+c]=n[u-r+c],n[u-r+c]=_,n[t+u]=r,s=s===1?-1:1}return i}ta.determinant=Gy;function vT(e){let t=e.tensor.dim[0],r=[...e.tensor.elem];return pT(r,t)}function Pn(e,t,r,n){return e[t*r+n]}function dc(e,t,r,n,s){e[t*r+n]=s}function pT(e,t){let r=vs.Constants.one;for(let n=0;n<t-1;n++){if(Uy.equal(Pn(e,t,n,n),vs.Constants.zero)){let s=0;for(s=n+1;s<t&&Uy.equal(Pn(e,t,s,n),vs.Constants.zero);s++);if(s===t){r=vs.Constants.zero;break}for(let i=n;i<t;i++){let l=Pn(e,t,n,i);dc(e,t,n,i,Pn(e,t,s,i)),dc(e,t,s,i,l)}r=Mi.negate(r)}r=Mi.multiply(r,Pn(e,t,n,n));for(let s=n+1;s<t;s++){let i=Mi.negate(Mi.divide(Pn(e,t,s,n),Pn(e,t,n,n)));dc(e,t,s,n,vs.Constants.zero);for(let l=n+1;l<t;l++){let u=By.add(Mi.multiply(Pn(e,t,n,l),i),Pn(e,t,s,l));dc(e,t,s,l,u)}}}return Mi.multiply(r,Pn(e,t,t-1,t-1))}});var wm=N(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});ra.cofactor=ra.Eval_cofactor=void 0;var Im=w(),Sm=Oe(),qT=B(),ET=mc(),Rm=j(),xT=ee(),hT=Et();function AT(e){let t=Rm.Eval(Im.cadr(e));hT.is_square_matrix(t)||Sm.stop("cofactor: 1st arg: square matrix expected");let r=t.tensor.dim[0],n=Rm.evaluate_integer(Im.caddr(e));(n<1||n>r)&&Sm.stop("cofactor: 2nd arg: row index expected");let s=Rm.evaluate_integer(Im.cadddr(e));(s<1||s>r)&&Sm.stop("cofactor: 3rd arg: column index expected"),qT.push(Fy(t,r,n-1,s-1))}ra.Eval_cofactor=AT;function Fy(e,t,r,n){let s=[];for(let l=0;l<t;l++)for(let u=0;u<t;u++)l!==r&&u!==n&&s.push(e.tensor.elem[t*l+u]);let i=ET.determinant(s,t-1);return(r+n)%2&&(i=xT.negate(i)),i}ra.cofactor=Fy});var Lm=N(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});na.adj=na.Eval_adj=void 0;var OT=Pt(),TT=w(),MT=Oe(),NT=B(),IT=wm(),ST=j(),RT=Et();function wT(e){let t=jy(ST.Eval(TT.cadr(e)));NT.push(t)}na.Eval_adj=wT;function jy(e){RT.is_square_matrix(e)||MT.stop("adj: square matrix expected");let t=e.tensor.dim[0],r=OT.alloc_tensor(t*t);r.tensor.ndim=2,r.tensor.dim[0]=t,r.tensor.dim[1]=t;for(let n=0;n<t;n++)for(let s=0;s<t;s++)r.tensor.elem[t*s+n]=IT.cofactor(e,t,n,s);return r}na.adj=jy});var Sl=N(sa=>{"use strict";Object.defineProperty(sa,"__esModule",{value:!0});sa.invg=sa.inv=void 0;var LT=Pt(),Or=w(),zy=Oe(),Yy=Re(),Vy=ge(),CT=Lm(),kT=mc(),PT=Ks(),DT=se(),Zy=oe(),Il=ee(),Xy=Et();function Hy(e){if(Or.isinv(e))return Or.car(Or.cdr(e));if(Or.isidentitymatrix(e))return e;if(Or.defs.expanding&&Or.isinnerordot(e)){let n=(Or.iscons(e)?e.tail():[]).map(Hy);for(let s=n.length-1;s>0;s--)n[s-1]=PT.inner(n[s],n[s-1]);return n[0]}if(!Xy.is_square_matrix(e))return Zy.makeList(Or.symbol(Or.INV),e);if(Or.isNumericAtomOrTensor(e))return Qy(e);let t=kT.det(e);return DT.isZeroAtomOrTensor(t)&&zy.stop("inverse of singular matrix"),Il.divide(CT.adj(e),t)}sa.inv=Hy;function $T(e){return Xy.is_square_matrix(e)?Qy(e):Zy.makeList(Or.symbol(Or.INVG),e)}sa.invg=$T;function Qy(e){let t=e.tensor.dim[0],r=new Array(t*t);r.fill(Or.Constants.zero);for(let i=0;i<t;i++)r[i*t+i]=Or.Constants.one;let n=UT(r,e.tensor.elem,t),s=LT.alloc_tensor(t*t);return s.tensor.ndim=2,s.tensor.dim[0]=t,s.tensor.dim[1]=t,s.tensor.elem=n,s}function UT(e,t,r){for(let n=0;n<r;n++){if(Yy.equal(t[r*n+n],Or.Constants.zero)){let i=0;for(i=n+1;i<r&&Yy.equal(t[r*i+n],Or.Constants.zero);i++);i===r&&zy.stop("inverse of singular matrix");for(let l=0;l<r;l++){let u=t[r*n+l];t[r*n+l]=t[r*i+l],t[r*i+l]=u,u=e[r*n+l],e[r*n+l]=e[r*i+l],e[r*i+l]=u}}let s=t[r*n+n];for(let i=0;i<r;i++)i>n&&(t[r*n+i]=Il.divide(t[r*n+i],s)),e[r*n+i]=Il.divide(e[r*n+i],s);for(let i=0;i<r;i++){if(i===n)continue;let l=t[r*i+n];for(let u=0;u<r;u++)u>n&&(t[r*i+u]=Vy.subtract(t[r*i+u],Il.multiply(t[r*n+u],l))),e[r*i+u]=Vy.subtract(e[r*i+u],Il.multiply(e[r*n+u],l))}}return e}});var Ks=N(ia=>{"use strict";Object.defineProperty(ia,"__esModule",{value:!0});ia.inner=ia.Eval_inner=void 0;var BT=Pt(),te=w(),Cm=Oe(),Wy=B(),Rl=ge(),_c=j(),Jy=Sl(),wl=se(),bc=oe(),gc=ee(),Ky=Et();function ev(e){let t=[];t.push(te.car(te.cdr(e))),te.car(te.cdr(te.cdr(e)))===te.symbol(te.NIL)&&Cm.stop("pattern needs at least a template and a transformed version");let n=te.cdr(te.cdr(e));for(;n!==te.symbol(te.NIL);)t.push(te.car(n)),n=te.cdr(n);if(t.length>2){let u=bc.makeList(te.symbol(te.INNER),t[t.length-2],t[t.length-1]);for(let c=2;c<t.length;c++)u=bc.makeList(te.symbol(te.INNER),t[t.length-c-1],u);ev(u);return}let s=[];yc(e,s);let i=[];for(let u=0;u<s.length;u++)s[u]!==te.symbol(te.SYMBOL_IDENTITY_MATRIX)&&i.push(s[u]);if(s=i,i=[],s.length>1){let u=0;for(let c=0;c<s.length&&c+u+1<=s.length-1;c++){if(te.isNumericAtomOrTensor(s[c+u])||te.isNumericAtomOrTensor(s[c+u+1]))i.push(s[c+u]);else{let d=_c.Eval(s[c+u+1]),_=Jy.inv(_c.Eval(s[c+u])),L=Rl.subtract(_,d);wl.isZeroAtomOrTensor(L)?u+=1:i.push(s[c+u])}if(c+u===s.length-2&&i.push(s[s.length-1]),c+u>=s.length-1)break}s=i}if(s.length===0){Wy.push(te.symbol(te.SYMBOL_IDENTITY_MATRIX));return}e=bc.makeList(te.symbol(te.INNER),...s),e=te.cdr(e);let l=_c.Eval(te.car(e));te.iscons(e)&&(l=e.tail().reduce((u,c)=>Ll(u,_c.Eval(c)),l)),Wy.push(l)}ia.Eval_inner=ev;function Ll(e,t){if(wl.isnegativeterm(t)&&wl.isnegativeterm(e)&&(t=gc.negate(t),e=gc.negate(e)),te.isinnerordot(e)&&(t=Ll(te.car(te.cdr(te.cdr(e))),t),e=te.car(te.cdr(e))),e===te.symbol(te.SYMBOL_IDENTITY_MATRIX))return t;if(t===te.symbol(te.SYMBOL_IDENTITY_MATRIX))return e;if(te.istensor(e)&&te.istensor(t))return GT(e,t);if(!(te.isNumericAtomOrTensor(e)||te.isNumericAtomOrTensor(t))){let r=Rl.subtract(e,Jy.inv(t));if(wl.isZeroAtomOrTensor(r))return te.symbol(te.SYMBOL_IDENTITY_MATRIX)}return te.defs.expanding&&te.isadd(e)?e.tail().reduce((r,n)=>Rl.add(r,Ll(n,t)),te.Constants.zero):te.defs.expanding&&te.isadd(t)?t.tail().reduce((r,n)=>Rl.add(r,Ll(e,n)),te.Constants.zero):te.istensor(e)&&te.isNumericAtom(t)?Ky.tensor_times_scalar(e,t):te.isNumericAtom(e)&&te.istensor(t)?Ky.scalar_times_tensor(e,t):te.isNumericAtom(e)||te.isNumericAtom(t)?gc.multiply(e,t):bc.makeList(te.symbol(te.INNER),e,t)}ia.inner=Ll;function GT(e,t){let r=e.tensor.dim[e.tensor.ndim-1];r!==t.tensor.dim[0]&&(te.breakpoint,Cm.stop("inner: tensor dimension check"));let n=e.tensor.ndim+t.tensor.ndim-2;n>te.MAXDIM&&Cm.stop("inner: rank of result exceeds maximum");let s=e.tensor.elem,i=t.tensor.elem,l=e.tensor.dim.slice(0,e.tensor.dim.length-1).reduce((_,L)=>_*L,1),u=t.tensor.dim.slice(1).reduce((_,L)=>_*L,1),c=BT.alloc_tensor(l*u),d=c.tensor.elem;for(let _=0;_<l;_++)for(let L=0;L<r;L++)if(!wl.isZeroAtomOrTensor(s[_*r+L]))for(let R=0;R<u;R++)d[_*u+R]=Rl.add(gc.multiply(s[_*r+L],i[L*u+R]),d[_*u+R]);return n===0?c.tensor.elem[0]:(c.tensor.ndim=n,c.tensor.dim=[...e.tensor.dim.slice(0,e.tensor.ndim-1),...t.tensor.dim.slice(1,t.tensor.ndim)],c)}function yc(e,t){if(!te.iscons(e)){tv(e,t);return}if(te.cdr(e)===te.symbol(te.NIL)){yc(te.car(e),t);return}if(te.isinnerordot(e)){yc(te.car(te.cdr(e)),t),yc(te.cdr(te.cdr(e)),t);return}tv(e,t)}function tv(e,t){e!==te.symbol(te.NIL)&&t.push(e)}});var Pm=N(aa=>{"use strict";Object.defineProperty(aa,"__esModule",{value:!0});aa.roots=aa.Eval_roots=void 0;var FT=Pt(),fe=w(),rv=Oe(),km=B(),jT=Re(),vc=dn(),Ne=ge(),X=Z(),zT=qi(),oa=j(),YT=fo(),VT=tn(),Tr=se(),S=ee(),Ke=Ot(),lr=ei(),ot={debug:e=>{fe.DEBUG&&console.log(e)}},ZT=e=>[].concat(...e);function XT(e){let t=fe.cadr(e),r;fe.car(t)===fe.symbol(fe.SETQ)||fe.car(t)===fe.symbol(fe.TESTEQ)?r=Ne.subtract(oa.Eval(fe.cadr(t)),oa.Eval(fe.caddr(t))):(t=oa.Eval(t),fe.car(t)===fe.symbol(fe.SETQ)||fe.car(t)===fe.symbol(fe.TESTEQ)?r=Ne.subtract(oa.Eval(fe.cadr(t)),oa.Eval(fe.caddr(t))):r=t),t=oa.Eval(fe.caddr(e));let n=t===fe.symbol(fe.NIL)?VT.guess(r):t;Tr.ispolyexpandedform(r,n)||rv.stop("roots: 1st argument is not a polynomial in the variable "+n),km.push_all(Cl(r,n))}aa.Eval_roots=XT;function HT(e){return e.some(t=>Tr.iscomplexnumber(t))}function QT(e){return e.length<=2||Tr.isZeroAtomOrTensor(e[0])?!1:e.slice(1,e.length-1).every(t=>Tr.isZeroAtomOrTensor(t))}function pc(e,t){let r=zT.coeff(e,t),n=r[r.length-1];return r.map(s=>S.divide(s,n))}function Cl(e,t){if(fe.defs.recursionLevelNestedRadicalsRemoval>1)return[fe.symbol(fe.NIL)];ot.debug(`checking if ${km.top()} is a case of simple roots`);let r=pc(e,t),n=[];if(QT(r)){ot.debug(`yes, ${r[r.length-1]} is a case of simple roots`);let i=r.length,l=r[0],u=r.pop(),c=WT(i,u,l);n.push(...c)}else{let i=JT(e,t);n.push(...i)}let s=n.length;if(s===0&&rv.stop("roots: the polynomial is not factorable, try nroots"),s===1)return n;jT.sort(n),e=FT.alloc_tensor(s),e.tensor.ndim=1,e.tensor.dim[0]=s;for(let i=0;i<s;i++)e.tensor.elem[i]=n[i];return[e]}aa.roots=Cl;function WT(e,t,r){ot.debug("getSimpleRoots"),e=e-1;let n=S.divide(Ke.power(r,X.rational(1,e)),Ke.power(t,X.rational(1,e))),s=[];if(e%2==0){for(let i=1;i<=e;i+=2){let l=S.multiply(n,Ke.power(fe.Constants.negOne,X.rational(i,e)));s.push(l),s.push(S.negate(l))}return s}for(let i=1;i<=e;i++){let l=S.multiply(n,Ke.power(fe.Constants.negOne,X.rational(i,e)));i%2==0&&(l=S.negate(l)),s.push(l)}return s}function JT(e,t){let r=pc(e,t);if(HT(r)||(e=YT.factorpoly(e,t)),fe.ismultiply(e)){let n=e.tail().map(s=>nv(s,t));return ZT(n)}return nv(e,t)}function nv(e,t){if(fe.ispower(e)&&Tr.ispolyexpandedform(fe.cadr(e),t)&&Tr.isposint(fe.caddr(e))){let r=pc(fe.cadr(e),t);return sv(r)}if(Tr.ispolyexpandedform(e,t)){let r=pc(e,t);return sv(r)}return[]}function sv(e){let t=e.length;if(t===2){let r=e.pop(),n=e.pop();return KT(r,n)}if(t===3){let r=e.pop(),n=e.pop(),s=e.pop();return eM(r,n,s)}if(t===4){let r=e.pop(),n=e.pop(),s=e.pop(),i=e.pop();return tM(r,n,s,i)}if(t===5){let r=e.pop(),n=e.pop(),s=e.pop(),i=e.pop(),l=e.pop();return nM(r,n,s,i,l)}return[]}function KT(e,t){return[S.negate(S.divide(t,e))]}function eM(e,t,r){let n=Ke.power(Ne.subtract(Ke.power(t,X.integer(2)),S.multiply(S.multiply(X.integer(4),e),r)),X.rational(1,2)),s=S.divide(Ne.subtract(n,t),S.multiply(e,X.integer(2))),i=S.multiply(S.divide(S.negate(Ne.add(n,t)),e),X.rational(1,2));return[s,i]}function tM(e,t,r,n){let s=S.multiply(S.multiply(r,r),r),i=S.multiply(t,t),l=S.multiply(i,t),u=S.multiply(S.multiply(l,n),X.integer(-4)),c=S.multiply(l,X.integer(2)),d=S.multiply(X.integer(3),e),_=S.multiply(S.multiply(e,e),n),L=S.multiply(_,X.integer(27)),R=S.multiply(S.multiply(_,n),X.integer(-27)),C=S.multiply(S.multiply(e,r),t),Y=S.multiply(S.multiply(e,r),X.integer(3)),H=S.multiply(X.integer(-4),S.multiply(e,s)),Se=S.negate(S.multiply(C,X.integer(9))),it=S.multiply(S.multiply(C,n),X.integer(18)),ct=Ne.subtract(i,Y),Ye=S.multiply(i,S.multiply(r,r)),xe=S.divide(S.negate(t),d),We=S.multiply(Ke.power(ct,X.integer(3)),X.integer(4)),_t=vc.absValFloat(lr.simplify(ct)),hr=vc.absValFloat(lr.simplify(Ne.add_all([it,u,Ye,H,R]))),_r=Ne.add_all([c,Se,L]),At=lr.simplify(Ke.power(Ne.subtract(Ke.power(_r,X.integer(2)),We),X.rational(1,2)));if(ot.debug(">>>>>>>>>>>>>>>> actually using cubic formula <<<<<<<<<<<<<<< "),ot.debug(`cubic: D0: ${ct}`),ot.debug(`cubic: D0 as float: ${_t}`),ot.debug(`cubic: DETERMINANT: ${hr}`),ot.debug(`cubic: D1: ${_r}`),Tr.isZeroAtomOrTensor(hr))return rM(e,t,r,n,{R_DELTA0_toBeCheckedIfZero:_t,R_m_b_over_3a:xe,R_DELTA0:ct,R_b3:l,R_a_b_c:C});let Fr=!1,fu=!1,Jn;for(;!Fr;){let Ka=fu?S.negate(At):At;Jn=lr.simplify(Ke.power(S.multiply(Ne.add(Ka,_r),X.rational(1,2)),X.rational(1,3)));let to=vc.absValFloat(lr.simplify(Jn));ot.debug(`cubic: C: ${Jn}`),ot.debug(`cubic: C as absval and float: ${to}`),Tr.isZeroAtomOrTensor(to)?(ot.debug(" cubic: C IS ZERO flipping the sign"),fu=!0):Fr=!0}let Xa=S.multiply(S.multiply(Jn,d),X.integer(2)),du=S.multiply(fe.Constants.imaginaryunit,Ke.power(X.integer(3),X.rational(1,2))),mu=Ne.add(fe.Constants.one,du),Ha=Ne.subtract(fe.Constants.one,du),ln=S.divide(Jn,d),Kn=xe,_u=S.negate(ln),Qa=S.negate(S.divide(ct,S.multiply(Jn,d))),un=lr.simplify(Ne.add_all([Kn,_u,Qa])),_i=xe,es=S.divide(S.multiply(ln,mu),X.integer(2)),bu=S.divide(S.multiply(Ha,ct),Xa),Wa=lr.simplify(Ne.add_all([_i,es,bu])),Ja=xe,Ed=S.divide(S.multiply(ln,Ha),X.integer(2)),eo=S.divide(S.multiply(mu,ct),Xa),gu=lr.simplify(Ne.add_all([Ja,Ed,eo]));return[un,Wa,gu]}function rM(e,t,r,n,s){let{R_DELTA0_toBeCheckedIfZero:i,R_m_b_over_3a:l,R_DELTA0:u,R_b3:c,R_a_b_c:d}=s;if(Tr.isZeroAtomOrTensor(i))return ot.debug(" cubic: DETERMINANT IS ZERO and delta0 is zero"),[l];ot.debug(" cubic: DETERMINANT IS ZERO and delta0 is not zero");let _=S.divide(Ne.subtract(S.multiply(e,S.multiply(n,X.integer(9))),S.multiply(t,r)),S.multiply(u,X.integer(2))),L=S.negate(c),R=S.negate(S.multiply(e,S.multiply(e,S.multiply(n,X.integer(9))))),C=S.multiply(d,X.integer(4)),Y=S.divide(Ne.add_all([C,R,L]),S.multiply(e,u));return[_,_,Y]}function nM(e,t,r,n,s){return ot.debug(">>>>>>>>>>>>>>>> actually using quartic formula <<<<<<<<<<<<<<< "),Tr.isZeroAtomOrTensor(t)&&Tr.isZeroAtomOrTensor(n)&&!Tr.isZeroAtomOrTensor(r)&&!Tr.isZeroAtomOrTensor(s)?sM(e,t,r,n,s):Tr.isZeroAtomOrTensor(t)?iM(e,t,r,n,s):oM(e,t,r,n,s)}function sM(e,t,r,n,s){ot.debug("biquadratic case");let i=Cl(Ne.add(S.multiply(e,Ke.power(fe.symbol(fe.SECRETX),X.integer(2))),Ne.add(S.multiply(r,fe.symbol(fe.SECRETX)),s)),fe.symbol(fe.SECRETX))[0],l=[];for(let u of i.tensor.elem)l.push(lr.simplify(Ke.power(u,X.rational(1,2)))),l.push(lr.simplify(S.negate(Ke.power(u,X.rational(1,2)))));return l}function iM(e,t,r,n,s){let i=r,l=n,u=s,c=S.multiply(X.rational(5,2),i),d=Ne.subtract(S.multiply(X.integer(2),Ke.power(i,X.integer(2))),u),_=Ne.add(S.multiply(X.rational(-1,2),S.multiply(i,u)),Ne.add(S.divide(Ke.power(i,X.integer(3)),X.integer(2)),S.multiply(X.rational(-1,8),Ke.power(l,X.integer(2))))),L=Ne.add(Ke.power(fe.symbol(fe.SECRETX),X.integer(3)),Ne.add(S.multiply(c,Ke.power(fe.symbol(fe.SECRETX),X.integer(2))),Ne.add(S.multiply(d,fe.symbol(fe.SECRETX)),_)));ot.debug(`resolventCubic: ${km.top()}`);let R=Cl(L,fe.symbol(fe.SECRETX))[0];ot.debug(`resolventCubicSolutions: ${R}`);let C=null;for(let At of R.tensor.elem){ot.debug(`examining solution: ${At}`);let Fr=vc.absValFloat(Ne.add(S.multiply(At,X.integer(2)),i));if(ot.debug(`abs value is: ${At}`),!Tr.isZeroAtomOrTensor(Fr)){C=At;break}}ot.debug(`chosen solution: ${C}`);let Y=lr.simplify(Ke.power(Ne.add(S.multiply(C,X.integer(2)),i),X.rational(1,2))),H=lr.simplify(S.divide(S.multiply(l,X.integer(2)),Y)),Se=Ne.add(S.multiply(i,X.integer(3)),S.multiply(C,X.integer(2))),it=lr.simplify(Ke.power(S.negate(Ne.add(Se,H)),X.rational(1,2))),ct=S.divide(Ne.add(Y,it),X.integer(2)),Ye=lr.simplify(Ke.power(S.negate(Ne.add(Se,H)),X.rational(1,2))),xe=S.divide(Ne.subtract(Y,Ye),X.integer(2)),We=lr.simplify(Ke.power(S.negate(Ne.subtract(Se,H)),X.rational(1,2))),_t=S.divide(Ne.add(S.negate(Y),We),X.integer(2)),hr=lr.simplify(Ke.power(S.negate(Ne.subtract(Se,H)),X.rational(1,2))),_r=S.divide(Ne.subtract(S.negate(Y),hr),X.integer(2));return[ct,xe,_t,_r]}function oM(e,t,r,n,s){let i=S.divide(Ne.add(S.multiply(X.integer(8),S.multiply(r,e)),S.multiply(X.integer(-3),Ke.power(t,X.integer(2)))),S.multiply(X.integer(8),Ke.power(e,X.integer(2)))),l=S.divide(Ne.add(Ke.power(t,X.integer(3)),Ne.add(S.multiply(X.integer(-4),S.multiply(e,S.multiply(t,r))),S.multiply(X.integer(8),S.multiply(n,Ke.power(e,X.integer(2)))))),S.multiply(X.integer(8),Ke.power(e,X.integer(3)))),u=S.multiply(S.multiply(e,e),e),c=S.multiply(t,t),d=S.multiply(S.multiply(e,e),n),_=S.divide(Ne.add(S.multiply(Ke.power(t,X.integer(4)),X.integer(-3)),Ne.add(S.multiply(X.integer(256),S.multiply(u,s)),Ne.add(S.multiply(X.integer(-64),S.multiply(d,t)),S.multiply(X.integer(16),S.multiply(c,S.multiply(e,r)))))),S.multiply(X.integer(256),Ke.power(e,X.integer(4)))),L=Ke.power(fe.symbol(fe.SECRETX),X.integer(4)),R=S.multiply(i,Ke.power(fe.symbol(fe.SECRETX),X.integer(2))),C=S.multiply(l,fe.symbol(fe.SECRETX)),Y=lr.simplify(Ne.add_all([L,R,C,_])),H=Cl(Y,fe.symbol(fe.SECRETX))[0];return ot.debug(`p for depressed quartic: ${i}`),ot.debug(`q for depressed quartic: ${l}`),ot.debug(`r for depressed quartic: ${_}`),ot.debug(`tos 4 ${fe.defs.tos}`),ot.debug(`4 * x^4: ${L}`),ot.debug(`R_p * x^2: ${R}`),ot.debug(`R_q * x: ${C}`),ot.debug(`R_r: ${_}`),ot.debug(`solving depressed quartic: ${Y}`),ot.debug(`depressedSolutions: ${H}`),H.tensor.elem.map(Se=>{let it=lr.simplify(Ne.subtract(Se,S.divide(t,S.multiply(X.integer(4),e))));return ot.debug(`solution from depressed: ${it}`),it})}});var av=N(Ec=>{"use strict";Object.defineProperty(Ec,"__esModule",{value:!0});Ec.simfac=void 0;var ye=w(),bG=B(),iv=Re(),ti=ge(),gG=j(),qc=yi(),yn=se(),la=ee();function aM(e){if(ye.isadd(e)){let t=e.tail().map(ov);return ti.add_all(t)}return ov(e)}Ec.simfac=aM;function ov(e){if(!ye.ismultiply(e))return e;let t=e.tail();for(;lM(t););return la.multiply_all_noexpand(t)}function lM(e){for(let t=0;t<e.length;t++){let r=e[t];for(let n=0;n<e.length;n++){if(t===n)continue;let s=e[n];if(ye.isfactorial(r)&&ye.ispower(s)&&yn.isminusone(ye.caddr(s))&&iv.equal(ye.cadr(r),ye.cadr(s)))return e[t]=qc.factorial(ti.subtract(ye.cadr(r),ye.Constants.one)),e[n]=ye.Constants.one,!0;if(ye.ispower(s)&&yn.isminusone(ye.caddr(s))&&ye.caadr(s)===ye.symbol(ye.FACTORIAL)&&iv.equal(r,ye.cadadr(s)))return e[t]=la.reciprocate(qc.factorial(ti.add(r,ye.Constants.negOne))),e[n]=ye.Constants.one,!0;if(ye.isfactorial(s)){let i=ti.subtract(r,ye.cadr(s));if(yn.isplusone(i))return e[t]=qc.factorial(r),e[n]=ye.Constants.one,!0}if(ye.ispower(r)&&yn.isminusone(ye.caddr(r))&&ye.ispower(s)&&yn.isminusone(ye.caddr(s))&&ye.caadr(s)===ye.symbol(ye.FACTORIAL)){let i=ti.subtract(ye.cadr(r),ye.cadr(ye.cadr(s)));if(yn.isplusone(i))return e[t]=la.reciprocate(qc.factorial(ye.cadr(r))),e[n]=ye.Constants.one,!0}if(ye.isfactorial(r)&&ye.ispower(s)&&yn.isminusone(ye.caddr(s))&&ye.caadr(s)===ye.symbol(ye.FACTORIAL)){let i=ti.subtract(ye.cadr(r),ye.cadr(ye.cadr(s)));if(yn.isplusone(i))return e[t]=ye.cadr(r),e[n]=ye.Constants.one,!0;if(yn.isminusone(i))return e[t]=la.reciprocate(ye.cadr(ye.cadr(s))),e[n]=ye.Constants.one,!0;if(yn.equaln(i,2))return e[t]=ye.cadr(r),e[n]=ti.add(ye.cadr(r),ye.Constants.negOne),!0;if(yn.equaln(i,-2))return e[t]=la.reciprocate(ye.cadr(ye.cadr(s))),e[n]=la.reciprocate(ti.add(ye.cadr(ye.cadr(s)),ye.Constants.negOne)),!0}}}return!1}});var Dm=N(ua=>{"use strict";Object.defineProperty(ua,"__esModule",{value:!0});ua.decomp=ua.Eval_decomp=void 0;var Fe=w(),kl=br(),uM=B(),lv=Re(),cM=ge(),uv=j(),fM=tn(),dM=oe(),cv=ee();function mM(e){console.log("Eval_decomp is being called!!!!!!!!!!!!!!!!!!!!");let t=uv.Eval(Fe.cadr(e));e=uv.Eval(Fe.caddr(e));let r=e===Fe.symbol(Fe.NIL)?fM.guess(t):e,n=Pl(!1,t,r);uM.push(dM.makeList(Fe.symbol(Fe.NIL),...n))}ua.Eval_decomp=mM;function _M(e,t){return e.length>0&&lv.equal(t,e[e.length-1])?!1:(e.push(t),!0)}function Pl(e,t,r){if(Fe.DEBUG&&console.log(`DECOMPOSING ${t}`),e){if(!Fe.iscons(t))return Fe.DEBUG&&console.log(` ground thing: ${t}`),[t]}else if(!kl.Find(t,r))return Fe.DEBUG&&console.log(" entire expression is constant"),[t];if(Fe.isadd(t))return bM(e,t,r);if(Fe.ismultiply(t))return gM(e,t,r);let n=Fe.cdr(t);Fe.DEBUG&&(console.log(" naive decomp"),console.log(`startig p3: ${n}`));let s=[];for(;Fe.iscons(n);)e&&s.push(Fe.car(n)),Fe.DEBUG&&(console.log("recursive decomposition"),console.log(`car(p3): ${Fe.car(n)}`),console.log(`p2: ${r}`)),s.push(...Pl(e,Fe.car(n),r)),n=Fe.cdr(n);return s}ua.decomp=Pl;function bM(e,t,r){Fe.DEBUG&&console.log(" decomposing the sum ");let n=Fe.cdr(t),s=[];for(;Fe.iscons(n);)(kl.Find(Fe.car(n),r)||e)&&s.push(...Pl(e,Fe.car(n),r)),n=Fe.cdr(n);n=Fe.cdr(t);let i=[...n].filter(l=>!kl.Find(l,r));return i.length&&(n=cM.add_all(i),_M(s,n),s.push(cv.negate(n))),s}function gM(e,t,r){Fe.DEBUG&&console.log(" decomposing the product ");let n=Fe.cdr(t),s=[];for(;Fe.iscons(n);)(kl.Find(Fe.car(n),r)||e)&&s.push(...Pl(e,Fe.car(n),r)),n=Fe.cdr(n);n=Fe.cdr(t);let i=[];for(;Fe.iscons(n);){let l=Fe.car(n);kl.Find(l,r)||(i.length<1||!lv.equal(l,i[i.length-1]))&&i.push(l),n=Fe.cdr(n)}return i.length>0&&s.push(cv.multiply_all(i)),s}});var Um=N(hc=>{"use strict";Object.defineProperty(hc,"__esModule",{value:!0});hc.transform=void 0;var V=w(),yM=B(),vr=dt(),vM=ge(),pM=Bm(),qM=Dm(),xc=j(),fv=se(),EM=oe(),xM=Vs(),$m=en();function dv(e,t,r,n){V.DEBUG&&console.log(`         !!!!!!!!!   transform on: ${e}`);let s=hM();vr.set_binding(V.symbol(V.METAX),t);let i=pM.polyform(e,t),l=qM.decomp(n,i,t);if(V.DEBUG){console.log(`  ${l.length} decomposed elements ====== `);for(let _=0;_<l.length;_++)console.log(`  decomposition element ${_}: ${l[_]}`)}let u=!1,c;if(n){if(!V.isNumericAtom(e)){let _=r;V.DEBUG&&(console.log(`applying transform: ${_}`),console.log(`scanning table entry ${_}`));let L=$m.subst(_,V.symbol(V.SYMBOL_A_UNDERSCORE),V.symbol(V.METAA));L=$m.subst(L,V.symbol(V.SYMBOL_B_UNDERSCORE),V.symbol(V.METAB));let R=$m.subst(L,V.symbol(V.SYMBOL_X_UNDERSCORE),V.symbol(V.METAX)),C=V.car(R);V.DEBUG&&console.log(`template expression: ${C}`),c=V.cadr(R);let Y=V.cddr(R);if(mv([V.Constants.one,...l],n,e,C,Y))u=!0;else{V.DEBUG&&(console.log(`p3 at this point: ${e}`),console.log(`car(p3): ${V.car(e)}`));let H=[],Se=e;for(V.iscons(Se)&&(H.push(V.car(e)),Se=V.cdr(e));V.iscons(Se);){let it=V.car(Se);Se=V.cdr(Se),V.DEBUG&&(console.log("tos before recursive transform: "+V.defs.tos),console.log(`testing: ${it}`),console.log(`about to try to simplify other term: ${it}`));let[ct,Ye]=dv(it,V.symbol(V.NIL),r,n);u=u||Ye,H.push(ct),V.DEBUG&&console.log(`tried to simplify other term: ${it} ...successful?: ${Ye} ...transformed: ${H[H.length-1]}`)}H.length!==0&&(c=EM.makeList(...H))}}}else for(let _ of Array.from(r))if(V.DEBUG&&(console.log(`scanning table entry ${_}`),(_+"").indexOf("f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))")!==-1&&V.breakpoint),_){xM.scan_meta(_);let L=yM.pop(),R=V.cadr(L);c=V.caddr(L);let C=V.cdddr(L);if(mv([V.Constants.one,...l],n,e,R,C)){u=!0;break}}let d=u?xc.Eval(c):n?e:V.symbol(V.NIL);return AM(s),[d,u]}hc.transform=dv;function hM(){return{METAA:vr.get_binding(V.symbol(V.METAA)),METAB:vr.get_binding(V.symbol(V.METAB)),METAX:vr.get_binding(V.symbol(V.METAX))}}function AM(e){vr.set_binding(V.symbol(V.METAX),e.METAX),vr.set_binding(V.symbol(V.METAB),e.METAB),vr.set_binding(V.symbol(V.METAA),e.METAA)}function mv(e,t,r,n,s){for(let i of e){vr.set_binding(V.symbol(V.METAA),i),V.DEBUG&&console.log(`  binding METAA to ${vr.get_binding(V.symbol(V.METAA))}`);for(let l of e){vr.set_binding(V.symbol(V.METAB),l),V.DEBUG&&console.log(`  binding METAB to ${vr.get_binding(V.symbol(V.METAB))}`);let u=s;for(;V.iscons(u);){let d=xc.Eval(V.car(u));if(fv.isZeroAtomOrTensor(d))break;u=V.cdr(u)}if(V.iscons(u))continue;let c=t?V.noexpand(xc.Eval,n):xc.Eval(n);if(V.DEBUG&&(console.log(`about to evaluate template expression: ${n} binding METAA to ${vr.get_binding(V.symbol(V.METAA))} and binding METAB to ${vr.get_binding(V.symbol(V.METAB))} and binding METAX to ${vr.get_binding(V.symbol(V.METAX))}`),console.log(`  comparing ${c} to: ${r}`)),fv.isZeroAtomOrTensor(vM.subtract(r,c)))return V.DEBUG&&(console.log(`binding METAA to ${vr.get_binding(V.symbol(V.METAA))}`),console.log(`binding METAB to ${vr.get_binding(V.symbol(V.METAB))}`),console.log(`binding METAX to ${vr.get_binding(V.symbol(V.METAX))}`),console.log(`comparing ${r} to: ${n}`)),!0}}return!1}});var jm=N(fa=>{"use strict";Object.defineProperty(fa,"__esModule",{value:!0});fa.transpose=fa.Eval_transpose=void 0;var OM=Pt(),Le=w(),TM=Oe(),MM=B(),ca=Re(),NM=ge(),Gm=Z(),Fm=j(),IM=Ks(),Zr=se(),_v=oe(),SM=ee();function RM(e){let t=Fm.Eval(Le.cadr(e)),r=Le.Constants.one,n=Gm.integer(2);Le.cddr(e)!==Le.symbol(Le.NIL)&&(r=Fm.Eval(Le.caddr(e)),n=Fm.Eval(Le.cadddr(e))),MM.push(Dl(t,r,n))}fa.Eval_transpose=RM;function Dl(e,t,r){let n=0,s=Array(Le.MAXDIM).fill(0),i=Array(Le.MAXDIM).fill(0);if(Le.isNumericAtom(e)||(Zr.isplusone(t)&&Zr.isplustwo(r)||Zr.isplusone(r)&&Zr.isplustwo(t))&&Le.isidentitymatrix(e))return e;if(Le.istranspose(e)){let R=Le.car(Le.cdr(Le.cdr(e))),C=Le.car(Le.cdr(Le.cdr(Le.cdr(e))));if(ca.equal(R,r)&&ca.equal(C,t)||ca.equal(C,r)&&ca.equal(R,t)||ca.equal(R,Le.symbol(Le.NIL))&&ca.equal(C,Le.symbol(Le.NIL))&&(Zr.isplusone(r)&&Zr.isplustwo(t)||Zr.isplusone(t)&&Zr.isplustwo(r)))return Le.car(Le.cdr(e))}if(Le.defs.expanding&&Le.isadd(e))return e.tail().reduce((R,C)=>NM.add(R,Dl(C,t,r)),Le.Constants.zero);if(Le.defs.expanding&&Le.ismultiply(e))return e.tail().reduce((R,C)=>SM.multiply(R,Dl(C,t,r)),Le.Constants.one);if(Le.defs.expanding&&Le.isinnerordot(e)){let R=[];return Le.iscons(e)&&R.push(...e.tail().map(C=>[C,t,r])),R.reverse(),R.reduce((C,Y)=>IM.inner(C,Dl(Y[0],Y[1],Y[2])),Le.symbol(Le.SYMBOL_IDENTITY_MATRIX))}if(!Le.istensor(e))return Zr.isZeroAtomOrTensor(e)?Le.Constants.zero:(!Zr.isplusone(t)||!Zr.isplustwo(r))&&(!Zr.isplusone(r)||!Zr.isplustwo(t))?_v.makeList(Le.symbol(Le.TRANSPOSE),e,t,r):_v.makeList(Le.symbol(Le.TRANSPOSE),e);let{ndim:l,nelem:u}=e.tensor;if(l===1)return e;let c=Gm.nativeInt(t),d=Gm.nativeInt(r);(c<1||c>l||d<1||d>l)&&TM.stop("transpose: index out of range"),c--,d--,t=OM.alloc_tensor(u),t.tensor.ndim=l,t.tensor.dim=[...e.tensor.dim],t.tensor.dim[c]=e.tensor.dim[d],t.tensor.dim[d]=e.tensor.dim[c];let _=e.tensor.elem,L=t.tensor.elem;for(let R=0;R<l;R++)s[R]=0,i[R]=e.tensor.dim[R];for(let R=0;R<u;R++){n=s[c],s[c]=s[d],s[d]=n,n=i[c],i[c]=i[d],i[d]=n;let C=0;for(let Y=0;Y<l;Y++)C=C*i[Y]+s[Y];n=s[c],s[c]=s[d],s[d]=n,n=i[c],i[c]=i[d],i[d]=n,L[C]=_[R];for(let Y=l-1;Y>=0&&!(++s[Y]<i[Y]);Y--)s[Y]=0}return t}fa.transpose=Dl});var ei=N(Dn=>{"use strict";Object.defineProperty(Dn,"__esModule",{value:!0});Dn.simplify_trig=Dn.simplify=Dn.simplifyForCodeGeneration=Dn.Eval_simplify=void 0;var wM=Pt(),yt=xu(),A=w(),Ni=br(),bv=Oe(),gv=B(),zm=dt(),da=Re(),ps=ge(),Yt=Z(),LM=lc(),Ym=sl(),Ii=j(),Si=kn(),CM=Ks(),Xt=se(),Vm=oe(),Ze=ee(),kM=uc(),vn=Ot(),ri=ol(),Ri=Ho(),PM=ms(),DM=Pm(),yv=av(),$M=Et(),UM=Um(),BM=jm(),GM=Sn(),vv=pi(),Zm=il(),FM=ls();function jM(e){let t=pv(A.cadr(e)),r=nn(Ii.Eval(t));gv.push(r)}Dn.Eval_simplify=jM;function pv(e){if(A.defs.userSimplificationsInListForm.length===0||Ni.Find(e,A.symbol(A.INTEGRAL)))return e;A.DEBUG&&console.log(`runUserDefinedSimplifications passed: ${e}`);let t=A.noexpand(Ii.Eval,e);if(A.DEBUG){console.log(`runUserDefinedSimplifications after eval no expanding: ${t}`),console.log("patterns to be checked: ");for(let s of Array.from(A.defs.userSimplificationsInListForm))console.log(`...${s}`)}let r=!0,n=0;for(;r&&n<A.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES;){r=!1,n++;for(let s of Array.from(A.defs.userSimplificationsInListForm)){let i=!0,l=0;for(;i&&l<A.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE;)l++,A.DEBUG&&console.log(`simplify - tos: ${A.defs.tos} checking pattern: ${s} on: ${t}`),[t,i]=UM.transform(t,A.symbol(A.NIL),s,!0),i&&(r=!0),A.DEBUG&&console.log(`p1 at this stage of simplification: ${t}`);l===A.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE&&bv.stop(`maximum application of single transformation rule exceeded: ${s}`)}}return n===A.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES&&bv.stop("maximum application of all transformation rules exceeded "),A.DEBUG&&(console.log(`METAX = ${zm.get_binding(A.symbol(A.METAX))}`),console.log(`METAA = ${zm.get_binding(A.symbol(A.METAA))}`),console.log(`METAB = ${zm.get_binding(A.symbol(A.METAB))}`)),t}function zM(e){let t=pv(e);A.defs.codeGen=!0;let r=nn(t);return A.defs.codeGen=!1,r}Dn.simplifyForCodeGeneration=zM;function nn(e){if(A.defs.codeGen&&A.car(e)===A.symbol(A.FUNCTION)){let t=A.cadr(e),r=nn(Ii.Eval(t)),n=A.caddr(e);e=Vm.makeList(A.symbol(A.FUNCTION),r,n)}if(A.istensor(e))return YM(e);if(Ni.Find(e,A.symbol(A.FACTORIAL))){let t=yv.simfac(e),r=yv.simfac(ri.rationalize(e));e=yt.count(t)<yt.count(r)?t:r}if(e=HM(e),e=VM(e),e=ZM(e),e=XM(e),e=QM(e),e=qv(e),e=JM(e),[e]=eN(e),A.do_simplify_nested_radicals){let t;if([t,e]=tN(e),t)return A.DEBUG&&console.log("de-nesting successful into: "+e.toString()),nn(e)}return[e]=KM(e),e=Ev(e),e}Dn.simplify=nn;function YM(e){let t=wM.alloc_tensor(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=Array.from(e.tensor.dim),t.tensor.elem=e.tensor.elem.map(nn),$M.check_tensor_dimensions(t),Xt.isZeroAtomOrTensor(t)&&(t=A.Constants.zero),t}function VM(e){if(!A.isadd(e))return e;let t=ri.rationalize(e);return yt.count(t)<yt.count(e)&&(e=t),e}function ZM(e){if(!A.isadd(e))return e;let t=Ym.Condense(e);return yt.count(t)<=yt.count(e)&&(e=t),e}function XM(e){let t=ri.rationalize(Ze.negate(ri.rationalize(Ze.negate(ri.rationalize(e)))));return yt.count(t)<yt.count(e)&&(e=t),e}function HM(e){let t=A.car(e);if((t===A.symbol(A.MULTIPLY)||A.isinnerordot(e))&&A.car(A.car(A.cdr(e)))===A.symbol(A.TRANSPOSE)&&A.car(A.car(A.cdr(A.cdr(e))))===A.symbol(A.TRANSPOSE)){A.DEBUG&&console.log(`maybe collecting a transpose ${e}`);let r=A.cadr(A.car(A.cdr(e))),n=A.cadr(A.car(A.cdr(A.cdr(e)))),s;t===A.symbol(A.MULTIPLY)?s=Ze.multiply(r,n):A.isinnerordot(e)?s=CM.inner(n,r):s=gv.pop();let i=A.noexpand(()=>BM.transpose(s,A.Constants.one,Yt.integer(2)));yt.count(i)<yt.count(e)&&(e=i),A.DEBUG&&console.log(`collecting a transpose ${i}`)}return e}function QM(e){if(Xt.isZeroAtomOrTensor(e))return e;let t=ri.rationalize(Ze.inverse(ri.rationalize(Ze.inverse(ri.rationalize(e)))));return yt.count(t)<yt.count(e)&&(e=t),e}function WM(e){return qv(e)}Dn.simplify_trig=WM;function qv(e){if(!Ni.Find(e,A.symbol(A.SIN))&&!Ni.Find(e,A.symbol(A.COS)))return e;let t=e;A.defs.trigmode=1;let r=Ii.Eval(t);A.defs.trigmode=2;let n=Ii.Eval(t);return A.defs.trigmode=0,(yt.count(n)<yt.count(r)||Ac(n)<Ac(r))&&(r=n),(yt.count(r)<yt.count(e)||Ac(r)<Ac(e))&&(e=r),e}function JM(e){if(!A.isadd(e))return e;let t=A.cdr(e);return A.iscons(t)&&(t=[...t].reduce((r,n)=>Ev(ps.add(r,nn(n))),A.Constants.zero)),yt.count(t)<yt.count(e)&&(e=t),e}function Ev(e){var t,r,n,s,i;if(t=GM.denominator(e),Xt.isone(t)||(r=FM.numerator(e),Xt.isone(r))||!(s=vv.areunivarpolysfactoredorexpandedform(r,t))||(i=Zm.factor(vv.gcd(r,t),s),Xt.isone(i)))return e;let l=Zm.factor(r,s),u=Ze.inverse(i),c=Ze.multiply_noexpand(l,u),d=nn(c),_=Zm.factor(t,s),L=Ze.multiply_noexpand(_,u),R=nn(L),C=Ze.divide(d,R);return n=Ym.Condense(C),yt.count(n)<yt.count(e)?n:e}function KM(e){let t;return!Ni.Find(e,A.symbol(A.SIN))&&!Ni.Find(e,A.symbol(A.COS))?[e]:(t=LM.clockform(Ii.Eval(e)),A.DEBUG&&console.log(`before simplification clockform: ${e} after: ${t}`),yt.count(t)<yt.count(e)&&(e=t),[e])}function eN(e){let t=Xm(e),r=Ii.Eval(t);return yt.count(r)<yt.count(e)&&(e=r),[e]}function Xm(e){if(Xt.isimaginaryunit(e))return e;if(da.equal(A.car(e),A.symbol(A.POWER))&&Xt.isminusone(A.cadr(e))){let t=Ze.negate(A.Constants.one),r=Xm(A.caddr(e));return PM.rect(kM.polar(vn.power(t,r)))}if(A.iscons(e)){let t=[];for(;A.iscons(e);)t.push(Xm(A.car(e))),e=A.cdr(e);return Vm.makeList(...t)}return e}function Ac(e){return A.isadd(e)?da.length(e)-1:1}function tN(e){if(A.defs.recursionLevelNestedRadicalsRemoval>0)return A.DEBUG&&console.log("denesting bailing out because of too much recursion"),[!1,e];let[t,r]=Oc(e),n=A.noexpand(Ym.yycondense,t);return e=yt.countOccurrencesOfSymbol(A.symbol(A.POWER),t)<yt.countOccurrencesOfSymbol(A.symbol(A.POWER),n)?t:n,[r,e]}function Oc(e){return A.defs.recursionLevelNestedRadicalsRemoval>0?(A.DEBUG&&console.log("denesting bailing out because of too much recursion"),[e,!1]):da.equal(A.car(e),A.symbol(A.POWER))?rN(e):A.iscons(e)?sN(e):[e,!1]}function rN(e){let t=A.cadr(e),r=A.caddr(e);if(Xt.isminusone(r)||!da.equal(A.car(t),A.symbol(A.ADD))||!Xt.isfraction(r)||!Xt.equalq(r,1,3)&&!Xt.equalq(r,1,2))return[e,!1];let n=A.cadr(t);Oc(n);let s=A.caddr(t);Oc(s);let i=0,l=t;for(;A.cdr(l)!==A.symbol(A.NIL);)i++,l=A.cdr(l);if(i>2)return[e,!1];let{commonBases:u,termsThatAreNotPowers:c}=nN(s);if(u.length===0)return[e,!1];let d=n,_=u.reduce(Ze.multiply,A.Constants.one),L=c.reduce(Ze.multiply,A.Constants.one),R;if(Xt.equalq(r,1,3)){let Ye=Ze.divide(Ze.multiply(Ze.negate(d),_),L),xe=Yt.nativeDouble(Si.yyfloat(Ri.real(Ye)));if(Math.abs(xe)>Math.pow(2,32))return[e,!1];let We=Ze.multiply(Yt.integer(3),_),_t=Yt.nativeDouble(Si.yyfloat(Ri.real(We)));if(Math.abs(_t)>Math.pow(2,32))return[e,!1];let hr=Ze.multiply(We,A.symbol(A.SECRETX)),_r=Ze.divide(Ze.multiply(Yt.integer(-3),d),L),At=Yt.nativeDouble(Si.yyfloat(Ri.real(_r)));if(Math.abs(At)>Math.pow(2,32))return[e,!1];R=ps.add_all([Ye,hr,Ze.multiply(_r,vn.power(A.symbol(A.SECRETX),Yt.integer(2))),Ze.multiply(A.Constants.one,vn.power(A.symbol(A.SECRETX),Yt.integer(3)))])}else if(Xt.equalq(r,1,2)){let Ye=Yt.nativeDouble(Si.yyfloat(Ri.real(_)));if(Math.abs(Ye)>Math.pow(2,32))return[e,!1];let xe=Ze.divide(Ze.multiply(Yt.integer(-2),d),L),We=Yt.nativeDouble(Si.yyfloat(Ri.real(xe)));if(Math.abs(We)>Math.pow(2,32))return[e,!1];R=ps.add(_,ps.add(Ze.multiply(xe,A.symbol(A.SECRETX)),Ze.multiply(A.Constants.one,vn.power(A.symbol(A.SECRETX),Yt.integer(2)))))}A.defs.recursionLevelNestedRadicalsRemoval++;let C=DM.roots(R,A.symbol(A.SECRETX));if(A.defs.recursionLevelNestedRadicalsRemoval--,da.equal(C[C.length-1],A.symbol(A.NIL)))return A.DEBUG&&console.log("roots bailed out because of too much recursion"),[e,!1];let Y=C[C.length-1].elem.filter(Ye=>!Ni.Find(Ye,A.symbol(A.POWER)));if(Y.length===0)return[e,!1];let H=[],Se=[];for(let Ye of Array.from(Y)){let xe=Yt.nativeDouble(Si.yyfloat(Ri.real(Ye)));H.push(Ye),Se.push(xe)}let it=Se.indexOf(Math.max.apply(Math,Se)),ct=H[it];if(!Xt.equalq(r,1,3)&&!Xt.equalq(r,1,2))return[e,!1];if(Xt.equalq(r,1,3)){let Ye=vn.power(Ze.divide(d,ps.add(vn.power(ct,Yt.integer(3)),Ze.multiply(Ze.multiply(Yt.integer(3),_),ct))),Yt.rational(1,3)),xe=Ze.multiply(Ye,ct);return[nn(ps.add(Ze.multiply(Ye,vn.power(_,Yt.rational(1,2))),xe)),!0]}if(Xt.equalq(r,1,2)){let Ye=vn.power(Ze.divide(d,ps.add(vn.power(ct,Yt.integer(2)),_)),Yt.rational(1,2)),xe=Ze.multiply(Ye,ct),We=nn(ps.add(Ze.multiply(Ye,vn.power(_,Yt.rational(1,2))),xe)),_t=Si.yyfloat(Ri.real(We));return Xt.isnegativenumber(_t)?[nn(ps.add(Ze.multiply(Ze.negate(Ye),vn.power(_,Yt.rational(1,2))),Ze.negate(xe))),!0]:[We,!0]}return[null,!0]}function nN(e){let t=null,r=[],n=[];if(A.ismultiply(e)){let s=A.cdr(e);if(A.iscons(s))for(;A.iscons(s);){let i=A.car(s);if(A.ispower(i)){let l=A.cadr(i),u=A.caddr(i);Xt.equalq(u,1,2)&&(t==null?(t=u,r.push(l)):da.equal(u,t)&&r.push(l))}else n.push(i);s=A.cdr(s)}}else if(A.ispower(e)){let s=A.cadr(e),i=A.caddr(e);t==null&&Xt.equalq(i,1,2)&&(t=i,r.push(s))}return{commonBases:r,termsThatAreNotPowers:n}}function sN(e){let t=!1,r=[];if(A.iscons(e)){let n=Array.from(e).map(s=>{if(!t){let i;return[i,t]=Oc(s),i}return s});r.push(...n)}return[Vm.makeList(...r),t]}});var dn=N($n=>{"use strict";Object.defineProperty($n,"__esModule",{value:!0});$n.absval=$n.abs=$n.absValFloat=$n.Eval_abs=void 0;var rt=w(),Hm=br(),iN=Oe(),oN=B(),aN=Re(),lN=ge(),Tc=Z(),uN=Ti(),cN=Sn(),Mc=j(),fN=kn(),dN=Ml(),mN=Ks(),wi=se(),xv=oe(),Nc=ee(),_N=ls(),$l=Ot(),hv=Ho(),bN=ms(),Av=ei(),Pr=!1;function gN(e){let t=Qm(Mc.Eval(rt.cadr(e)));oN.push(t)}$n.Eval_abs=gN;function yN(e){return fN.zzfloat(Mc.Eval(Ul(Mc.Eval(e))))}$n.absValFloat=yN;function Qm(e){let t=_N.numerator(e),r=Ul(t),n=cN.denominator(e),s=Ul(n),i=Nc.divide(r,s);return Pr&&(console.trace(">>>>  ABS of "+e),console.log(`ABS numerator ${t}`),console.log(`ABSVAL numerator: ${r}`),console.log(`ABS denominator: ${n}`),console.log(`ABSVAL denominator: ${s}`),console.log(`ABSVAL divided: ${i}`),console.log("<<<<<<<  ABS")),i}$n.abs=Qm;function Ul(e){let t=e;if(Pr&&console.log(`ABS of ${e}`),wi.isZeroAtomOrTensor(e))return Pr&&(console.log(` abs: ${e} just zero`),console.log(" --> ABS of "+t+" : "+rt.Constants.zero)),rt.Constants.zero;if(wi.isnegativenumber(e))return Pr&&console.log(` abs: ${e} just a negative`),Nc.negate(e);if(wi.ispositivenumber(e))return Pr&&(console.log(` abs: ${e} just a positive`),console.log(` --> ABS of ${t} : ${e}`)),e;if(e===rt.symbol(rt.PI))return Pr&&(console.log(` abs: ${e} of PI`),console.log(` --> ABS of ${t} : ${e}`)),e;if(rt.isadd(e)&&(Hm.findPossibleClockForm(e,e)||Hm.findPossibleExponentialForm(e)||Hm.Find(e,rt.Constants.imaginaryunit))){Pr&&(console.log(` abs: ${e} is a sum`),console.log("abs of a sum")),e=bN.rect(e);let n=Av.simplify_trig($l.power(lN.add($l.power(hv.real(e),Tc.integer(2)),$l.power(dN.imag(e),Tc.integer(2))),Tc.rational(1,2)));return Pr&&console.log(` --> ABS of ${t} : ${n}`),n}if(rt.ispower(e)&&wi.equaln(rt.cadr(e),-1)){let n=rt.Constants.One();if(Pr){console.log(` abs: ${e} is -1 to any power`);let s=rt.defs.evaluatingAsFloats?" abs: numeric, so result is 1.0":" abs: symbolic, so result is 1";console.log(s),console.log(` --> ABS of ${t} : ${n}`)}return n}if(rt.ispower(e)&&wi.ispositivenumber(rt.caddr(e))){let n=$l.power(Qm(rt.cadr(e)),rt.caddr(e));return Pr&&(console.log(` abs: ${e} is something to the power of a positive number`),console.log(` --> ABS of ${t} : ${n}`)),n}if(rt.ispower(e)&&rt.cadr(e)===rt.symbol(rt.E)){let n=aN.exponential(hv.real(rt.caddr(e)));return Pr&&(console.log(` abs: ${e} is an exponential`),console.log(` --> ABS of ${t} : ${n}`)),n}if(rt.ismultiply(e)){let n=e.tail().map(Ul).reduce(Nc.multiply);return Pr&&(console.log(` abs: ${e} is a product`),console.log(` --> ABS of ${t} : ${n}`)),n}if(rt.car(e)===rt.symbol(rt.ABS)){let n=xv.makeList(rt.symbol(rt.ABS),rt.cadr(e));return Pr&&(console.log(` abs: ${e} is abs of a abs`),console.log(` --> ABS of ${t} : ${n}`)),n}if(rt.istensor(e))return vN(e);(wi.isnegativeterm(e)||rt.isadd(e)&&wi.isnegativeterm(rt.cadr(e)))&&(e=Nc.negate(e));let r=xv.makeList(rt.symbol(rt.ABS),e);return Pr&&(console.log(` abs: ${e} is nothing decomposable`),console.log(` --> ABS of ${t} : ${r}`)),r}$n.absval=Ul;function vN(e){return e.tensor.ndim!==1&&iN.stop("abs(tensor) with tensor rank > 1"),Mc.Eval(Av.simplify($l.power(mN.inner(e,uN.conjugate(e)),Tc.rational(1,2))))}});var Km=N(on=>{"use strict";Object.defineProperty(on,"__esModule",{value:!0});on.testApprox=on.approxAll=on.approxRationalsOfLogs=on.approxRadicals=on.Eval_approxratio=void 0;var pN=Pt(),Un=w(),qN=B(),Ov=Z(),EN=kn(),xN=oe(),hN=Et();function AN(e){qN.push(Ic(Un.cadr(e)))}on.Eval_approxratio=AN;function Ic(e){if(Un.istensor(e)){let t=pN.alloc_tensor(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=Array.from(e.tensor.dim),t.tensor.elem=t.tensor.elem.map(r=>{let n=Ic(r);return hN.check_tensor_dimensions(t),n}),t}return e.k===Un.DOUBLE?ON(e):Un.iscons(e)?new Un.Cons(Ic(Un.car(e)),Ic(Un.cdr(e))):e}function ON(e){let t=EN.zzfloat(e);if(t.k===Un.DOUBLE){let r=t.d,n=r.toString().split(".");if(n.length===2){let s=n[1].length,i=1/Math.pow(10,s),l=TN(r,i);return Ov.rational(l[0],l[1])}return Ov.integer(r)}return xN.makeList(Un.symbol(Un.APPROXRATIO),t)}function TN(e,t){if(isNaN(e))return[0,0];if(e===1/0)return[1,0];if(e===-1/0)return[-1,0];let r=e<0?-1:1;if(e=Math.abs(e),Math.abs(e-Math.floor(e))<t)return[e*r,1];if(e<1e-19)return[r,1e19];if(e>1e19)return[1e19*r,1];let n=e,s=0,i=1,l;for(;;){n=1/(n-Math.floor(n));let u=i;if(i=i*Math.floor(n)+s,s=u,l=Math.floor(e*i+.5),!(Math.abs(e-l/i)>t)||n===Math.floor(n))break}return l=r*l,[l,i]}var sn=0,MN=1,Tv=2,Mv=3,Wm=4,NN=6,Nv=7,IN=8,SN=9;function RN(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),sn,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,s=Number.MAX_VALUE;for(let i of[2,3,5,6,7,8,10])for(let l=1;l<=10;l++){let u,c,d,_=Math.sqrt(i)/l;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let L=Xr(c,i,l);L<s&&(s=L,n=[`${c} * sqrt( ${i} ) / ${l}`,NN,c,i,l])}}return n}function wN(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),sn,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,s=Number.MAX_VALUE;for(let i of[1,2,3,5,6,7,8,10])for(let l of[1,2,3,5,6,7,8,10]){let u,c,d,_=Math.sqrt(i/l);if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let L=Xr(c,i,l);L<s&&(s=L,n=[`${c} * (sqrt( ${i} / ${l} )`,Wm,c,i,l])}}return n}function Li(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),sn,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=RN(e);if(n!=null)return n;let s=wN(e);return s!=null?s:null}on.approxRadicals=Li;function Bl(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),sn,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=Iv(e);if(n!=null)return n;let s=LN(e);return s!=null?s:null}function Iv(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),sn,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,s=Number.MAX_VALUE;for(let i=2;i<=5;i++)for(let l=1;l<=5;l++){let u,c,d,_=Math.log(i)/l;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),!(c!==1&&Math.abs(Math.floor(c/l))===Math.abs(c/l))&&u<2.2*t){let L=Xr(c,i,l);L<s&&(s=L,n=[`${c} * log( ${i} ) / ${l}`,SN,c,i,l])}}return n}on.approxRationalsOfLogs=Iv;function LN(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),sn,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,s=Number.MAX_VALUE;for(let i=1;i<=5;i++)for(let l=1;l<=5;l++){let u,c,d,_=Math.log(i/l);if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<1.96*t){let L=Xr(c,i,l);L<s&&(s=L,n=[`${c} * log( ${i} / ${l} )`,IN,c,i,l])}}return n}function Sv(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),sn,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,s=Number.MAX_VALUE;for(let i=1;i<=2;i++)for(let l=1;l<=12;l++){let u,c,d,_=Math.pow(Math.E,i)/l;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let L=Xr(c,i,l);L<s&&(s=L,n=[`${c} * (e ^ ${i} ) / ${l}`,Nv,c,i,l])}}return n}function Jm(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),sn,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,s=Number.MAX_VALUE;for(let i=1;i<=5;i++)for(let l=1;l<=12;l++){let u,c,d,_=Math.pow(Math.PI,i)/l;if(Math.abs(_)>1e-10?(d=e/_,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-_)),u<2*t){let L=Xr(c,i,l);L<s&&(s=L,n=[`${c} * (pi ^ ${i} ) / ${l} )`,Mv,c,i,l])}}return n}function Gl(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),sn,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=CN(e);if(n!=null)return n;let s=kN(e);return s!=null?s:null}function CN(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),sn,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,s=Number.MAX_VALUE;for(let i=1;i<=4;i++)for(let l=1;l<=4;l++){let u,c,d,_=i/l,L=Math.sin(_);if(Math.abs(L)>1e-10?(d=e/L,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-L)),u<2*t){let R=Xr(c,i,l);R<s&&(s=R,n=[`${c} * sin( ${i}/${l} )`,MN,c,i,l])}}return n}function kN(e){let t,r=e.toString().split(".");if(r.length===2){let i=r[1].length;t=1/Math.pow(10,i)}else return[""+Math.floor(e),sn,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,s=Number.MAX_VALUE;for(let i=1;i<=13;i++)for(let l=1;l<=13;l++){let u,c,d,_=i/l,L=Math.sin(Math.PI*_);if(Math.abs(L)>1e-10?(d=e/L,c=Math.round(d),u=Math.abs(1-d/c)):(d=1,c=1,u=Math.abs(e-L)),u<23*t){let R=Xr(c,i,l);R<s&&(s=R,n=[`${c} * sin( ${i}/${l} * pi )`,Tv,c,i,l])}}return n}function ke(e){let t,r=e.toString().split(".");if(r.length===2){let R=r[1].length;t=1/Math.pow(10,R)}else return[""+Math.floor(e),sn,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=Number.MAX_VALUE,s=0,i=null,l=!0,u=Li(e);u!=null&&(s=Xr(u),s<n?(l&&console.log(`better explanation by approxRadicals: ${u} complexity: ${s}`),n=s,i=u):l&&console.log(`subpar explanation by approxRadicals: ${u} complexity: ${s}`));let c=Bl(e);c!=null&&(s=Xr(c),s<n?(l&&console.log(`better explanation by approxLogs: ${c} complexity: ${s}`),n=s,i=c):l&&console.log(`subpar explanation by approxLogs: ${c} complexity: ${s}`));let d=Sv(e);d!=null&&(s=Xr(d),s<n?(l&&console.log(`better explanation by approxRationalsOfPowersOfE: ${d} complexity: ${s}`),n=s,i=d):l&&console.log(`subpar explanation by approxRationalsOfPowersOfE: ${d} complexity: ${s}`));let _=Jm(e);_!=null&&(s=Xr(_),s<n?(l&&console.log(`better explanation by approxRationalsOfPowersOfPI: ${_} complexity: ${s}`),n=s,i=_):l&&console.log(`subpar explanation by approxRationalsOfPowersOfPI: ${_} complexity: ${s}`));let L=Gl(e);return L!=null&&(s=Xr(L),s<n?(l&&console.log(`better explanation by approxTrigonometric: ${L} complexity: ${s}`),n=s,i=L):l&&console.log(`subpar explanation by approxTrigonometric: ${L} complexity: ${s}`)),i}on.approxAll=ke;function Xr(e,t,r){let n=0;if(e instanceof Array){switch(e[1]){case Tv:n=4;break;case Mv:n=Math.pow(4,Math.abs(e[3]))*Math.abs(e[2]);break;case Nv:n=Math.pow(3,Math.abs(e[3]))*Math.abs(e[2]);break;default:n=0}n+=Math.abs(e[2])*(Math.abs(e[3])+Math.abs(e[4]))}else n+=Math.abs(e)*(Math.abs(t)+Math.abs(r));return e[2]===1?n-=1:n+=1,e[3]===1?n-=1:n+=1,e[4]===1?n-=1:n+=1,n<0&&(n=0),n}function PN(){for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${t} ) / ${r}`);let n=t/r,s=Math.sqrt(t)/r,i=Li(s),l=i[2]*Math.sqrt(i[3])/i[4];Math.abs(s-l)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${t} ) / ${r} . obtained: ${i}`)}for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing with 4 digits: 1 * sqrt( ${t} ) / ${r}`);let n=t/r,s=Math.sqrt(t)/r,i=s.toFixed(4),l=Li(Number(i)),u=l[2]*Math.sqrt(l[3])/l[4];Math.abs(s-u)>1e-15&&console.log(`fail testapproxRadicals with 4 digits: 1 * sqrt( ${t} ) / ${r} . obtained: ${l}`)}for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${t} / ${r} )`);let n=t/r,s=Math.sqrt(t/r),i=Li(s);if(i!=null){let l=i[2]*Math.sqrt(i[3]/i[4]);i[1]===Wm&&Math.abs(s-l)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${t} / ${r} ) . obtained: ${i}`)}}for(let t of[1,2,3,5,6,7,8,10])for(let r of[1,2,3,5,6,7,8,10]){if(t===1&&r===1)continue;console.log(`testapproxRadicals testing with 4 digits:: 1 * sqrt( ${t} / ${r} )`);let n=t/r,s=Math.sqrt(t/r),i=s.toFixed(4),l=Li(Number(i)),u=l[2]*Math.sqrt(l[3]/l[4]);l[1]===Wm&&Math.abs(s-u)>1e-15&&console.log(`fail testapproxRadicals with 4 digits:: 1 * sqrt( ${t} / ${r} ) . obtained: ${l}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing: 1 * log(${t} ) / ${r}`);let n=t/r,s=Math.log(t)/r,i=ke(s),l=i[2]*Math.log(i[3])/i[4];Math.abs(s-l)>1e-15&&console.log(`fail testApproxAll: 1 * log(${t} ) / ${r} . obtained: ${i}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing with 4 digits: 1 * log(${t} ) / ${r}`);let n=t/r,s=Math.log(t)/r,i=s.toFixed(4),l=ke(Number(i)),u=l[2]*Math.log(l[3])/l[4];Math.abs(s-u)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${t} ) / ${r} . obtained: ${l}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing: 1 * log(${t} / ${r} )}`);let n=t/r,s=Math.log(t/r),i=ke(s),l=i[2]*Math.log(i[3]/i[4]);Math.abs(s-l)>1e-15&&console.log(`fail testApproxAll: 1 * log(${t} / ${r} ) . obtained: ${i}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing with 4 digits: 1 * log(${t} / ${r} )`);let n=t/r,s=Math.log(t/r),i=s.toFixed(4),l=ke(Number(i)),u=l[2]*Math.log(l[3]/l[4]);Math.abs(s-u)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${t} / ${r} ) . obtained: ${l}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`testApproxAll testing: 1 * (e ^ ${t} ) / ${r}`);let n=t/r,s=Math.pow(Math.E,t)/r,i=ke(s),l=i[2]*Math.pow(Math.E,i[3])/i[4];Math.abs(s-l)>1e-15&&console.log(`fail testApproxAll: 1 * (e ^ ${t} ) / ${r} . obtained: ${i}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`approxRationalsOfPowersOfE testing with 4 digits: 1 * (e ^ ${t} ) / ${r}`);let n=t/r,s=Math.pow(Math.E,t)/r,i=s.toFixed(4),l=Sv(Number(i)),u=l[2]*Math.pow(Math.E,l[3])/l[4];Math.abs(s-u)>1e-15&&console.log(`fail approxRationalsOfPowersOfE with 4 digits: 1 * (e ^ ${t} ) / ${r} . obtained: ${l}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`testApproxAll testing: 1 * pi ^ ${t} / ${r}`);let n=t/r,s=Math.pow(Math.PI,t)/r,i=ke(s),l=i[2]*Math.pow(Math.PI,i[3])/i[4];Math.abs(s-l)>1e-15&&console.log(`fail testApproxAll: 1 * pi ^ ${t} / ${r} ) . obtained: ${i}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`approxRationalsOfPowersOfPI testing with 4 digits: 1 * pi ^ ${t} / ${r}`);let n=t/r,s=Math.pow(Math.PI,t)/r,i=s.toFixed(4),l=Jm(Number(i)),u=l[2]*Math.pow(Math.PI,l[3])/l[4];Math.abs(s-u)>1e-15&&console.log(`fail approxRationalsOfPowersOfPI with 4 digits: 1 * pi ^ ${t} / ${r} ) . obtained: ${l}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing: 1 * sin( ${t}/${r} )}`);let n=t/r,s=Math.sin(n),i=ke(s),l=i[3]/i[4],u=i[2]*Math.sin(l);Math.abs(s-u)>1e-15&&console.log(`fail testApproxAll: 1 * sin( ${t}/${r} ) . obtained: ${i}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing with 5 digits: 1 * sin( ${t}/${r} )`);let n=t/r,s=Math.sin(n),i=s.toFixed(5),l=ke(Number(i));l==null&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${t}/${r} ) . obtained:  undefined `);let u=l[3]/l[4],c=l[2]*Math.sin(u),d=Math.abs(s-c);d>1e-14&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${t}/${r} ) . obtained: ${l} error: ${d}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing with 4 digits: 1 * sin( ${t}/${r} )`);let n=t/r,s=Math.sin(n),i=s.toFixed(4),l=ke(Number(i));l==null&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${t}/${r} ) . obtained:  undefined `);let u=l[3]/l[4],c=l[2]*Math.sin(u),d=Math.abs(s-c);d>1e-14&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${t}/${r} ) . obtained: ${l} error: ${d}`)}let e=0;ke(e)[0]!=="0"&&console.log("fail testApproxAll: 0"),e=0,ke(e)[0]!=="0"&&console.log("fail testApproxAll: 0.0"),e=0,ke(e)[0]!=="0"&&console.log("fail testApproxAll: 0.00"),e=0,ke(e)[0]!=="0"&&console.log("fail testApproxAll: 0.000"),e=0,ke(e)[0]!=="0"&&console.log("fail testApproxAll: 0.0000"),e=1,ke(e)[0]!=="1"&&console.log("fail testApproxAll: 1"),e=1,ke(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0"),e=1,ke(e)[0]!=="1"&&console.log("fail testApproxAll: 1.00"),e=1,ke(e)[0]!=="1"&&console.log("fail testApproxAll: 1.000"),e=1,ke(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),e=1,ke(e)[0]!=="1"&&console.log("fail testApproxAll: 1.00000"),e=Math.sqrt(2),ke(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(2)"),e=1.41,ke(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: 1.41"),e=1.4,Li(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail approxRadicals: 1.4"),e=.6,Bl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.6"),e=.69,Bl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.69"),e=.7,Bl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.7"),e=1.09,Bl(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxLogs: 1.09"),e=1.09,ke(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.09"),e=1.098,ke(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.098"),e=1.1,ke(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.1"),e=1.11,ke(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.11"),e=Math.sqrt(3),ke(e)[0]!=="1 * sqrt( 3 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(3)"),e=1,ke(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),e=3.141592,ke(e)[0]!=="1 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 3.141592"),e=31.41592,ke(e)[0]!=="10 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31.41592"),e=314.1592,ke(e)[0]!=="100 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 314.1592"),e=3141592653589793e-8,ke(e)[0]!=="10000000 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31415926.53589793"),e=Math.sqrt(2),Gl(e)[0]!=="2 * sin( 1/4 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(2)"),e=Math.sqrt(3),Gl(e)[0]!=="2 * sin( 1/3 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(3)"),e=(Math.sqrt(6)-Math.sqrt(2))/4,ke(e)[0]!=="1 * sin( 1/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) - Math.sqrt(2))/4"),e=Math.sqrt(2-Math.sqrt(2))/2,ke(e)[0]!=="1 * sin( 1/8 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 - Math.sqrt(2))/2"),e=(Math.sqrt(6)+Math.sqrt(2))/4,ke(e)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) + Math.sqrt(2))/4"),e=Math.sqrt(2+Math.sqrt(3))/2,ke(e)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 + Math.sqrt(3))/2"),e=(Math.sqrt(5)-1)/4,ke(e)[0]!=="1 * sin( 1/10 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(5) - 1)/4"),e=Math.sqrt(10-2*Math.sqrt(5))/4,ke(e)[0]!=="1 * sin( 1/5 * pi )"&&console.log("fail testApproxAll: Math.sqrt(10 - 2*Math.sqrt(5))/4"),e=Math.sin(Math.PI/7),ke(e)[0]!=="1 * sin( 1/7 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/7)"),e=Math.sin(Math.PI/9),ke(e)[0]!=="1 * sin( 1/9 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/9)"),e=1836.15267,Jm(e)[0]!=="6 * (pi ^ 5 ) / 1 )"&&console.log("fail approxRationalsOfPowersOfPI: 1836.15267");for(let t=1;t<=13;t++)for(let r=1;r<=13;r++){console.log(`approxTrigonometric testing: 1 * sin( ${t}/${r} * pi )`);let n=t/r;e=Math.sin(Math.PI*n);let s=Gl(e),i=s[3]/s[4],l=s[2]*Math.sin(Math.PI*i);Math.abs(e-l)>1e-15&&console.log(`fail approxTrigonometric: 1 * sin( ${t}/${r} * pi ) . obtained: ${s}`)}for(let t=1;t<=13;t++)for(let r=1;r<=13;r++){if(t===5&&r===11||t===6&&r===11)continue;console.log(`approxTrigonometric testing with 4 digits: 1 * sin( ${t}/${r} * pi )`);let n=t/r,s=Math.sin(Math.PI*n),i=s.toFixed(4),l=Gl(Number(i)),u=l[3]/l[4],c=l[2]*Math.sin(Math.PI*u),d=Math.abs(s-c);d>1e-14&&console.log(`fail approxTrigonometric with 4 digits: 1 * sin( ${t}/${r} * pi ) . obtained: ${l} error: ${d}`)}return console.log("testApprox done")}on.testApprox=PN});var wv=N(Sc=>{"use strict";Object.defineProperty(Sc,"__esModule",{value:!0});Sc.Eval_arccos=void 0;var J=w(),DN=B(),pr=Z(),$N=j(),Bn=se(),Rv=oe(),ni=ee();function UN(e){DN.push(BN($N.Eval(J.cadr(e))))}Sc.Eval_arccos=UN;function BN(e){if(J.car(e)===J.symbol(J.COS))return J.cadr(e);if(J.isdouble(e))return pr.double(Math.acos(e.d));if(Bn.isoneoversqrttwo(e)||J.ismultiply(e)&&Bn.equalq(J.car(J.cdr(e)),1,2)&&J.car(J.car(J.cdr(J.cdr(e))))===J.symbol(J.POWER)&&Bn.equaln(J.car(J.cdr(J.car(J.cdr(J.cdr(e))))),2)&&Bn.equalq(J.car(J.cdr(J.cdr(J.car(J.cdr(J.cdr(e)))))),1,2))return J.defs.evaluatingAsFloats?pr.double(Math.PI/4):ni.multiply(pr.rational(1,4),J.symbol(J.PI));if(Bn.isminusoneoversqrttwo(e)||J.ismultiply(e)&&Bn.equalq(J.car(J.cdr(e)),-1,2)&&J.car(J.car(J.cdr(J.cdr(e))))===J.symbol(J.POWER)&&Bn.equaln(J.car(J.cdr(J.car(J.cdr(J.cdr(e))))),2)&&Bn.equalq(J.car(J.cdr(J.cdr(J.car(J.cdr(J.cdr(e)))))),1,2))return J.defs.evaluatingAsFloats?pr.double(Math.PI*3/4):ni.multiply(pr.rational(3,4),J.symbol(J.PI));if(Bn.isSqrtThreeOverTwo(e))return J.defs.evaluatingAsFloats?pr.double(Math.PI/6):ni.multiply(pr.rational(1,6),J.symbol(J.PI));if(Bn.isMinusSqrtThreeOverTwo(e))return J.defs.evaluatingAsFloats?pr.double(5*Math.PI/6):ni.multiply(pr.rational(5,6),J.symbol(J.PI));if(!J.isrational(e))return Rv.makeList(J.symbol(J.ARCCOS),e);switch(pr.nativeInt(ni.multiply(e,pr.integer(2)))){case-2:return J.Constants.Pi();case-1:return J.defs.evaluatingAsFloats?pr.double(Math.PI*2/3):ni.multiply(pr.rational(2,3),J.symbol(J.PI));case 0:return J.defs.evaluatingAsFloats?pr.double(Math.PI/2):ni.multiply(pr.rational(1,2),J.symbol(J.PI));case 1:return J.defs.evaluatingAsFloats?pr.double(Math.PI/3):ni.multiply(pr.rational(1,3),J.symbol(J.PI));case 2:return J.Constants.Zero();default:return Rv.makeList(J.symbol(J.ARCCOS),e)}}});var Lv=N(Rc=>{"use strict";Object.defineProperty(Rc,"__esModule",{value:!0});Rc.Eval_arccosh=void 0;var qs=w(),GN=Oe(),FN=B(),jN=Z(),zN=j(),YN=se(),VN=oe();function ZN(e){FN.push(XN(zN.Eval(qs.cadr(e))))}Rc.Eval_arccosh=ZN;function XN(e){if(qs.car(e)===qs.symbol(qs.COSH))return qs.cadr(e);if(qs.isdouble(e)){let{d:t}=e;return t<1&&GN.stop("arccosh function argument is less than 1.0"),t=Math.log(t+Math.sqrt(t*t-1)),jN.double(t)}return YN.isplusone(e)?qs.Constants.zero:VN.makeList(qs.symbol(qs.ARCCOSH),e)}});var kv=N(wc=>{"use strict";Object.defineProperty(wc,"__esModule",{value:!0});wc.Eval_arcsin=void 0;var W=w(),HN=B(),ur=Z(),QN=j(),Gn=se(),Cv=oe(),Es=ee();function WN(e){HN.push(JN(QN.Eval(W.cadr(e))))}wc.Eval_arcsin=WN;function JN(e){if(W.car(e)===W.symbol(W.SIN))return W.cadr(e);if(W.isdouble(e))return ur.double(Math.asin(e.d));if(Gn.isoneoversqrttwo(e)||W.ismultiply(e)&&Gn.equalq(W.car(W.cdr(e)),1,2)&&W.car(W.car(W.cdr(W.cdr(e))))===W.symbol(W.POWER)&&Gn.equaln(W.car(W.cdr(W.car(W.cdr(W.cdr(e))))),2)&&Gn.equalq(W.car(W.cdr(W.cdr(W.car(W.cdr(W.cdr(e)))))),1,2))return Es.multiply(ur.rational(1,4),W.symbol(W.PI));if(Gn.isminusoneoversqrttwo(e)||W.ismultiply(e)&&Gn.equalq(W.car(W.cdr(e)),-1,2)&&W.car(W.car(W.cdr(W.cdr(e))))===W.symbol(W.POWER)&&Gn.equaln(W.car(W.cdr(W.car(W.cdr(W.cdr(e))))),2)&&Gn.equalq(W.car(W.cdr(W.cdr(W.car(W.cdr(W.cdr(e)))))),1,2))return W.defs.evaluatingAsFloats?ur.double(-Math.PI/4):Es.multiply(ur.rational(-1,4),W.symbol(W.PI));if(Gn.isSqrtThreeOverTwo(e))return W.defs.evaluatingAsFloats?ur.double(Math.PI/3):Es.multiply(ur.rational(1,3),W.symbol(W.PI));if(Gn.isMinusSqrtThreeOverTwo(e))return W.defs.evaluatingAsFloats?ur.double(-Math.PI/3):Es.multiply(ur.rational(-1,3),W.symbol(W.PI));if(!W.isrational(e))return Cv.makeList(W.symbol(W.ARCSIN),e);switch(ur.nativeInt(Es.multiply(e,ur.integer(2)))){case-2:return W.defs.evaluatingAsFloats?ur.double(-Math.PI/2):Es.multiply(ur.rational(-1,2),W.symbol(W.PI));case-1:return W.defs.evaluatingAsFloats?ur.double(-Math.PI/6):Es.multiply(ur.rational(-1,6),W.symbol(W.PI));case 0:return W.Constants.Zero();case 1:return W.defs.evaluatingAsFloats?ur.double(Math.PI/6):Es.multiply(ur.rational(1,6),W.symbol(W.PI));case 2:return W.defs.evaluatingAsFloats?ur.double(Math.PI/2):Es.multiply(ur.rational(1,2),W.symbol(W.PI));default:return Cv.makeList(W.symbol(W.ARCSIN),e)}}});var Pv=N(Lc=>{"use strict";Object.defineProperty(Lc,"__esModule",{value:!0});Lc.Eval_arcsinh=void 0;var xs=w(),KN=B(),eI=Z(),tI=j(),rI=se(),nI=oe();function sI(e){KN.push(iI(tI.Eval(xs.cadr(e))))}Lc.Eval_arcsinh=sI;function iI(e){if(xs.car(e)===xs.symbol(xs.SINH))return xs.cadr(e);if(xs.isdouble(e)){let{d:t}=e;return t=Math.log(t+Math.sqrt(t*t+1)),eI.double(t)}return rI.isZeroAtomOrTensor(e)?xs.Constants.zero:nI.makeList(xs.symbol(xs.ARCSINH),e)}});var Dv=N(Cc=>{"use strict";Object.defineProperty(Cc,"__esModule",{value:!0});Cc.Eval_arctanh=void 0;var hs=w(),oI=Oe(),aI=B(),lI=Z(),uI=j(),cI=se(),fI=oe();function dI(e){aI.push(mI(uI.Eval(hs.cadr(e))))}Cc.Eval_arctanh=dI;function mI(e){if(hs.car(e)===hs.symbol(hs.TANH))return hs.cadr(e);if(hs.isdouble(e)){let{d:t}=e;return(t<-1||t>1)&&oI.stop("arctanh function argument is not in the interval [-1,1]"),t=Math.log((1+t)/(1-t))/2,lI.double(t)}return cI.isZeroAtomOrTensor(e)?hs.Constants.zero:fI.makeList(hs.symbol(hs.ARCTANH),e)}});var t_=N(ma=>{"use strict";Object.defineProperty(ma,"__esModule",{value:!0});ma.besselj=ma.Eval_besselj=void 0;var kt=w(),_I=B(),kc=ge(),pn=Z(),bI=$s(),$v=j(),Fl=se(),e_=oe(),qr=ee(),jl=Ot(),gI=rs(),yI=cs();function vI(e){let t=Pc($v.Eval(kt.cadr(e)),$v.Eval(kt.caddr(e)));_I.push(t)}ma.Eval_besselj=vI;function Pc(e,t){return pI(e,t)}ma.besselj=Pc;function pI(e,t){let r=pn.nativeInt(t);if(kt.isdouble(e)&&!isNaN(r)){let n=yI.jn(r,e.d);return pn.double(n)}if(Fl.isZeroAtomOrTensor(e)&&Fl.isZeroAtomOrTensor(t))return kt.Constants.one;if(Fl.isZeroAtomOrTensor(e)&&!isNaN(r))return kt.Constants.zero;if(t.k===kt.NUM&&kt.MEQUAL(t.q.b,2)){if(kt.MEQUAL(t.q.a,1)){let s=kt.defs.evaluatingAsFloats?pn.double(2/Math.PI):qr.divide(pn.integer(2),kt.symbol(kt.PI));return qr.multiply(jl.power(qr.divide(s,e),pn.rational(1,2)),gI.sine(e))}if(kt.MEQUAL(t.q.a,-1)){let s=kt.defs.evaluatingAsFloats?pn.double(2/Math.PI):qr.divide(pn.integer(2),kt.symbol(kt.PI));return qr.multiply(jl.power(qr.divide(s,e),pn.rational(1,2)),bI.cosine(e))}let n=pn.integer(kt.MSIGN(t.q.a));return kc.subtract(qr.multiply(qr.multiply(qr.divide(pn.integer(2),e),kc.subtract(t,n)),Pc(e,kc.subtract(t,n))),Pc(e,kc.subtract(t,qr.multiply(pn.integer(2),n))))}return Fl.isnegativeterm(e)?qr.multiply(qr.multiply(jl.power(qr.negate(e),t),jl.power(e,qr.negate(t))),e_.makeList(kt.symbol(kt.BESSELJ),qr.negate(e),t)):Fl.isnegativeterm(t)?qr.multiply(jl.power(kt.Constants.negOne,t),e_.makeList(kt.symbol(kt.BESSELJ),e,qr.negate(t))):e_.makeList(kt.symbol(kt.BESSELJ),e,t)}});var r_=N(_a=>{"use strict";Object.defineProperty(_a,"__esModule",{value:!0});_a.bessely=_a.Eval_bessely=void 0;var si=w(),qI=B(),Uv=Z(),Bv=j(),EI=se(),Gv=oe(),Fv=ee(),xI=Ot(),hI=cs();function AI(e){let t=jv(Bv.Eval(si.cadr(e)),Bv.Eval(si.caddr(e)));qI.push(t)}_a.Eval_bessely=AI;function jv(e,t){return OI(e,t)}_a.bessely=jv;function OI(e,t){let r=Uv.nativeInt(t);if(si.isdouble(e)&&!isNaN(r)){let n=hI.yn(r,e.d);return Uv.double(n)}return EI.isnegativeterm(t)?Fv.multiply(xI.power(si.Constants.negOne,t),Gv.makeList(si.symbol(si.BESSELY),e,Fv.negate(t))):Gv.makeList(si.symbol(si.BESSELY),e,t)}});var Vv=N(Dc=>{"use strict";Object.defineProperty(Dc,"__esModule",{value:!0});Dc.Eval_binomial=void 0;var As=w(),TI=B(),n_=Re(),MI=ge(),zv=j(),s_=yi(),Yv=ee();function NI(e){let t=zv.Eval(As.cadr(e)),r=zv.Eval(As.caddr(e)),n=II(t,r);TI.push(n)}Dc.Eval_binomial=NI;function II(e,t){return SI(e,t)}function SI(e,t){return RI(e,t)?Yv.divide(Yv.divide(s_.factorial(e),s_.factorial(t)),s_.factorial(MI.subtract(e,t))):As.Constants.zero}function RI(e,t){return As.isNumericAtom(e)&&n_.lessp(e,As.Constants.zero)||As.isNumericAtom(t)&&n_.lessp(t,As.Constants.zero)?!1:!(As.isNumericAtom(e)&&As.isNumericAtom(t)&&n_.lessp(e,t))}});var Xv=N($c=>{"use strict";Object.defineProperty($c,"__esModule",{value:!0});$c.Eval_ceiling=void 0;var Ci=w(),wI=B(),LI=ge(),CI=Z(),kI=j(),Zv=se(),PI=oe(),DI=_n();function $I(e){let t=UI(kI.Eval(Ci.cadr(e)));wI.push(t)}$c.Eval_ceiling=$I;function UI(e){return BI(e)}function BI(e){if(!Ci.isNumericAtom(e))return PI.makeList(Ci.symbol(Ci.CEILING),e);if(Ci.isdouble(e))return CI.double(Math.ceil(e.d));if(Zv.isinteger(e))return e;let t=new Ci.Num(DI.mdiv(e.q.a,e.q.b));return Zv.isnegativenumber(e)||(t=LI.add(t,Ci.Constants.one)),t}});var Wv=N(Uc=>{"use strict";Object.defineProperty(Uc,"__esModule",{value:!0});Uc.Eval_choose=void 0;var Os=w(),GI=B(),i_=Re(),FI=ge(),Hv=j(),o_=yi(),Qv=ee();function jI(e){let t=Hv.Eval(Os.cadr(e)),r=Hv.Eval(Os.caddr(e)),n=zI(t,r);GI.push(n)}Uc.Eval_choose=jI;function zI(e,t){return YI(e,t)?Qv.divide(Qv.divide(o_.factorial(e),o_.factorial(t)),o_.factorial(FI.subtract(e,t))):Os.Constants.zero}function YI(e,t){return Os.isNumericAtom(e)&&i_.lessp(e,Os.Constants.zero)||Os.isNumericAtom(t)&&i_.lessp(t,Os.Constants.zero)?!1:!(Os.isNumericAtom(e)&&Os.isNumericAtom(t)&&i_.lessp(e,t))}});var l_=N(ba=>{"use strict";Object.defineProperty(ba,"__esModule",{value:!0});ba.expcos=ba.Eval_expcos=void 0;var a_=w(),VI=B(),Jv=Re(),ZI=ge(),Kv=Z(),XI=j(),zl=ee();function HI(e){let t=ep(XI.Eval(a_.cadr(e)));VI.push(t)}ba.Eval_expcos=HI;function ep(e){return ZI.add(zl.multiply(Jv.exponential(zl.multiply(a_.Constants.imaginaryunit,e)),Kv.rational(1,2)),zl.multiply(Jv.exponential(zl.multiply(zl.negate(a_.Constants.imaginaryunit),e)),Kv.rational(1,2)))}ba.expcos=ep});var u_=N(ga=>{"use strict";Object.defineProperty(ga,"__esModule",{value:!0});ga.expsin=ga.Eval_expsin=void 0;var Yl=w(),QI=B(),tp=Re(),WI=ge(),rp=Z(),JI=j(),ki=ee();function KI(e){let t=np(JI.Eval(Yl.cadr(e)));QI.push(t)}ga.Eval_expsin=KI;function np(e){return WI.subtract(ki.multiply(ki.divide(tp.exponential(ki.multiply(Yl.Constants.imaginaryunit,e)),Yl.Constants.imaginaryunit),rp.rational(1,2)),ki.multiply(ki.divide(tp.exponential(ki.multiply(ki.negate(Yl.Constants.imaginaryunit),e)),Yl.Constants.imaginaryunit),rp.rational(1,2)))}ga.expsin=np});var ip=N(Bc=>{"use strict";Object.defineProperty(Bc,"__esModule",{value:!0});Bc.Eval_circexp=void 0;var nt=w(),eS=B(),Pi=Re(),ya=ge(),c_=Z(),sp=j(),tS=l_(),rS=u_(),qn=ee(),nS=Et();function sS(e){let t=f_(sp.Eval(nt.cadr(e)));eS.push(sp.Eval(t))}Bc.Eval_circexp=sS;function f_(e){if(nt.car(e)===nt.symbol(nt.COS))return tS.expcos(nt.cadr(e));if(nt.car(e)===nt.symbol(nt.SIN))return rS.expsin(nt.cadr(e));if(nt.car(e)===nt.symbol(nt.TAN)){e=nt.cadr(e);let t=Pi.exponential(qn.multiply(nt.Constants.imaginaryunit,e)),r=Pi.exponential(qn.negate(qn.multiply(nt.Constants.imaginaryunit,e)));return qn.divide(qn.multiply(ya.subtract(r,t),nt.Constants.imaginaryunit),ya.add(t,r))}return nt.car(e)===nt.symbol(nt.COSH)?(e=nt.cadr(e),qn.multiply(ya.add(Pi.exponential(e),Pi.exponential(qn.negate(e))),c_.rational(1,2))):nt.car(e)===nt.symbol(nt.SINH)?(e=nt.cadr(e),qn.multiply(ya.subtract(Pi.exponential(e),Pi.exponential(qn.negate(e))),c_.rational(1,2))):nt.car(e)===nt.symbol(nt.TANH)?(e=Pi.exponential(qn.multiply(nt.cadr(e),c_.integer(2))),qn.divide(ya.subtract(e,nt.Constants.one),ya.add(e,nt.Constants.one))):nt.iscons(e)?e.map(f_):(e.k===nt.TENSOR&&(e=nS.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(f_)),e)}});var Vl=N(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.defn=va.init=void 0;var iS=w(),op=B(),ap=Z(),oS=j(),aS=oe(),lp=Nn(),lS=Vs(),v=w(),E=dt(),d_=0;function uS(){if(d_=0,v.reset_after_error(),v.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated=[],d_)return;d_=1;for(let r=0;r<v.NSYM;r++)v.symtab[r]=new v.Sym(""),v.binding[r]=v.symtab[r],v.isSymbolReclaimable[r]=!1;let[e,t]=cp()}va.init=uS;var up=['version="'+iS.version+'"',"e=exp(1)","i=sqrt(-1)","autoexpand=1","assumeRealVariables=1","trange=[-pi,pi]","xrange=[-10,10]","yrange=[-10,10]","last=0","trace=0","forceFixedPrintout=1","maxFixedPrintoutDigits=6","printLeaveEAlone=1","printLeaveXAlone=0","cross(u,v)=[u[2]*v[3]-u[3]*v[2],u[3]*v[1]-u[1]*v[3],u[1]*v[2]-u[2]*v[1]]","curl(v)=[d(v[3],y)-d(v[2],z),d(v[1],z)-d(v[3],x),d(v[2],x)-d(v[1],y)]","div(v)=d(v[1],x)+d(v[2],y)+d(v[3],z)","ln(x)=log(x)"];function cp(){let e=v.symbol(v.NIL),t=v.symbol(v.NIL);E.std_symbol("abs",v.ABS),E.std_symbol("add",v.ADD),E.std_symbol("adj",v.ADJ),E.std_symbol("and",v.AND),E.std_symbol("approxratio",v.APPROXRATIO),E.std_symbol("arccos",v.ARCCOS),E.std_symbol("arccosh",v.ARCCOSH),E.std_symbol("arcsin",v.ARCSIN),E.std_symbol("arcsinh",v.ARCSINH),E.std_symbol("arctan",v.ARCTAN),E.std_symbol("arctanh",v.ARCTANH),E.std_symbol("arg",v.ARG),E.std_symbol("atomize",v.ATOMIZE),E.std_symbol("besselj",v.BESSELJ),E.std_symbol("bessely",v.BESSELY),E.std_symbol("binding",v.BINDING),E.std_symbol("binomial",v.BINOMIAL),E.std_symbol("ceiling",v.CEILING),E.std_symbol("check",v.CHECK),E.std_symbol("choose",v.CHOOSE),E.std_symbol("circexp",v.CIRCEXP),E.std_symbol("clear",v.CLEAR),E.std_symbol("clearall",v.CLEARALL),E.std_symbol("clearpatterns",v.CLEARPATTERNS),E.std_symbol("clock",v.CLOCK),E.std_symbol("coeff",v.COEFF),E.std_symbol("cofactor",v.COFACTOR),E.std_symbol("condense",v.CONDENSE),E.std_symbol("conj",v.CONJ),E.std_symbol("contract",v.CONTRACT),E.std_symbol("cos",v.COS),E.std_symbol("cosh",v.COSH),E.std_symbol("decomp",v.DECOMP),E.std_symbol("defint",v.DEFINT),E.std_symbol("deg",v.DEGREE),E.std_symbol("denominator",v.DENOMINATOR),E.std_symbol("det",v.DET),E.std_symbol("derivative",v.DERIVATIVE),E.std_symbol("dim",v.DIM),E.std_symbol("dirac",v.DIRAC),E.std_symbol("divisors",v.DIVISORS),E.std_symbol("do",v.DO),E.std_symbol("dot",v.DOT),E.std_symbol("draw",v.DRAW),E.std_symbol("dsolve",v.DSOLVE),E.std_symbol("erf",v.ERF),E.std_symbol("erfc",v.ERFC),E.std_symbol("eigen",v.EIGEN),E.std_symbol("eigenval",v.EIGENVAL),E.std_symbol("eigenvec",v.EIGENVEC),E.std_symbol("eval",v.EVAL),E.std_symbol("exp",v.EXP),E.std_symbol("expand",v.EXPAND),E.std_symbol("expcos",v.EXPCOS),E.std_symbol("expsin",v.EXPSIN),E.std_symbol("factor",v.FACTOR),E.std_symbol("factorial",v.FACTORIAL),E.std_symbol("factorpoly",v.FACTORPOLY),E.std_symbol("filter",v.FILTER),E.std_symbol("float",v.FLOATF),E.std_symbol("floor",v.FLOOR),E.std_symbol("for",v.FOR),E.std_symbol("function",v.FUNCTION),E.std_symbol("Gamma",v.GAMMA),E.std_symbol("gcd",v.GCD),E.std_symbol("hermite",v.HERMITE),E.std_symbol("hilbert",v.HILBERT),E.std_symbol("imag",v.IMAG),E.std_symbol("component",v.INDEX),E.std_symbol("inner",v.INNER),E.std_symbol("integral",v.INTEGRAL),E.std_symbol("inv",v.INV),E.std_symbol("invg",v.INVG),E.std_symbol("isinteger",v.ISINTEGER),E.std_symbol("isprime",v.ISPRIME),E.std_symbol("laguerre",v.LAGUERRE),E.std_symbol("lcm",v.LCM),E.std_symbol("leading",v.LEADING),E.std_symbol("legendre",v.LEGENDRE),E.std_symbol("log",v.LOG),E.std_symbol("lookup",v.LOOKUP),E.std_symbol("mod",v.MOD),E.std_symbol("multiply",v.MULTIPLY),E.std_symbol("not",v.NOT),E.std_symbol("nroots",v.NROOTS),E.std_symbol("number",v.NUMBER),E.std_symbol("numerator",v.NUMERATOR),E.std_symbol("operator",v.OPERATOR),E.std_symbol("or",v.OR),E.std_symbol("outer",v.OUTER),E.std_symbol("pattern",v.PATTERN),E.std_symbol("patternsinfo",v.PATTERNSINFO),E.std_symbol("polar",v.POLAR),E.std_symbol("power",v.POWER),E.std_symbol("prime",v.PRIME),E.std_symbol("print",v.PRINT),E.std_symbol("print2dascii",v.PRINT2DASCII),E.std_symbol("printcomputer",v.PRINTFULL),E.std_symbol("printlatex",v.PRINTLATEX),E.std_symbol("printlist",v.PRINTLIST),E.std_symbol("printhuman",v.PRINTPLAIN),E.std_symbol("printLeaveEAlone",v.PRINT_LEAVE_E_ALONE),E.std_symbol("printLeaveXAlone",v.PRINT_LEAVE_X_ALONE),E.std_symbol("product",v.PRODUCT),E.std_symbol("quote",v.QUOTE),E.std_symbol("quotient",v.QUOTIENT),E.std_symbol("rank",v.RANK),E.std_symbol("rationalize",v.RATIONALIZE),E.std_symbol("real",v.REAL),E.std_symbol("rect",v.YYRECT),E.std_symbol("roots",v.ROOTS),E.std_symbol("round",v.ROUND),E.std_symbol("equals",v.SETQ),E.std_symbol("sgn",v.SGN),E.std_symbol("silentpattern",v.SILENTPATTERN),E.std_symbol("simplify",v.SIMPLIFY),E.std_symbol("sin",v.SIN),E.std_symbol("sinh",v.SINH),E.std_symbol("shape",v.SHAPE),E.std_symbol("sqrt",v.SQRT),E.std_symbol("stop",v.STOP),E.std_symbol("subst",v.SUBST),E.std_symbol("sum",v.SUM),E.std_symbol("symbolsinfo",v.SYMBOLSINFO),E.std_symbol("tan",v.TAN),E.std_symbol("tanh",v.TANH),E.std_symbol("taylor",v.TAYLOR),E.std_symbol("test",v.TEST),E.std_symbol("testeq",v.TESTEQ),E.std_symbol("testge",v.TESTGE),E.std_symbol("testgt",v.TESTGT),E.std_symbol("testle",v.TESTLE),E.std_symbol("testlt",v.TESTLT),E.std_symbol("transpose",v.TRANSPOSE),E.std_symbol("unit",v.UNIT),E.std_symbol("zero",v.ZERO),E.std_symbol("nil",v.NIL),E.std_symbol("autoexpand",v.AUTOEXPAND),E.std_symbol("bake",v.BAKE),E.std_symbol("assumeRealVariables",v.ASSUME_REAL_VARIABLES),E.std_symbol("last",v.LAST),E.std_symbol("lastprint",v.LAST_PRINT),E.std_symbol("last2dasciiprint",v.LAST_2DASCII_PRINT),E.std_symbol("lastfullprint",v.LAST_FULL_PRINT),E.std_symbol("lastlatexprint",v.LAST_LATEX_PRINT),E.std_symbol("lastlistprint",v.LAST_LIST_PRINT),E.std_symbol("lastplainprint",v.LAST_PLAIN_PRINT),E.std_symbol("trace",v.TRACE),E.std_symbol("forceFixedPrintout",v.FORCE_FIXED_PRINTOUT),E.std_symbol("maxFixedPrintoutDigits",v.MAX_FIXED_PRINTOUT_DIGITS),E.std_symbol("~",v.YYE),E.std_symbol("$DRAWX",v.DRAWX),E.std_symbol("$METAA",v.METAA),E.std_symbol("$METAB",v.METAB),E.std_symbol("$METAX",v.METAX),E.std_symbol("$SECRETX",v.SECRETX),E.std_symbol("version",v.VERSION),E.std_symbol("pi",v.PI),E.std_symbol("a",v.SYMBOL_A),E.std_symbol("b",v.SYMBOL_B),E.std_symbol("c",v.SYMBOL_C),E.std_symbol("d",v.SYMBOL_D),E.std_symbol("i",v.SYMBOL_I),E.std_symbol("j",v.SYMBOL_J),E.std_symbol("n",v.SYMBOL_N),E.std_symbol("r",v.SYMBOL_R),E.std_symbol("s",v.SYMBOL_S),E.std_symbol("t",v.SYMBOL_T),E.std_symbol("x",v.SYMBOL_X),E.std_symbol("y",v.SYMBOL_Y),E.std_symbol("z",v.SYMBOL_Z),E.std_symbol("I",v.SYMBOL_IDENTITY_MATRIX),E.std_symbol("a_",v.SYMBOL_A_UNDERSCORE),E.std_symbol("b_",v.SYMBOL_B_UNDERSCORE),E.std_symbol("x_",v.SYMBOL_X_UNDERSCORE),E.std_symbol("$C1",v.C1),E.std_symbol("$C2",v.C2),E.std_symbol("$C3",v.C3),E.std_symbol("$C4",v.C4),E.std_symbol("$C5",v.C5),E.std_symbol("$C6",v.C6),cS();let r=v.defs.codeGen;v.defs.codeGen=!1;for(let n=0;n<up.length;n++){let s=up[n];lS.scan(s),v.DEBUG&&(console.log(`... evaling ${s}`),console.log("top of stack:"),console.log(lp.print_list(op.top()))),oS.Eval(op.pop())}return v.defs.codeGen=r,[e,t]}va.defn=cp;function cS(){let e=aS.makeList(v.symbol(v.POWER),ap.integer(-1),ap.rational(1,2));v.DEBUG&&console.log(lp.print_list(e)),v.Constants.imaginaryunit=e}});var b_=N(an=>{"use strict";Object.defineProperty(an,"__esModule",{value:!0});an.Eval_patternsinfo=an.Eval_clearpatterns=an.do_clearPatterns=an.Eval_pattern=an.Eval_silentpattern=void 0;var Be=w(),m_=Oe(),fp=B(),__=dt(),dp=Re(),fS=oe(),mp=Nn();function dS(e){_p(e),fp.pop(),__.push_symbol(Be.NIL)}an.Eval_silentpattern=dS;function _p(e){let t;Be.iscons(Be.cdr(e))||m_.stop("pattern needs at least a template and a transformed version");let r=Be.car(Be.cdr(e)),n=Be.car(Be.cdr(Be.cdr(e)));n===Be.symbol(Be.NIL)&&m_.stop("pattern needs at least a template and a transformed version"),Be.iscons(Be.cdr(Be.cdr(e)))?t=Be.car(Be.cdr(Be.cdr(Be.cdr(e)))):t=Be.symbol(Be.NIL),dp.equal(r,n)&&m_.stop("recursive pattern");let s="template: "+mp.print_list(r);s+=" tests: "+mp.print_list(t),Be.DEBUG&&console.log(`pattern stringkey: ${s}`);let i=Be.defs.userSimplificationsInStringForm.indexOf(s);i===-1?(Be.defs.userSimplificationsInStringForm.push(s),Be.defs.userSimplificationsInListForm.push(Be.cdr(e))):(Be.DEBUG&&console.log(`pattern already exists, replacing. ${Be.cdr(e)}`),Be.defs.userSimplificationsInStringForm[i]=s,Be.defs.userSimplificationsInListForm[i]=Be.cdr(e)),fp.push(fS.makeList(Be.symbol(Be.PATTERN),Be.cdr(e)))}an.Eval_pattern=_p;function bp(){Be.defs.userSimplificationsInListForm=[],Be.defs.userSimplificationsInStringForm=[]}an.do_clearPatterns=bp;function mS(){bp(),__.push_symbol(Be.NIL)}an.Eval_clearpatterns=mS;function _S(){let e=bS();e!==""?dp.new_string(e):__.push_symbol(Be.NIL)}an.Eval_patternsinfo=_S;function bS(){let e="";for(let t of Array.from(Be.defs.userSimplificationsInListForm))e+=Be.defs.userSimplificationsInListForm+`
`;return e}});var g_=N(Fn=>{"use strict";Object.defineProperty(Fn,"__esModule",{value:!0});Fn.Eval_clear=Fn.clearRenamedVariablesToAvoidBindingToExternalScope=Fn.do_clearall=Fn.Eval_clearall=void 0;var vt=w(),gS=Vl(),yS=cs(),vS=Oe(),gp=B(),pS=dt(),qS=b_();function ES(){let[e,t]=yp();gp.push(vt.symbol(vt.NIL))}Fn.Eval_clearall=ES;function yp(){vt.defs.test_flag||yS.clear_term(),qS.do_clearPatterns(),pS.clear_symbols();let[e,t]=gS.defn();return[vt.defs.codeGen=!1,e,t]}Fn.do_clearall=yp;function xS(){for(let e=0;e<vt.symtab.length;e++)vt.symtab[e].printname.indexOf("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE")!==-1&&(vt.symtab[e].k=vt.SYM,vt.symtab[e].printname="",vt.binding[e]=vt.symtab[e],vt.isSymbolReclaimable[e]=!0)}Fn.clearRenamedVariablesToAvoidBindingToExternalScope=xS;function hS(e){let t;for(t=vt.cdr(e);vt.iscons(t);){let r=vt.car(t);r.k!==vt.SYM&&vS.stop("symbol error");let n=vt.symtab.indexOf(r);vt.symtab[n].k=vt.SYM,vt.symtab[n].printname="",vt.binding[n]=vt.symtab[n],vt.isSymbolReclaimable[n]=!0,t=vt.cdr(t)}gp.push(vt.symbol(vt.NIL))}Fn.Eval_clear=hS});var pp=N(Gc=>{"use strict";Object.defineProperty(Gc,"__esModule",{value:!0});Gc.Eval_contract=void 0;var AS=Pt(),jn=w(),vp=Oe(),OS=B(),TS=ge(),y_=Z(),v_=j(),MS=se();function NS(e){let t=v_.Eval(jn.cadr(e)),r,n;jn.cddr(e)===jn.symbol(jn.NIL)?(r=jn.Constants.one,n=y_.integer(2)):(r=v_.Eval(jn.caddr(e)),n=v_.Eval(jn.cadddr(e)));let s=IS(t,r,n);OS.push(s)}Gc.Eval_contract=NS;function IS(e,t,r){let n=[],s=[];if(!jn.istensor(e))return MS.isZeroAtomOrTensor(e)||vp.stop("contract: tensor expected, 1st arg is not a tensor"),jn.Constants.zero;let i=y_.nativeInt(t),l=y_.nativeInt(r),{ndim:u}=e.tensor;(i<1||i>u||l<1||l>u||i===l||e.tensor.dim[i-1]!==e.tensor.dim[l-1])&&vp.stop("contract: index out of range"),i--,l--;let c=e.tensor.dim[i],d=1;for(let C=0;C<u;C++)C!==i&&C!==l&&(d*=e.tensor.dim[C]);t=AS.alloc_tensor(d),t.tensor.ndim=u-2;let _=0;for(let C=0;C<u;C++)C!==i&&C!==l&&(t.tensor.dim[_++]=e.tensor.dim[C]);let L=e.tensor.elem,R=t.tensor.elem;for(let C=0;C<u;C++)n[C]=0,s[C]=e.tensor.dim[C];for(let C=0;C<d;C++){let Y=jn.Constants.zero;for(let H=0;H<c;H++){n[i]=H,n[l]=H;let Se=0;for(let it=0;it<u;it++)Se=Se*s[it]+n[it];Y=TS.add(Y,L[Se])}R[C]=Y;for(let H=u-1;H>=0;H--)if(!(H===i||H===l)){if(++n[H]<s[H])break;n[H]=0}}return d===1?R[0]:t}});var p_=N(pa=>{"use strict";Object.defineProperty(pa,"__esModule",{value:!0});pa.ycosh=pa.Eval_cosh=void 0;var Ts=w(),SS=B(),RS=Z(),wS=j(),LS=se(),CS=oe();function kS(e){let t=qp(wS.Eval(Ts.cadr(e)));SS.push(t)}pa.Eval_cosh=kS;function qp(e){if(Ts.car(e)===Ts.symbol(Ts.ARCCOSH))return Ts.cadr(e);if(Ts.isdouble(e)){let t=Math.cosh(e.d);return Math.abs(t)<1e-10&&(t=0),RS.double(t)}return LS.isZeroAtomOrTensor(e)?Ts.Constants.one:CS.makeList(Ts.symbol(Ts.COSH),e)}pa.ycosh=qp});var xp=N(qa=>{"use strict";Object.defineProperty(qa,"__esModule",{value:!0});qa.Eval_function_reference=qa.define_user_function=void 0;var En=w(),PS=Oe(),DS=B(),Ep=dt(),$S=j(),US=oe();function BS(e){let t=En.caadr(e),r=En.cdadr(e),n=En.caddr(e);En.issymbol(t)||PS.stop("function name?"),En.car(n)===En.symbol(En.EVAL)&&(n=$S.Eval(En.cadr(n))),n=US.makeList(En.symbol(En.FUNCTION),n,r),Ep.set_binding(t,n),Ep.push_symbol(En.NIL)}qa.define_user_function=BS;function GS(e){DS.push(e)}qa.Eval_function_reference=GS});var x_=N(Ea=>{"use strict";Object.defineProperty(Ea,"__esModule",{value:!0});Ea.dirac=Ea.Eval_dirac=void 0;var cr=w(),FS=B(),jS=j(),q_=se(),E_=oe(),zS=_n(),hp=ee();function YS(e){let t=Ap(jS.Eval(cr.cadr(e)));FS.push(t)}Ea.Eval_dirac=YS;function Ap(e){return VS(e)}Ea.dirac=Ap;function VS(e){return cr.isdouble(e)?e.d===0?cr.Constants.one:cr.Constants.zero:cr.isrational(e)?cr.MZERO(zS.mmul(e.q.a,e.q.b))?cr.Constants.one:cr.Constants.zero:cr.ispower(e)?E_.makeList(cr.symbol(cr.DIRAC),cr.cadr(e)):q_.isnegativeterm(e)?E_.makeList(cr.symbol(cr.DIRAC),hp.negate(e)):((q_.isnegativeterm(e)||cr.isadd(e)&&q_.isnegativeterm(cr.cadr(e)))&&(e=hp.negate(e)),E_.makeList(cr.symbol(cr.DIRAC),e))}});var O_=N(Fc=>{"use strict";Object.defineProperty(Fc,"__esModule",{value:!0});Fc.hermite=void 0;var Ms=w(),ZS=ge(),h_=Z(),XS=j(),HS=oe(),A_=ee(),QS=en();function WS(e,t){return JS(e,t)}Fc.hermite=WS;function JS(e,t){let r=h_.nativeInt(t);return r<0||isNaN(r)?HS.makeList(Ms.symbol(Ms.HERMITE),e,t):Ms.issymbol(e)?Op(r,e):XS.Eval(QS.subst(Op(r,Ms.symbol(Ms.SECRETX)),Ms.symbol(Ms.SECRETX),e))}function Op(e,t){let r=Ms.Constants.zero,n=Ms.Constants.one;for(let s=0;s<e;s++){let i=r;r=n,n=A_.multiply(ZS.subtract(A_.multiply(t,r),A_.multiply(h_.integer(s),i)),h_.integer(2))}return n}});var I_=N(xa=>{"use strict";Object.defineProperty(xa,"__esModule",{value:!0});xa.logarithm=xa.Eval_log=void 0;var Sr=w(),KS=B(),T_=ge(),eR=Z(),tR=Sn(),rR=j(),M_=se(),nR=oe(),N_=ee(),sR=ls();function iR(e){let t=Di(rR.Eval(Sr.cadr(e)));KS.push(t)}xa.Eval_log=iR;function Di(e){return e===Sr.symbol(Sr.E)?Sr.Constants.one:M_.equaln(e,1)?Sr.Constants.zero:M_.isnegativenumber(e)?T_.add(Di(N_.negate(e)),N_.multiply(Sr.Constants.imaginaryunit,Sr.Constants.Pi())):Sr.isdouble(e)?eR.double(Math.log(e.d)):M_.isfraction(e)?T_.subtract(Di(sR.numerator(e)),Di(tR.denominator(e))):Sr.ispower(e)?N_.multiply(Sr.caddr(e),Di(Sr.cadr(e))):Sr.ismultiply(e)?e.tail().map(Di).reduce(T_.add,Sr.Constants.zero):nR.makeList(Sr.symbol(Sr.LOG),e)}xa.logarithm=Di});var R_=N(ha=>{"use strict";Object.defineProperty(ha,"__esModule",{value:!0});ha.sgn=ha.Eval_sgn=void 0;var Er=w(),oR=B(),aR=dn(),lR=j(),Tp=se(),Mp=oe(),Np=_n(),S_=ee(),uR=Ot();function cR(e){let t=Ip(lR.Eval(Er.cadr(e)));oR.push(t)}ha.Eval_sgn=cR;function Ip(e){return Er.isdouble(e)?e.d>0||e.d===0?Er.Constants.one:Er.Constants.negOne:Er.isrational(e)?Er.MSIGN(Np.mmul(e.q.a,e.q.b))===-1?Er.Constants.negOne:Er.MZERO(Np.mmul(e.q.a,e.q.b))?Er.Constants.zero:Er.Constants.one:Tp.iscomplexnumber(e)?S_.multiply(uR.power(Er.Constants.negOne,aR.absval(e)),e):Tp.isnegativeterm(e)?S_.multiply(Mp.makeList(Er.symbol(Er.SGN),S_.negate(e)),Er.Constants.negOne):Mp.makeList(Er.symbol(Er.SGN),e)}ha.sgn=Ip});var w_=N(Aa=>{"use strict";Object.defineProperty(Aa,"__esModule",{value:!0});Aa.ysinh=Aa.Eval_sinh=void 0;var Ns=w(),fR=B(),dR=Z(),mR=j(),_R=se(),bR=oe();function gR(e){let t=Sp(mR.Eval(Ns.cadr(e)));fR.push(t)}Aa.Eval_sinh=gR;function Sp(e){if(Ns.car(e)===Ns.symbol(Ns.ARCSINH))return Ns.cadr(e);if(Ns.isdouble(e)){let t=Math.sinh(e.d);return Math.abs(t)<1e-10&&(t=0),dR.double(t)}return _R.isZeroAtomOrTensor(e)?Ns.Constants.zero:bR.makeList(Ns.symbol(Ns.SINH),e)}Aa.ysinh=Sp});var $i=N(Ta=>{"use strict";Object.defineProperty(Ta,"__esModule",{value:!0});Ta.derivative=Ta.Eval_derivative=void 0;var y=w(),yR=br(),Rp=Oe(),vR=B(),Zl=Re(),Dr=ge(),jc=t_(),wp=r_(),Vt=Z(),Lp=$s(),Cp=p_(),pR=x_(),Oa=j(),kp=tn(),qR=O_(),ER=Hl(),Pp=se(),Xl=oe(),xR=I_(),Ae=ee(),Mr=Ot(),hR=R_(),AR=ei(),OR=rs(),TR=w_(),Dp=en(),L_=Et();function MR(e){e=y.cdr(e);let t=Oa.Eval(y.car(e));e=y.cdr(e);let r,n,s=Oa.Eval(y.car(e));for(s===y.symbol(y.NIL)?(r=kp.guess(t),n=y.symbol(y.NIL)):y.isNumericAtom(s)?(r=kp.guess(t),n=s):(r=s,e=y.cdr(e),n=Oa.Eval(y.car(e)));;){let i;y.isNumericAtom(n)?(i=Vt.nativeInt(n),isNaN(i)&&Rp.stop("nth derivative: check n")):i=1;let l=t;if(i>=0)for(let u=0;u<i;u++)l=at(l,r);else{i=-i;for(let u=0;u<i;u++)l=ER.integral(l,r)}if(t=l,n===y.symbol(y.NIL))break;if(y.isNumericAtom(n)){if(e=y.cdr(e),n=Oa.Eval(y.car(e)),n===y.symbol(y.NIL))break;y.isNumericAtom(n)||(r=n,e=y.cdr(e),n=Oa.Eval(y.car(e)))}else r=n,e=y.cdr(e),n=Oa.Eval(y.car(e))}vR.push(t)}Ta.Eval_derivative=MR;function at(e,t){return y.isNumericAtom(t)&&Rp.stop("undefined function"),y.istensor(e)?y.istensor(t)?L_.d_tensor_tensor(e,t):L_.d_tensor_scalar(e,t):y.istensor(t)?L_.d_scalar_tensor(e,t):NR(e,t)}Ta.derivative=at;function NR(e,t){if(y.issymbol(t))return IR(e,t);let r=Dp.subst(e,t,y.symbol(y.SECRETX));return Dp.subst(at(r,y.symbol(y.SECRETX)),y.symbol(y.SECRETX),t)}function IR(e,t){if(Zl.equal(e,t))return y.Constants.one;if(!y.iscons(e))return y.Constants.zero;if(y.isadd(e))return SR(e,t);switch(y.car(e)){case y.symbol(y.MULTIPLY):return RR(e,t);case y.symbol(y.POWER):return wR(e,t);case y.symbol(y.DERIVATIVE):return CR(e,t);case y.symbol(y.LOG):return LR(e,t);case y.symbol(y.SIN):return PR(e,t);case y.symbol(y.COS):return DR(e,t);case y.symbol(y.TAN):return $R(e,t);case y.symbol(y.ARCSIN):return UR(e,t);case y.symbol(y.ARCCOS):return BR(e,t);case y.symbol(y.ARCTAN):return GR(e,t);case y.symbol(y.SINH):return FR(e,t);case y.symbol(y.COSH):return jR(e,t);case y.symbol(y.TANH):return zR(e,t);case y.symbol(y.ARCSINH):return YR(e,t);case y.symbol(y.ARCCOSH):return VR(e,t);case y.symbol(y.ARCTANH):return ZR(e,t);case y.symbol(y.ABS):return XR(e,t);case y.symbol(y.SGN):return HR(e,t);case y.symbol(y.HERMITE):return QR(e,t);case y.symbol(y.ERF):return WR(e,t);case y.symbol(y.ERFC):return JR(e,t);case y.symbol(y.BESSELJ):return KR(e,t);case y.symbol(y.BESSELY):return rw(e,t);default:}return y.car(e)===y.symbol(y.INTEGRAL)&&y.caddr(e)===t?iw(e):kR(e,t)}function SR(e,t){let r=y.iscons(e)?e.tail().map(n=>at(n,t)):[];return Dr.add_all(r)}function RR(e,t){let r=Zl.length(e)-1,n=[];for(let s=0;s<r;s++){let i=[],l=y.cdr(e);for(let u=0;u<r;u++){let c=y.car(l);s===u&&(c=at(c,t)),i.push(c),l=y.cdr(l)}n.push(Ae.multiply_all(i))}return Dr.add_all(n)}function wR(e,t){let r=Ae.divide(y.caddr(e),y.cadr(e)),n=at(y.cadr(e),t),s=xR.logarithm(y.cadr(e)),i=at(y.caddr(e),t);return Ae.multiply(Dr.add(Ae.multiply(r,n),Ae.multiply(s,i)),e)}function LR(e,t){let r=at(y.cadr(e),t);return Ae.divide(r,y.cadr(e))}function CR(e,t){let r=at(y.cadr(e),t);return y.car(r)===y.symbol(y.DERIVATIVE)?Zl.lessp(y.caddr(r),y.caddr(e))?Xl.makeList(y.symbol(y.DERIVATIVE),Xl.makeList(y.symbol(y.DERIVATIVE),y.cadr(r),y.caddr(r)),y.caddr(e)):Xl.makeList(y.symbol(y.DERIVATIVE),Xl.makeList(y.symbol(y.DERIVATIVE),y.cadr(r),y.caddr(e)),y.caddr(r)):at(r,y.caddr(e))}function kR(e,t){let r=y.cdr(e);return r===y.symbol(y.NIL)||yR.Find(r,t)?Xl.makeList(y.symbol(y.DERIVATIVE),e,t):y.Constants.zero}function PR(e,t){let r=at(y.cadr(e),t);return Ae.multiply(r,Lp.cosine(y.cadr(e)))}function DR(e,t){let r=at(y.cadr(e),t);return Ae.negate(Ae.multiply(r,OR.sine(y.cadr(e))))}function $R(e,t){let r=at(y.cadr(e),t);return Ae.multiply(r,Mr.power(Lp.cosine(y.cadr(e)),Vt.integer(-2)))}function UR(e,t){let r=at(y.cadr(e),t);return Ae.multiply(r,Mr.power(Dr.subtract(y.Constants.one,Mr.power(y.cadr(e),Vt.integer(2))),Vt.rational(-1,2)))}function BR(e,t){let r=at(y.cadr(e),t);return Ae.negate(Ae.multiply(r,Mr.power(Dr.subtract(y.Constants.one,Mr.power(y.cadr(e),Vt.integer(2))),Vt.rational(-1,2))))}function GR(e,t){let r=at(y.cadr(e),t);return AR.simplify(Ae.multiply(r,Ae.inverse(Dr.add(y.Constants.one,Mr.power(y.cadr(e),Vt.integer(2))))))}function FR(e,t){let r=at(y.cadr(e),t);return Ae.multiply(r,Cp.ycosh(y.cadr(e)))}function jR(e,t){let r=at(y.cadr(e),t);return Ae.multiply(r,TR.ysinh(y.cadr(e)))}function zR(e,t){let r=at(y.cadr(e),t);return Ae.multiply(r,Mr.power(Cp.ycosh(y.cadr(e)),Vt.integer(-2)))}function YR(e,t){let r=at(y.cadr(e),t);return Ae.multiply(r,Mr.power(Dr.add(Mr.power(y.cadr(e),Vt.integer(2)),y.Constants.one),Vt.rational(-1,2)))}function VR(e,t){let r=at(y.cadr(e),t);return Ae.multiply(r,Mr.power(Dr.add(Mr.power(y.cadr(e),Vt.integer(2)),y.Constants.negOne),Vt.rational(-1,2)))}function ZR(e,t){let r=at(y.cadr(e),t);return Ae.multiply(r,Ae.inverse(Dr.subtract(y.Constants.one,Mr.power(y.cadr(e),Vt.integer(2)))))}function XR(e,t){let r=at(y.cadr(e),t);return Ae.multiply(r,hR.sgn(y.cadr(e)))}function HR(e,t){let r=at(y.cadr(e),t);return Ae.multiply(Ae.multiply(r,pR.dirac(y.cadr(e))),Vt.integer(2))}function QR(e,t){let r=at(y.cadr(e),t);return Ae.multiply(Ae.multiply(r,Ae.multiply(Vt.integer(2),y.caddr(e))),qR.hermite(y.cadr(e),Dr.add(y.caddr(e),y.Constants.negOne)))}function WR(e,t){let r=at(y.cadr(e),t);return Ae.multiply(Ae.multiply(Ae.multiply(Zl.exponential(Ae.multiply(Mr.power(y.cadr(e),Vt.integer(2)),y.Constants.negOne)),Mr.power(y.Constants.Pi(),Vt.rational(-1,2))),Vt.integer(2)),r)}function JR(e,t){let r=at(y.cadr(e),t);return Ae.multiply(Ae.multiply(Ae.multiply(Zl.exponential(Ae.multiply(Mr.power(y.cadr(e),Vt.integer(2)),y.Constants.negOne)),Mr.power(y.Constants.Pi(),Vt.rational(-1,2))),Vt.integer(-2)),r)}function KR(e,t){return Pp.isZeroAtomOrTensor(y.caddr(e))?ew(e,t):tw(e,t)}function ew(e,t){let r=at(y.cadr(e),t);return Ae.multiply(Ae.multiply(r,jc.besselj(y.cadr(e),y.Constants.one)),y.Constants.negOne)}function tw(e,t){let r=at(y.cadr(e),t);return Ae.multiply(r,Dr.add(jc.besselj(y.cadr(e),Dr.add(y.caddr(e),y.Constants.negOne)),Ae.multiply(Ae.divide(Ae.multiply(y.caddr(e),y.Constants.negOne),y.cadr(e)),jc.besselj(y.cadr(e),y.caddr(e)))))}function rw(e,t){return Pp.isZeroAtomOrTensor(y.caddr(e))?nw(e,t):sw(e,t)}function nw(e,t){let r=at(y.cadr(e),t);return Ae.multiply(Ae.multiply(r,jc.besselj(y.cadr(e),y.Constants.one)),y.Constants.negOne)}function sw(e,t){let r=at(y.cadr(e),t);return Ae.multiply(r,Dr.add(wp.bessely(y.cadr(e),Dr.add(y.caddr(e),y.Constants.negOne)),Ae.multiply(Ae.divide(Ae.multiply(y.caddr(e),y.Constants.negOne),y.cadr(e)),wp.bessely(y.cadr(e),y.caddr(e)))))}function iw(e){return y.cadr(e)}});var Up=N(zc=>{"use strict";Object.defineProperty(zc,"__esModule",{value:!0});zc.partition=void 0;var C_=w(),ow=br(),$p=ee();function aw(e,t){let r=C_.Constants.one,n=r;if(e=C_.cdr(e),!C_.iscons(e))return[r,n];for(let s of e)ow.Find(s,t)?n=$p.multiply(n,s):r=$p.multiply(r,s);return[r,n]}zc.partition=aw});var Hl=N(ii=>{"use strict";Object.defineProperty(ii,"__esModule",{value:!0});ii.make_hashed_itab=ii.integral=ii.Eval_integral=void 0;var ae=w(),Ma=br(),Bp=Oe(),k_=B(),lw=dt(),uw=Re(),cw=ge(),Gp=Z(),fw=$i(),Ui=j(),Fp=tn(),Ql=se(),jp=oe(),dw=ee(),mw=Up(),_w=Vs(),bw=ei(),gw=Um(),yw=["f(a,a*x)","f(1/x,log(x))","f(x^a,x^(a+1)/(a+1))","f(x^(-2),-x^(-1))","f(x^(-1/2),2*x^(1/2))","f(x^(1/2),2/3*x^(3/2))","f(x,x^2/2)","f(x^2,x^3/3)","f(exp(a*x),1/a*exp(a*x))","f(exp(a*x+b),1/a*exp(a*x+b))","f(x*exp(a*x^2),exp(a*x^2)/(2*a))","f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))","f(log(a*x),x*log(a*x)-x)","f(a^x,a^x/log(a),or(not(number(a)),a>0))","f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/(a+b*x),1/b*log(a+b*x))","f(1/(a+b*x)^2,-1/(b*(a+b*x)))","f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)","f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)","f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))","f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))","f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))","f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))","f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))","f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))","f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))","f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))","f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))","f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))","f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))","f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))","f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))","f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))","f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))","f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))","f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))","f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))","f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))","f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))","f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)","f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)","f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))","f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)","f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)","f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)","f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))","f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))","f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))","f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))","f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))","f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))","f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))","f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))","f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))","f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(x/sqrt(a-x^2),-sqrt(a-x^2))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))","f(sin(a*x),-cos(a*x)/a)","f(cos(a*x),sin(a*x)/a)","f(tan(a*x),-log(cos(a*x))/a)","f(1/tan(a*x),log(sin(a*x))/a)","f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)","f(1/sin(a*x),log(tan(a*x/2))/a)","f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))","f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))","f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(1/sin(a*x)^2,-1/(a*tan(a*x)))","f(1/cos(a*x)^2,tan(a*x)/a)","f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))","f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)","f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))","f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)","f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))","f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)","f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)","f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)","f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))","f(sin(a+b*x),-cos(a+b*x)/b)","f(cos(a+b*x),sin(a+b*x)/b)","f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)","f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)","f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)","f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)","f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)","f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)","f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)","f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)","f(x*log(a*x),x^2*log(a*x)/2-x^2/4)","f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)","f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)","f(1/x*1/(a+log(x)),log(a+log(x)))","f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)","f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)","f(sinh(x),cosh(x))","f(cosh(x),sinh(x))","f(tanh(x),log(cosh(x)))","f(x*sinh(x),x*cosh(x)-sinh(x))","f(x*cosh(x),x*sinh(x)-cosh(x))","f(sinh(x)^2,sinh(2*x)/4-x/2)","f(tanh(x)^2,x-tanh(x))","f(cosh(x)^2,sinh(2*x)/4+x/2)","f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)","f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)","f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)","f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))","f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)","f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)","f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))","f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))","f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))","f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"];function vw(e){let t=0;e=ae.cdr(e);let r=Ui.Eval(ae.car(e));e=ae.cdr(e);let n=Ui.Eval(ae.car(e)),s,i;for(n===ae.symbol(ae.NIL)?(i=Fp.guess(r),s=ae.symbol(ae.NIL)):ae.isNumericAtom(n)?(i=Fp.guess(r),s=n):(i=n,e=ae.cdr(e),s=Ui.Eval(ae.car(e)));;){ae.isNumericAtom(s)?(t=Gp.nativeInt(s),isNaN(t)&&Bp.stop("nth integral: check n")):t=1;let l=r;if(t>=0)for(let u=0;u<t;u++)l=Yc(l,i);else{t=-t;for(let u=0;u<t;u++)l=fw.derivative(l,i)}if(r=l,s===ae.symbol(ae.NIL))break;if(ae.isNumericAtom(s)){if(e=ae.cdr(e),s=Ui.Eval(ae.car(e)),s===ae.symbol(ae.NIL))break;ae.isNumericAtom(s)||(i=s,e=ae.cdr(e),s=Ui.Eval(ae.car(e)))}else i=s,e=ae.cdr(e),s=Ui.Eval(ae.car(e))}k_.push(r)}ii.Eval_integral=vw;function Yc(e,t){let r;return ae.isadd(e)?r=pw(e,t):ae.ismultiply(e)?r=qw(e,t):r=zp(e,t),Ma.Find(r,ae.symbol(ae.INTEGRAL))&&Bp.stop("integral: sorry, could not find a solution"),Ui.Eval(bw.simplify(r))}ii.integral=Yc;function pw(e,t){e=ae.cdr(e);let r=Yc(ae.car(e),t);return ae.iscons(e)&&(r=e.tail().reduce((n,s)=>cw.add(n,Yc(s,t)),r)),r}function qw(e,t){let[r,n]=mw.partition(e,t);return dw.multiply(r,zp(n,t))}function zp(e,t){let r=Bi(e,t).toFixed(6),n=Ow[r];if(!n)return jp.makeList(ae.symbol(ae.INTEGRAL),e,t);let[s,i]=gw.transform(e,t,n,!1);return s===ae.symbol(ae.NIL)?jp.makeList(ae.symbol(ae.INTEGRAL),e,t):s}var zn={x:.95532,constexp:1.43762,constant:1.1441659362941434,constbase:1.2036412230421882,sin:1.7330548251830322,arcsin:1.6483368529465805,cos:1.0586721236863401,arccos:1.8405225918106694,tan:1.1224943776292506,arctan:1.1297397925394963,sinh:1.8176164926060079,cosh:1.9404934661708022,tanh:1.6421307715103122,log:1.477443701354924,erf:1.0825269225702916};function Bi(e,t){if(ae.issymbol(e))return uw.equal(e,t)?zn.x:zn.constant;if(ae.iscons(e))switch(lw.symnum(ae.car(e))){case ae.ADD:return xw(ae.cdr(e),t);case ae.MULTIPLY:return hw(ae.cdr(e),t);case ae.POWER:return P_(ae.cadr(e),ae.caddr(e),t);case ae.EXP:return P_(ae.symbol(ae.E),ae.cadr(e),t);case ae.SQRT:Gp.push_double(.5);var r=k_.pop();return P_(ae.cadr(e),r,t);default:return Ew(e,t)}return zn.constant}function Ew(e,t){if(!Ma.Find(ae.cadr(e),t))return zn.constant;let r=ae.car(e),n=Bi(ae.cadr(e),t),s=zn[r.printname];if(!s)throw new Error("Unsupported function "+r.printname);return Math.pow(s,n)}function xw(e,t){let r={};for(;ae.iscons(e);){let s=ae.car(e);e=ae.cdr(e);let i=0;Ma.Find(s,t)?i=Bi(s,t):i=zn.constant,r[i.toFixed(6)]=!0}let n=0;for(let s of Object.keys(r||{})){let i=r[s];n=n+Number(s)}return n}function hw(e,t){let r=1;return ae.iscons(e)&&[...e].forEach(n=>{Ma.Find(n,t)&&(r=r*Bi(n,t))}),r}function P_(e,t,r){let n=zn.constant,s=zn.constexp;if(Ma.Find(e,r)&&(n=Bi(e,r)),Ma.Find(t,r))s=Bi(t,r);else{if(n===zn.constant)return zn.constant;Ql.isminusone(t)?s=-1:Ql.isoneovertwo(t)?s=.5:Ql.isminusoneovertwo(t)?s=-.5:Ql.equalq(t,2,1)?s=2:Ql.equalq(t,-2,1)&&(s=-2)}return Math.pow(n,s)}function Aw(){let e={};for(let t of Array.from(yw)){_w.scan_meta(t);let r=k_.pop(),n=ae.cadr(r),i=Bi(n,ae.symbol(ae.METAX)).toFixed(6);e[i]||(e[i]=[]),e[i].push(t)}return console.log(`hashed_itab = ${JSON.stringify(e,null,2)}`),e}ii.make_hashed_itab=Aw;var Ow={"1.144166":["f(a,a*x)"],"1.046770":["f(1/x,log(x))"],"0.936400":["f(x^a,x^(a+1)/(a+1))"],"1.095727":["f(x^(-2),-x^(-1))"],"1.023118":["f(x^(-1/2),2*x^(1/2))"],"0.977405":["f(x^(1/2),2/3*x^(3/2))"],"0.955320":["f(x,x^2/2)"],"0.912636":["f(x^2,x^3/3)"],"1.137302":["f(exp(a*x),1/a*exp(a*x))","f(a^x,a^x/log(a),or(not(number(a)),a>0))"],"1.326774":["f(exp(a*x+b),1/a*exp(a*x+b))"],"1.080259":["f(x*exp(a*x^2),exp(a*x^2)/(2*a))"],"1.260228":["f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))"],"1.451902":["f(log(a*x),x*log(a*x)-x)"],"0.486192":["f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))"],"0.697274":["f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))"],"0.476307":["f(1/(a+b*x),1/b*log(a+b*x))"],"0.226868":["f(1/(a+b*x)^2,-1/(b*(a+b*x)))"],"2.904531":["f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)"],"0.455026":["f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)"],"0.216732":["f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))"],"0.434695":["f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))"],"0.207048":["f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))"],"2.650781":["f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))"],"0.498584":["f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))"],"0.237479":["f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))"],"3.040375":["f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))"],"0.521902":["f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))"],"0.446014":["f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))"],"0.248586":["f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))"],"0.464469":["f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))"],"0.443716":["f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))"],"0.236382":["f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))"],"0.508931":["f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))"],"0.532733":["f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))"],"0.480638":["f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))"],"0.438648":["f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))"],"0.459164":["f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))"],"0.450070":["f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))"],"1.448960":["f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))"],"1.384221":["f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)"],"1.322374":["f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)"],"1.516728":["f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))"],"1.587665":["f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))"],"0.690150":["f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)"],"0.659314":["f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)"],"0.629856":["f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)"],"0.722428":["f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))"],"0.756216":["f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))"],"1.434156":["f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))"],"0.729886":["f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"1.501230":["f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"0.666120":["f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x/sqrt(a-x^2),-sqrt(a-x^2))"],"1.370077":["f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))"],"1.730087":["f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))"],"0.578006":["f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))"],"0.552180":["f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))"],"1.652787":["f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))"],"1.308862":["f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))"],"1.342944":["f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))"],"0.636358":["f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"0.652928":["f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))"],"0.764022":["f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))"],"1.578940":["f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))"],"1.620055":["f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))"],"0.332117":["f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))"],"1.571443":["f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"1.690994":["f(sin(a*x),-cos(a*x)/a)"],"1.055979":["f(cos(a*x),sin(a*x)/a)"],"1.116714":["f(tan(a*x),-log(cos(a*x))/a)"],"0.895484":["f(1/tan(a*x),log(sin(a*x))/a)"],"0.946989":["f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)"],"0.591368":["f(1/sin(a*x),log(tan(a*x/2))/a)"],"2.859462":["f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))"],"2.128050":["f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"1.115091":["f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))"],"1.081452":["f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"0.349716":["f(1/sin(a*x)^2,-1/(a*tan(a*x)))"],"0.896788":["f(1/cos(a*x)^2,tan(a*x)/a)"],"1.785654":["f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))"],"3.188560":["f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)"],"1.516463":["f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))"],"2.707879":["f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)"],"0.369293":["f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))"],"0.560019":["f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)"],"0.530332":["f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)"],"0.331177":["f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)"],"0.313621":["f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))"],"3.172365":["f(sin(a+b*x),-cos(a+b*x)/b)"],"1.127162":["f(cos(a+b*x),sin(a+b*x)/b)"],"0.352714":["f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)"],"0.454515":["f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)"],"1.615441":["f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)"],"1.543263":["f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)"],"1.008798":["f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)"],"0.963724":["f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)"],"1.611938":["f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)"],"1.791033":["f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)"],"1.123599":["f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)"],"1.387031":["f(x*log(a*x),x^2*log(a*x)/2-x^2/4)"],"1.325058":["f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)"],"2.108018":["f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)"],"0.403214":["f(1/x*1/(a+log(x)),log(a+log(x)))"],"2.269268":["f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)"],"2.486498":["f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)"],"1.769733":["f(sinh(x),cosh(x))"],"1.883858":["f(cosh(x),sinh(x))"],"1.606140":["f(tanh(x),log(cosh(x)))"],"1.690661":["f(x*sinh(x),x*cosh(x)-sinh(x))"],"1.799688":["f(x*cosh(x),x*sinh(x)-cosh(x))"],"3.131954":["f(sinh(x)^2,sinh(2*x)/4-x/2)"],"2.579685":["f(tanh(x)^2,x-tanh(x))"],"3.548923":["f(cosh(x)^2,sinh(2*x)/4+x/2)"],"1.058866":["f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)"],"1.235270":["f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)"],"1.130783":["f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)"],"1.078698":["f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))"],"2.573650":["f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)"],"2.640666":["f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)"],"1.086487":["f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))"],"1.267493":["f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))"],"1.037943":["f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.210862":["f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.064970":["f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))"],"1.242392":["f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"]}});var Vp=N(Vc=>{"use strict";Object.defineProperty(Vc,"__esModule",{value:!0});Vc.Eval_defint=void 0;var Is=w(),Tw=B(),Mw=ge(),Na=j(),Nw=Hl(),Yp=en();function Iw(e){let t=Na.Eval(Is.cadr(e));for(e=Is.cddr(e);Is.iscons(e);){let r=Na.Eval(Is.car(e));e=Is.cdr(e);let n=Na.Eval(Is.car(e));e=Is.cdr(e);let s=Na.Eval(Is.car(e));e=Is.cdr(e),t=Nw.integral(t,r);let i=Na.Eval(Yp.subst(t,r,s)),l=Na.Eval(Yp.subst(t,r,n));t=Mw.subtract(i,l)}Tw.push(t)}Vc.Eval_defint=Iw});var Zc=N(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});Ia.degree=Ia.Eval_degree=void 0;var Hr=w(),Sw=B(),D_=Re(),Zp=j(),Rw=tn(),ww=se();function Lw(e){e=Zp.Eval(Hr.caddr(e));let t=Zp.Eval(Hr.cadr(e)),r=e===Hr.symbol(Hr.NIL)?Rw.guess(t):e;Sw.push(Xp(t,r))}Ia.Eval_degree=Lw;function Xp(e,t){return Hp(e,t,Hr.Constants.zero)}Ia.degree=Xp;function Hp(e,t,r){return D_.equal(e,t)?ww.isZeroAtomOrTensor(r)&&(r=Hr.Constants.one):Hr.ispower(e)?D_.equal(Hr.cadr(e),t)&&Hr.isNumericAtom(Hr.caddr(e))&&D_.lessp(r,Hr.caddr(e))&&(r=Hr.caddr(e)):Hr.iscons(e)&&(r=e.tail().reduce((n,s)=>Hp(s,t,n),r)),r}});var eq=N(oi=>{"use strict";Object.defineProperty(oi,"__esModule",{value:!0});oi.Eval_eigenvec=oi.Eval_eigenval=oi.Eval_eigen=void 0;var Nr=w(),Xc=Oe(),$_=B(),Hc=dt(),Qp=Z(),Wp=j(),Cw=kn(),Jp=oe(),kw=Nn(),Kp=Et(),be=0,rr=[],Ss=[];function Pw(e){let{arg:t}=U_(e);t||Xc.stop("eigen: argument is not a square matrix");let[r,n]=B_(Nr.EIGEN,t);e=Hc.usr_symbol("D"),Hc.set_binding(e,r),e=Hc.usr_symbol("Q"),Hc.set_binding(e,n),$_.push(Nr.symbol(Nr.NIL))}oi.Eval_eigen=Pw;function Dw(e){let t=$w(e);$_.push(t)}oi.Eval_eigenval=Dw;function $w(e){let{arg:t,invalid:r}=U_(e);if(r)return Jp.makeList(Nr.symbol(Nr.EIGENVAL),r);let[n,s]=B_(Nr.EIGENVAL,t);return n}function Uw(e){let t=Bw(e);$_.push(t)}oi.Eval_eigenvec=Uw;function Bw(e){let{arg:t,invalid:r}=U_(e);if(r)return Jp.makeList(Nr.symbol(Nr.EIGENVEC),r);let[n,s]=B_(Nr.EIGENVEC,t);return s}function U_(e){if(e=Wp.Eval(Cw.yyfloat(Wp.Eval(Nr.cadr(e)))),!Nr.istensor(e))return{invalid:e};(e.tensor.ndim!==2||e.tensor.dim[0]!==e.tensor.dim[1])&&Xc.stop("eigen: argument is not a square matrix"),be=e.tensor.dim[0],Gw(e)||Xc.stop("eigen: matrix is not numerical");for(let t=0;t<be-1;t++)for(let r=t+1;r<be;r++){let n=e.tensor.elem[be*t+r],s=e.tensor.elem[be*r+t];Math.abs(n.d-s.d)>1e-10&&Xc.stop("eigen: matrix is not symmetrical")}return{arg:e}}function Gw(e){for(let t=0;t<be;t++)for(let r=0;r<be;r++)if(!Nr.isdouble(e.tensor.elem[be*t+r]))return!1;return!0}function B_(e,t){for(let i=0;i<be*be;i++)rr[i]=0;for(let i=0;i<be*be;i++)Ss[i]=0;for(let i=0;i<be;i++){rr[be*i+i]=t.tensor.elem[be*i+i].d;for(let l=i+1;l<be;l++)rr[be*i+l]=t.tensor.elem[be*i+l].d,rr[be*l+i]=t.tensor.elem[be*i+l].d}for(let i=0;i<be;i++){Ss[be*i+i]=1;for(let l=i+1;l<be;l++)Ss[be*i+l]=0,Ss[be*l+i]=0}let r=0;for(r=0;r<100&&Fw()!==0;r++);r===100&&kw.print_str(`
note: eigen did not converge
`);let n;if(e===Nr.EIGEN||e===Nr.EIGENVAL){n=Kp.copy_tensor(t);for(let i=0;i<be;i++)for(let l=0;l<be;l++)n.tensor.elem[be*i+l]=Qp.double(rr[be*i+l])}let s;if(e===Nr.EIGEN||e===Nr.EIGENVEC){s=Kp.copy_tensor(t);for(let i=0;i<be;i++)for(let l=0;l<be;l++)s.tensor.elem[be*i+l]=Qp.double(Ss[be*i+l])}return[n,s]}function Fw(){let e=0;for(let t=0;t<be-1;t++)for(let r=t+1;r<be;r++)rr[be*t+r]!==0&&(jw(t,r),e++);return e}function jw(e,t){let r=.5*(rr[be*e+e]-rr[be*t+t])/rr[be*e+t],n=1/(Math.abs(r)+Math.sqrt(r*r+1));r<0&&(n=-n);let s=1/Math.sqrt(n*n+1),i=n*s;for(let l=0;l<be;l++){let u=rr[be*e+l],c=rr[be*t+l];rr[be*e+l]=s*u+i*c,rr[be*t+l]=s*c-i*u}for(let l=0;l<be;l++){let u=rr[be*l+e],c=rr[be*l+t];rr[be*l+e]=s*u+i*c,rr[be*l+t]=s*c-i*u}for(let l=0;l<be;l++){let u=Ss[be*e+l],c=Ss[be*t+l];Ss[be*e+l]=s*u+i*c,Ss[be*t+l]=s*c-i*u}rr[be*e+t]=0,rr[be*t+e]=0}});var G_=N(Sa=>{"use strict";Object.defineProperty(Sa,"__esModule",{value:!0});Sa.erfc=Sa.Eval_erfc=void 0;var Wl=w(),zw=B(),Yw=Z(),Vw=j(),Zw=se(),Xw=oe();function Hw(e){let t=Qw(Vw.Eval(Wl.cadr(e)));zw.push(t)}Sa.Eval_erfc=Hw;function Qw(e){if(Wl.isdouble(e)){let t=tq(e.d);return Yw.double(t)}return Zw.isZeroAtomOrTensor(e)?Wl.Constants.one:Xw.makeList(Wl.symbol(Wl.ERFC),e)}function tq(e){if(e===0)return 1;let t=Math.abs(e),r=1/(1+.5*t),n=r*Math.exp(-t*t-1.26551223+r*(1.00002368+r*(.37409196+r*(.09678418+r*(-.18628806+r*(.27886807+r*(-1.13520398+r*(1.48851587+r*(-.82215223+r*.17087277)))))))));return e>=0?n:2-n}Sa.erfc=tq});var iq=N(Qc=>{"use strict";Object.defineProperty(Qc,"__esModule",{value:!0});Qc.Eval_erf=void 0;var Gi=w(),Ww=B(),Jw=Z(),Kw=G_(),eL=j(),rq=se(),nq=oe(),sq=ee();function tL(e){let t=rL(eL.Eval(Gi.cadr(e)));Ww.push(t)}Qc.Eval_erf=tL;function rL(e){return Gi.isdouble(e)?Jw.double(1-Kw.erfc(e.d)):rq.isZeroAtomOrTensor(e)?Gi.Constants.zero:rq.isnegativeterm(e)?sq.negate(nq.makeList(Gi.symbol(Gi.ERF),sq.negate(e))):nq.makeList(Gi.symbol(Gi.ERF),e)}});var lq=N(Wc=>{"use strict";Object.defineProperty(Wc,"__esModule",{value:!0});Wc.factors=void 0;var oq=w();function nL(e){let t=[];return oq.isadd(e)?e.tail().forEach(r=>t.push(...aq(r))):t.push(...aq(e)),t}Wc.factors=nL;function aq(e){return oq.ismultiply(e)?e.tail():[e]}});var gq=N(Jc=>{"use strict";Object.defineProperty(Jc,"__esModule",{value:!0});Jc.Eval_expand=void 0;var F_=Pt(),ut=w(),uq=br(),sL=B(),iL=Re(),j_=ge(),Qr=Z(),cq=Zc(),oL=Sn(),z_=j(),aL=fo(),fq=lq(),dq=nl(),lL=tn(),mq=Ks(),uL=Sl(),Jl=se(),Wr=ee(),cL=ls(),ai=Ot(),fL=Yu(),dL=Et();function mL(e){let t=z_.Eval(ut.cadr(e)),r=z_.Eval(ut.caddr(e)),n=r===ut.symbol(ut.NIL)?lL.guess(t):r,s=t;sL.push(Y_(s,n))}Jc.Eval_expand=mL;function Y_(e,t){if(ut.istensor(e))return _L(e,t);if(ut.isadd(e))return e.tail().reduce((u,c)=>j_.add(u,Y_(c,t)),ut.Constants.zero);let r=cL.numerator(e),n=oL.denominator(e);if([n,r]=bL(n,r,t),(Jl.isone(r)||Jl.isone(n))&&(!Jl.ispolyexpandedform(n,t)||Jl.isone(n)))return e;let s=fL.divpoly(r,n,t);if(r=j_.subtract(r,Wr.multiply(n,s)),Jl.isZeroAtomOrTensor(r))return s;n=aL.factorpoly(n,t);let i=gL(n,t);r=vL(r,i,t),n=pL(n,i,t);let l;if(ut.istensor(i)){let u=ut.doexpand(uL.inv,i);l=mq.inner(mq.inner(u,r),n)}else{let u=ut.doexpand(Wr.divide,r,i);l=Wr.multiply(u,n)}return j_.add(l,s)}function _L(e,t){return e=dL.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(r=>Y_(r,t)),e}function bL(e,t,r){let n=[...fq.factors(e),...fq.factors(t)],s=0;for(let i=0;i<n.length;i++){let l=n[i];if(!ut.ispower(l)||ut.cadr(l)!==r)continue;let u=Qr.nativeInt(ut.caddr(l));isNaN(u)||u<s&&(s=u)}return s===0?[e,t]:(e=Wr.multiply(e,ai.power(r,Qr.integer(-s))),t=Wr.multiply(t,ai.power(r,Qr.integer(-s))),[e,t])}function gL(e,t){let r=[];ut.ismultiply(e)?e.tail().forEach(i=>r.push(..._q(e,i,t))):r.push(..._q(e,e,t));let n=r.length;if(n===1)return r[0];let s=F_.alloc_tensor(n*n);s.tensor.ndim=2,s.tensor.dim[0]=n,s.tensor.dim[1]=n;for(let i=0;i<n;i++)for(let l=0;l<n;l++){let u=ai.power(t,Qr.integer(i)),c=ut.doexpand(Wr.divide,r[l],u);s.tensor.elem[n*i+l]=dq.filter(c,t)}return s}function _q(e,t,r){let n,s=0;if(!uq.Find(t,r))return[];let i=ut.doexpand(yL,e,t);ut.ispower(t)?(s=Qr.nativeInt(ut.caddr(t)),n=ut.cadr(t)):(s=1,n=t);let l=[],u=Qr.nativeInt(cq.degree(n,r));for(let c=0;c<s;c++)for(let d=0;d<u;d++){let _=ai.power(n,Qr.integer(c)),L=ut.doexpand(Wr.multiply,i,_);_=ai.power(r,Qr.integer(d));let R=ut.doexpand(Wr.multiply,L,_);l.push(R)}return l}function yL(e,t){let r=ut.Constants.one;if(ut.ismultiply(e)){let n=[];e.tail().forEach(s=>{iL.equal(s,t)||n.push(z_.Eval(s))}),r=Wr.multiply_all(n)}return r}function vL(e,t,r){if(!ut.istensor(t))return e;let n=t.tensor.dim[0],s=F_.alloc_tensor(n);s.tensor.ndim=1,s.tensor.dim[0]=n;for(let i=0;i<n;i++){let l=ai.power(r,Qr.integer(i)),u=ut.doexpand(Wr.divide,e,l);s.tensor.elem[i]=dq.filter(u,r)}return s}function pL(e,t,r){if(!ut.istensor(t))return Wr.reciprocate(e);let n=[];ut.ismultiply(e)?e.tail().forEach(l=>{n.push(...bq(l,r))}):n=bq(e,r);let s=n.length,i=F_.alloc_tensor(s);return i.tensor.ndim=1,i.tensor.dim[0]=s,i.tensor.elem=n,i}function bq(e,t){let r=1;if(!uq.Find(e,t))return[];ut.ispower(e)&&(r=Qr.nativeInt(ut.caddr(e)),e=ut.cadr(e));let n=[],s=Qr.nativeInt(cq.degree(e,t));for(let i=r;i>0;i--)for(let l=0;l<s;l++)n.push(Wr.multiply(Wr.reciprocate(ai.power(e,Qr.integer(i))),ai.power(t,Qr.integer(l))));return n}});var vq=N(Kc=>{"use strict";Object.defineProperty(Kc,"__esModule",{value:!0});Kc.Eval_floor=void 0;var Fi=w(),qL=B(),EL=ge(),xL=Z(),hL=j(),yq=se(),AL=oe(),OL=_n();function TL(e){let t=ML(hL.Eval(Fi.cadr(e)));qL.push(t)}Kc.Eval_floor=TL;function ML(e){return NL(e)}function NL(e){if(!Fi.isNumericAtom(e))return AL.makeList(Fi.symbol(Fi.FLOOR),e);if(Fi.isdouble(e))return xL.double(Math.floor(e.d));if(yq.isinteger(e))return e;let t=new Fi.Num(OL.mdiv(e.q.a,e.q.b));return yq.isnegativenumber(e)&&(t=EL.add(t,Fi.Constants.negOne)),t}});var qq=N(tf=>{"use strict";Object.defineProperty(tf,"__esModule",{value:!0});tf.Eval_for=void 0;var Ra=w(),IL=Oe(),pq=B(),ef=dt(),SL=Z(),V_=j();function RL(e){let t=Ra.caddr(e);Ra.issymbol(t)||IL.stop("for: 2nd arg should be the variable to loop over");let r=V_.evaluate_integer(Ra.cadddr(e));if(isNaN(r)){pq.push(e);return}let n=V_.evaluate_integer(Ra.caddddr(e));if(isNaN(n)){pq.push(e);return}let s=ef.get_binding(t);for(let i=r;i<=n;i++)ef.set_binding(t,SL.integer(i)),V_.Eval(Ra.cadr(e));ef.set_binding(t,s),ef.push_symbol(Ra.NIL)}tf.Eval_for=RL});var hq=N(nf=>{"use strict";Object.defineProperty(nf,"__esModule",{value:!0});nf.Eval_gamma=void 0;var He=w(),wL=B(),LL=ge(),Z_=Z(),CL=j(),kL=se(),Eq=oe(),Rs=ee(),xq=Ot(),PL=rs();function DL(e){let t=rf(CL.Eval(He.cadr(e)));wL.push(t)}nf.Eval_gamma=DL;function rf(e){return $L(e)}function $L(e){return He.isrational(e)&&He.MEQUAL(e.q.a,1)&&He.MEQUAL(e.q.b,2)?xq.power(He.Constants.Pi(),Z_.rational(1,2)):He.isrational(e)&&He.MEQUAL(e.q.a,3)&&He.MEQUAL(e.q.b,2)?Rs.multiply(xq.power(He.Constants.Pi(),Z_.rational(1,2)),Z_.rational(1,2)):kL.isnegativeterm(e)?Rs.divide(Rs.multiply(He.Constants.Pi(),He.Constants.negOne),Rs.multiply(Rs.multiply(PL.sine(Rs.multiply(He.Constants.Pi(),e)),e),rf(Rs.negate(e)))):He.isadd(e)?UL(e):Eq.makeList(He.symbol(He.GAMMA),e)}function UL(e){let t=He.cdr(e);return He.isrational(He.car(t))&&He.MEQUAL(He.car(t).q.a,1)&&He.MEQUAL(He.car(t).q.b,1)?Rs.multiply(He.cadr(t),rf(He.cadr(t))):He.isrational(He.car(t))&&He.MEQUAL(He.car(t).q.a,-1)&&He.MEQUAL(He.car(t).q.b,1)?Rs.divide(rf(He.cadr(t)),LL.add(He.cadr(t),He.Constants.negOne)):Eq.makeList(He.symbol(He.GAMMA),e)}});var Tq=N(sf=>{"use strict";Object.defineProperty(sf,"__esModule",{value:!0});sf.hilbert=void 0;var Aq=w(),BL=Re(),Oq=Z(),GL=oe(),FL=ee();function jL(e){let t=Oq.nativeInt(e);if(t<2)return GL.makeList(Aq.symbol(Aq.HILBERT),e);let r=BL.zero_matrix(t,t);for(let n=0;n<t;n++)for(let s=0;s<t;s++)r.tensor.elem[n*t+s]=FL.inverse(Oq.integer(n+s+1));return r}sf.hilbert=jL});var Mq=N(of=>{"use strict";Object.defineProperty(of,"__esModule",{value:!0});of.Eval_isprime=void 0;var X_=w(),zL=B(),YL=j(),VL=se(),ZL=dm();function XL(e){let t=HL(YL.Eval(X_.cadr(e)));zL.push(t)}of.Eval_isprime=XL;function HL(e){return VL.isnonnegativeinteger(e)&&ZL.mprime(e.q.a)?X_.Constants.one:X_.Constants.zero}});var Iq=N(cf=>{"use strict";Object.defineProperty(cf,"__esModule",{value:!0});cf.Eval_laguerre=void 0;var Rr=w(),QL=B(),af=ge(),lf=Z(),uf=j(),WL=oe(),H_=ee(),JL=en();function KL(e){let t=uf.Eval(Rr.cadr(e)),r=uf.Eval(Rr.caddr(e)),n=uf.Eval(Rr.cadddr(e)),s=n===Rr.symbol(Rr.NIL)?Rr.Constants.zero:n;QL.push(eC(t,r,s))}cf.Eval_laguerre=KL;function eC(e,t,r){let n=lf.nativeInt(t);return n<0||isNaN(n)?WL.makeList(Rr.symbol(Rr.LAGUERRE),e,t,r):Rr.issymbol(e)?Nq(n,e,r):uf.Eval(JL.subst(Nq(n,Rr.symbol(Rr.SECRETX),r),Rr.symbol(Rr.SECRETX),e))}function Nq(e,t,r){let n=Rr.Constants.zero,s=Rr.Constants.one;for(let i=0;i<e;i++){let l=H_.divide(af.subtract(H_.multiply(af.add(af.subtract(lf.integer(2*i+1),t),r),s),H_.multiply(af.add(lf.integer(i),r),n)),lf.integer(i+1));n=s,s=l}return s}});var Rq=N(df=>{"use strict";Object.defineProperty(df,"__esModule",{value:!0});df.Eval_leading=void 0;var ff=w(),tC=B(),rC=Zc(),Sq=j(),nC=nl(),sC=tn(),iC=ee(),oC=Ot();function aC(e){let t=Sq.Eval(ff.cadr(e));e=Sq.Eval(ff.caddr(e));let r=e===ff.symbol(ff.NIL)?sC.guess(t):e;tC.push(lC(t,r))}df.Eval_leading=aC;function lC(e,t){let r=rC.degree(e,t);return nC.filter(iC.divide(e,oC.power(t,r)),t)}});var Cq=N(_f=>{"use strict";Object.defineProperty(_f,"__esModule",{value:!0});_f.Eval_legendre=void 0;var It=w(),uC=B(),Q_=Re(),wq=ge(),ji=Z(),cC=$s(),fC=$i(),mf=j(),dC=oe(),zi=ee(),mC=Ot(),_C=rs(),bC=en();function gC(e){let t=mf.Eval(It.cadr(e)),r=mf.Eval(It.caddr(e)),n=mf.Eval(It.cadddr(e)),s=n===It.symbol(It.NIL)?It.Constants.zero:n;uC.push(yC(t,r,s))}_f.Eval_legendre=gC;function yC(e,t,r){return vC(e,t,r)}function vC(e,t,r){let n=ji.nativeInt(t),s=ji.nativeInt(r);if(n<0||isNaN(n)||s<0||isNaN(s))return dC.makeList(It.symbol(It.LEGENDRE),e,t,r);let i;if(It.issymbol(e))i=Lq(n,s,e);else{let l=Lq(n,s,It.symbol(It.SECRETX));i=mf.Eval(bC.subst(l,It.symbol(It.SECRETX),e))}return i=pC(i,s,e)||i,i}function Lq(e,t,r){let n=It.Constants.zero,s=It.Constants.one;for(let i=0;i<e;i++){let l=zi.divide(wq.subtract(zi.multiply(zi.multiply(ji.integer(2*i+1),r),s),zi.multiply(ji.integer(i),n)),ji.integer(i+1));n=s,s=l}for(let i=0;i<t;i++)s=fC.derivative(s,r);return s}function pC(e,t,r){if(t===0)return;let n=wq.subtract(It.Constants.one,Q_.square(r));It.car(r)===It.symbol(It.COS)?n=Q_.square(_C.sine(It.cadr(r))):It.car(r)===It.symbol(It.SIN)&&(n=Q_.square(cC.cosine(It.cadr(r))));let s=zi.multiply(e,mC.power(n,zi.multiply(ji.integer(t),ji.rational(1,2))));return t%2&&(s=zi.negate(s)),s}});var kq=N(gf=>{"use strict";Object.defineProperty(gf,"__esModule",{value:!0});gf.Eval_lookup=void 0;var bf=w(),qC=B(),EC=dt();function xC(e){e=bf.cadr(e),!bf.iscons(e)&&bf.cadr(e).k===bf.SYM&&(e=EC.get_binding(e)),qC.push(e)}gf.Eval_lookup=xC});var Dq=N(pf=>{"use strict";Object.defineProperty(pf,"__esModule",{value:!0});pf.Eval_mod=void 0;var ws=w(),yf=Oe(),hC=B(),vf=Z(),Pq=j(),W_=se(),AC=oe(),OC=_n();function TC(e){let t=Pq.Eval(ws.caddr(e)),r=Pq.Eval(ws.cadr(e));hC.push(MC(r,t))}pf.Eval_mod=TC;function MC(e,t){if(W_.isZeroAtomOrTensor(t)&&yf.stop("mod function: divide by zero"),!ws.isNumericAtom(e)||!ws.isNumericAtom(t))return AC.makeList(ws.symbol(ws.MOD),e,t);if(ws.isdouble(e)){let r=vf.nativeInt(e);isNaN(r)&&yf.stop("mod function: cannot convert float value to integer"),e=vf.integer(r)}if(ws.isdouble(t)){let r=vf.nativeInt(t);isNaN(r)&&yf.stop("mod function: cannot convert float value to integer"),t=vf.integer(r)}return(!W_.isinteger(e)||!W_.isinteger(t))&&yf.stop("mod function: integer arguments expected"),new ws.Num(OC.mmod(e.q.a,t.q.a))}});var Fq=N(hf=>{"use strict";Object.defineProperty(hf,"__esModule",{value:!0});hf.Eval_nroots=void 0;var NC=Pt(),xn=w(),Kl=Oe(),J_=B(),IC=Re(),SC=ge(),$q=Z(),RC=qi(),qf=j(),Uq=kn(),wC=tn(),LC=Ml(),CC=se(),kC=ee(),PC=Ho(),Bq=101,Ef=1e-6,DC=1e-9;function eu(e){return Math.sqrt(e.r*e.r+e.i*e.i)}function xf(){return 4*Math.random()-2}var Yn=class{constructor(){this.r=0,this.i=0}},st=new Yn,Vn=new Yn,St=new Yn,Ir=new Yn,$r=new Yn,Jr=new Yn,wa=new Yn,Zn=new Yn,Qe=[];for(let e=0;e<Bq;e++)Qe[e]=new Yn;function $C(e){let t=qf.Eval(xn.caddr(e));e=qf.Eval(xn.cadr(e)),t=t===xn.symbol(xn.NIL)?wC.guess(e):t,CC.ispolyexpandedform(e,t)||Kl.stop("nroots: polynomial?");let r=xn.defs.tos,n=RC.coeff(e,t),s=n.length;s>Bq&&Kl.stop("nroots: degree?");for(let i=0;i<s;i++)e=qf.Eval(Uq.yyfloat(PC.real(n[i]))),t=qf.Eval(Uq.yyfloat(LC.imag(n[i]))),(!xn.isdouble(e)||!xn.isdouble(t))&&Kl.stop("nroots: coefficients?"),Qe[i].r=e.d,Qe[i].i=t.d;UC(s);for(let i=s;i>1;i--)BC(i),Math.abs(st.r)<Ef&&(st.r=0),Math.abs(st.i)<Ef&&(st.i=0),J_.push(SC.add($q.double(st.r),kC.multiply($q.double(st.i),xn.Constants.imaginaryunit))),GC(i);s=xn.defs.tos-r,s>1&&(IC.sort_stack(s),e=NC.alloc_tensor(s),e.tensor.ndim=1,e.tensor.dim[0]=s,e.tensor.elem=xn.defs.stack.slice(r,r+s),J_.moveTos(r),J_.push(e))}hf.Eval_nroots=$C;function UC(e){Ir.r=Qe[e-1].r,Ir.i=Qe[e-1].i;let t=Ir.r*Ir.r+Ir.i*Ir.i;for(let r=0;r<e-1;r++)Qe[r].r=(Qe[r].r*Ir.r+Qe[r].i*Ir.i)/t,Qe[r].i=(Qe[r].i*Ir.r-Qe[r].r*Ir.i)/t;Qe[e-1].r=1,Qe[e-1].i=0}function BC(e){if(eu(Qe[0])<Ef){st.r=0,st.i=0;return}for(let t=0;t<100;t++){st.r=xf(),st.i=xf(),Gq(e),Vn.r=st.r,Vn.i=st.i,Jr.r=$r.r,Jr.i=$r.i,st.r=xf(),st.i=xf();for(let r=0;r<1e3;r++){Gq(e);let n=eu($r);if(xn.DEBUG&&console.log(`nrabs: ${n}`),n<DC)return;eu($r)<eu(Jr)&&(St.r=st.r,St.i=st.i,st.r=Vn.r,st.i=Vn.i,Vn.r=St.r,Vn.i=St.i,St.r=$r.r,St.i=$r.i,$r.r=Jr.r,$r.i=Jr.i,Jr.r=St.r,Jr.i=St.i),wa.r=Vn.r-st.r,wa.i=Vn.i-st.i,Zn.r=Jr.r-$r.r,Zn.i=Jr.i-$r.i;let s=Zn.r*Zn.r+Zn.i*Zn.i;if(s===0)break;Ir.r=(wa.r*Zn.r+wa.i*Zn.i)/s,Ir.i=(wa.i*Zn.r-wa.r*Zn.i)/s,st.r=Vn.r-(Ir.r*Jr.r-Ir.i*Jr.i),st.i=Vn.i-(Ir.r*Jr.i+Ir.i*Jr.r)}}Kl.stop("nroots: convergence error")}function Gq(e){St.r=st.r,St.i=st.i,$r.r=Qe[0].r+Qe[1].r*St.r-Qe[1].i*St.i,$r.i=Qe[0].i+Qe[1].r*St.i+Qe[1].i*St.r;for(let t=2;t<e;t++){let r=st.r*St.r-st.i*St.i;St.i=st.r*St.i+st.i*St.r,St.r=r,$r.r+=Qe[t].r*St.r-Qe[t].i*St.i,$r.i+=Qe[t].r*St.i+Qe[t].i*St.r}}function GC(e){for(let t=e-1;t>0;t--)Qe[t-1].r+=Qe[t].r*st.r-Qe[t].i*st.i,Qe[t-1].i+=Qe[t].i*st.r+Qe[t].r*st.i;eu(Qe[0])>Ef&&Kl.stop("nroots: residual error");for(let t=0;t<e-1;t++)Qe[t].r=Qe[t+1].r,Qe[t].i=Qe[t+1].i}});var Vq=N(Af=>{"use strict";Object.defineProperty(Af,"__esModule",{value:!0});Af.Eval_outer=void 0;var FC=Pt(),li=w(),jC=Oe(),zC=B(),jq=j(),zq=ee(),Yq=Et();function YC(e){e=li.cdr(e);let t=jq.Eval(li.car(e)),r=li.iscons(e)?e.tail().reduce((n,s)=>VC(n,jq.Eval(s)),t):t;zC.push(r)}Af.Eval_outer=YC;function VC(e,t){return li.istensor(e)&&li.istensor(t)?ZC(e,t):li.istensor(e)?Yq.tensor_times_scalar(e,t):li.istensor(t)?Yq.scalar_times_tensor(e,t):zq.multiply(e,t)}function ZC(e,t){let r=e.tensor.ndim+t.tensor.ndim;r>li.MAXDIM&&jC.stop("outer: rank of result exceeds maximum");let n=e.tensor.nelem*t.tensor.nelem,s=FC.alloc_tensor(n);s.tensor.ndim=r,s.tensor.dim=[...e.tensor.dim,...t.tensor.dim];let i=0;for(let l=0;l<e.tensor.nelem;l++)for(let u=0;u<t.tensor.nelem;u++)s.tensor.elem[i++]=zq.multiply(e.tensor.elem[l],t.tensor.elem[u]);return s}});var Xq=N(Of=>{"use strict";Object.defineProperty(Of,"__esModule",{value:!0});Of.Eval_prime=void 0;var K_=w(),XC=Oe(),HC=B(),Zq=Z(),QC=j();function WC(e){let t=JC(QC.Eval(K_.cadr(e)));HC.push(t)}Of.Eval_prime=WC;function JC(e){let t=Zq.nativeInt(e);return(t<1||t>K_.MAXPRIMETAB)&&XC.stop("prime: Argument out of range."),t=K_.primetab[t-1],Zq.integer(t)}});var Hq=N(Mf=>{"use strict";Object.defineProperty(Mf,"__esModule",{value:!0});Mf.Eval_product=void 0;var Yi=w(),KC=Oe(),Tf=B(),eb=dt(),ek=Z(),tb=j(),tk=ee();function rk(e){let t=Yi.cadr(e),r=Yi.caddr(e);Yi.issymbol(r)||KC.stop("sum: 2nd arg?");let n=tb.evaluate_integer(Yi.cadddr(e));if(isNaN(n)){Tf.push(e);return}let s=tb.evaluate_integer(Yi.caddddr(e));if(isNaN(s)){Tf.push(e);return}let i=eb.get_binding(r),l=Yi.Constants.one;for(let u=n;u<=s;u++){eb.set_binding(r,ek.integer(u));let c=tb.Eval(t);l=tk.multiply(l,c),Yi.DEBUG&&(console.log(`product - factor 1: ${c}`),console.log(`product - factor 2: ${l}`),console.log(`product - result: ${Tf.top()}`))}Tf.push(l),eb.set_binding(r,i)}Mf.Eval_product=rk});var Wq=N(Nf=>{"use strict";Object.defineProperty(Nf,"__esModule",{value:!0});Nf.Eval_round=void 0;var tu=w(),nk=B(),Qq=Z(),sk=j(),ik=kn(),ok=se(),ak=oe();function lk(e){let t=uk(sk.Eval(tu.cadr(e)));nk.push(t)}Nf.Eval_round=lk;function uk(e){return tu.isNumericAtom(e)?tu.isdouble(e)?Qq.double(Math.round(e.d)):ok.isinteger(e)?e:(e=ik.yyfloat(e),Qq.integer(Math.round(e.d))):ak.makeList(tu.symbol(tu.ROUND),e)}});var Jq=N(If=>{"use strict";Object.defineProperty(If,"__esModule",{value:!0});If.Eval_shape=void 0;var ck=Pt(),rb=w(),fk=Oe(),dk=B(),mk=Z(),_k=j(),bk=se();function gk(e){let t=yk(_k.Eval(rb.cadr(e)));dk.push(t)}If.Eval_shape=gk;function yk(e){if(!rb.istensor(e))return bk.isZeroAtomOrTensor(e)||fk.stop("transpose: tensor expected, 1st arg is not a tensor"),rb.Constants.zero;let{ndim:t}=e.tensor,r=ck.alloc_tensor(t);r.tensor.ndim=1,r.tensor.dim[0]=t;for(let n=0;n<t;n++)r.tensor.elem[n]=mk.integer(e.tensor.dim[n]);return r}});var Kq=N(Sf=>{"use strict";Object.defineProperty(Sf,"__esModule",{value:!0});Sf.Eval_sum=void 0;var La=w(),vk=Oe(),pk=B(),nb=dt(),qk=ge(),Ek=Z(),sb=j();function xk(e){let t=hk(e);pk.push(t)}Sf.Eval_sum=xk;function hk(e){let t=La.cadr(e),r=La.caddr(e);La.issymbol(r)||vk.stop("sum: 2nd arg?");let n=sb.evaluate_integer(La.cadddr(e));if(isNaN(n))return e;let s=sb.evaluate_integer(La.caddddr(e));if(isNaN(s))return e;let i=nb.get_binding(r),l=La.Constants.zero;for(let u=n;u<=s;u++)nb.set_binding(r,Ek.integer(u)),l=qk.add(l,sb.Eval(t));return nb.set_binding(r,i),l}});var r1=N(wf=>{"use strict";Object.defineProperty(wf,"__esModule",{value:!0});wf.Eval_tan=void 0;var Ur=w(),Ak=B(),Kr=Z(),Ok=j(),Tk=se(),e1=oe(),Vi=ee(),Rf=Ot();function Mk(e){let t=t1(Ok.Eval(Ur.cadr(e)));Ak.push(t)}wf.Eval_tan=Mk;function t1(e){if(Ur.car(e)===Ur.symbol(Ur.ARCTAN))return Ur.cadr(e);if(Ur.isdouble(e)){let r=Math.tan(e.d);return Math.abs(r)<1e-10&&(r=0),Kr.double(r)}if(Tk.isnegative(e))return Vi.negate(t1(Vi.negate(e)));let t=Kr.nativeInt(Vi.divide(Vi.multiply(e,Kr.integer(180)),Ur.Constants.Pi()));if(t<0||isNaN(t))return e1.makeList(Ur.symbol(Ur.TAN),e);switch(t%360){case 0:case 180:return Ur.Constants.zero;case 30:case 210:return Vi.multiply(Kr.rational(1,3),Rf.power(Kr.integer(3),Kr.rational(1,2)));case 150:case 330:return Vi.multiply(Kr.rational(-1,3),Rf.power(Kr.integer(3),Kr.rational(1,2)));case 45:case 225:return Ur.Constants.one;case 135:case 315:return Ur.Constants.negOne;case 60:case 240:return Rf.power(Kr.integer(3),Kr.rational(1,2));case 120:case 300:return Vi.negate(Rf.power(Kr.integer(3),Kr.rational(1,2)));default:return e1.makeList(Ur.symbol(Ur.TAN),e)}}});var n1=N(Lf=>{"use strict";Object.defineProperty(Lf,"__esModule",{value:!0});Lf.Eval_tanh=void 0;var Ls=w(),Nk=B(),Ik=Z(),Sk=j(),Rk=se(),wk=oe();function Lk(e){let t=Ck(Sk.Eval(Ls.cadr(e)));Nk.push(t)}Lf.Eval_tanh=Lk;function Ck(e){if(Ls.car(e)===Ls.symbol(Ls.ARCTANH))return Ls.cadr(e);if(Ls.isdouble(e)){let t=Math.tanh(e.d);return Math.abs(t)<1e-10&&(t=0),Ik.double(t)}return Rk.isZeroAtomOrTensor(e)?Ls.Constants.zero:wk.makeList(Ls.symbol(Ls.TANH),e)}});var a1=N(Cf=>{"use strict";Object.defineProperty(Cf,"__esModule",{value:!0});Cf.Eval_taylor=void 0;var fr=w(),s1=B(),i1=ge(),ib=Z(),kk=$i(),Ca=j(),Pk=yi(),Dk=tn(),$k=se(),Uk=oe(),ob=ee(),o1=en();function Bk(e){e=fr.cdr(e);let t=Ca.Eval(fr.car(e));e=fr.cdr(e);let r=Ca.Eval(fr.car(e)),n=r===fr.symbol(fr.NIL)?Dk.guess(s1.top()):r;e=fr.cdr(e),r=Ca.Eval(fr.car(e));let s=r===fr.symbol(fr.NIL)?ib.integer(24):r;e=fr.cdr(e),r=Ca.Eval(fr.car(e));let i=r===fr.symbol(fr.NIL)?fr.Constants.zero:r;s1.push(Gk(t,n,s,i))}Cf.Eval_taylor=Bk;function Gk(e,t,r,n){let s=ib.nativeInt(r);if(isNaN(s))return Uk.makeList(fr.symbol(fr.TAYLOR),e,t,r,n);let i=fr.Constants.one,l=Ca.Eval(o1.subst(e,t,n));for(let u=1;u<=s&&(e=kk.derivative(e,t),!$k.isZeroAtomOrTensor(e));u++){i=ob.multiply(i,i1.subtract(t,n));let c=Ca.Eval(o1.subst(e,t,n));l=i1.add(l,ob.divide(ob.multiply(c,i),Pk.factorial(ib.integer(u))))}return l}});var l1=N(Ht=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});Ht.Eval_or=Ht.Eval_and=Ht.Eval_not=Ht.Eval_testlt=Ht.Eval_testle=Ht.Eval_testgt=Ht.Eval_testge=Ht.Eval_testeq=Ht.Eval_test=void 0;var Ee=w(),mt=B(),ab=ge(),Cs=j(),Fk=kn(),Zi=se(),kf=ei();function jk(e){mt.push(zk(e))}Ht.Eval_test=jk;function zk(e){let t=e;for(e=Ee.cdr(e);Ee.iscons(e);){if(Ee.cdr(e)===Ee.symbol(Ee.NIL))return Cs.Eval(Ee.car(e));let r=Zi.isZeroLikeOrNonZeroLikeOrUndetermined(Ee.car(e));if(r==null)return t;if(r)return Cs.Eval(Ee.cadr(e));e=Ee.cddr(e)}return Ee.Constants.zero}function Yk(e){let t=e,r=ab.subtract(Cs.Eval(Ee.cadr(e)),Cs.Eval(Ee.caddr(e))),n=Zi.isZeroLikeOrNonZeroLikeOrUndetermined(r);if(n){mt.push(Ee.Constants.zero);return}else if(n!=null&&!n){mt.push(Ee.Constants.one);return}let s=kf.simplify(Cs.Eval(Ee.cadr(e))),i=kf.simplify(Cs.Eval(Ee.caddr(e)));if(r=ab.subtract(s,i),n=Zi.isZeroLikeOrNonZeroLikeOrUndetermined(r),n){mt.push(Ee.Constants.zero);return}else if(n!=null&&!n){mt.push(Ee.Constants.one);return}mt.push(t)}Ht.Eval_testeq=Yk;function Vk(e){let t=e,r=Pf(e);if(r==null){mt.push(t);return}r>=0?mt.push(Ee.Constants.one):mt.push(Ee.Constants.zero)}Ht.Eval_testge=Vk;function Zk(e){let t=e,r=Pf(e);if(r==null){mt.push(t);return}r>0?mt.push(Ee.Constants.one):mt.push(Ee.Constants.zero)}Ht.Eval_testgt=Zk;function Xk(e){let t=e,r=Pf(e);if(r==null){mt.push(t);return}r<=0?mt.push(Ee.Constants.one):mt.push(Ee.Constants.zero)}Ht.Eval_testle=Xk;function Hk(e){let t=e,r=Pf(e);if(r==null){mt.push(t);return}r<0?mt.push(Ee.Constants.one):mt.push(Ee.Constants.zero)}Ht.Eval_testlt=Hk;function Qk(e){let t=e,r=Zi.isZeroLikeOrNonZeroLikeOrUndetermined(Ee.cadr(e));r==null?mt.push(t):r?mt.push(Ee.Constants.zero):mt.push(Ee.Constants.one)}Ht.Eval_not=Qk;function Wk(e){let t=e,r=Ee.cdr(t),n=!1;for(;Ee.iscons(r);){let s=Zi.isZeroLikeOrNonZeroLikeOrUndetermined(Ee.car(r));if(s==null)n=!0,r=Ee.cdr(r);else if(s)r=Ee.cdr(r);else if(!s){mt.push(Ee.Constants.zero);return}}n?mt.push(t):mt.push(Ee.Constants.one)}Ht.Eval_and=Wk;function Jk(e){let t=e,r=Ee.cdr(t),n=!1;for(;Ee.iscons(r);){let s=Zi.isZeroLikeOrNonZeroLikeOrUndetermined(Ee.car(r));if(s==null)n=!0,r=Ee.cdr(r);else if(s){mt.push(Ee.Constants.one);return}else s||(r=Ee.cdr(r))}n?mt.push(t):mt.push(Ee.Constants.zero)}Ht.Eval_or=Jk;function Pf(e){let t=0,r=kf.simplify(Cs.Eval(Ee.cadr(e))),n=kf.simplify(Cs.Eval(Ee.caddr(e)));if(e=ab.subtract(r,n),e.k!==Ee.NUM&&e.k!==Ee.DOUBLE&&(e=Cs.Eval(Fk.yyfloat(e))),Zi.isZeroAtomOrTensor(e))return 0;switch(e.k){case Ee.NUM:Ee.MSIGN(e.q.a)===-1?t=-1:t=1;break;case Ee.DOUBLE:e.d<0?t=-1:t=1;break;default:t=null}return t}});var f1=N(Uf=>{"use strict";Object.defineProperty(Uf,"__esModule",{value:!0});Uf.Eval_user_function=void 0;var de=w(),lb=Oe(),ht=B(),u1=dt(),Kk=$i(),ub=j(),Df=oe(),c1=Et();function e3(e){if(de.DEBUG&&console.log(`Eval_user_function evaluating: ${de.car(e)}`),de.car(e)===de.symbol(de.SYMBOL_D)&&u1.get_binding(de.symbol(de.SYMBOL_D))===de.symbol(de.SYMBOL_D)){Kk.Eval_derivative(e);return}let t=ub.Eval(de.car(e));de.isNumericAtom(t)?lb.stop("expected function invocation, found multiplication instead. Use '*' symbol explicitly for multiplication."):de.istensor(t)?lb.stop("expected function invocation, found tensor product instead. Use 'dot/inner' explicitly."):de.isstr(t)&&lb.stop("expected function, found string instead.");let r=de.car(de.cdr(t)),n=de.car(de.cdr(de.cdr(t))),s=de.cdr(e);if(de.car(t)!==de.symbol(de.FUNCTION)||t===de.car(e)){let c=de.defs.tos;for(ht.push(t),e=s;de.iscons(e);)ht.push(ub.Eval(de.car(e))),e=de.cdr(e);Df.list(de.defs.tos-c);return}e=n;let i=s,l=de.defs.tos;for(;de.iscons(e)&&de.iscons(i);)ht.push(de.car(e)),ht.push(de.car(i)),e=de.cdr(e),i=de.cdr(i);Df.list(de.defs.tos-l);let u=ht.pop();ht.push(r),de.iscons(u)&&(ht.push(u),$f()),ht.push(ub.Eval(ht.pop()))}Uf.Eval_user_function=e3;function $f(){let e=0,t=ht.pop(),r=ht.pop();if(de.istensor(r))return e=t3(r,t),e;if(de.iscons(r)){let s=de.defs.tos;for(de.car(r)===de.car(t)?ht.push(Df.makeList(de.symbol(de.EVAL),de.car(de.cdr(t)))):ht.push(de.car(r)),r=de.cdr(r);de.iscons(r);)ht.push(de.car(r)),ht.push(t),e+=$f(),r=de.cdr(r);return Df.list(de.defs.tos-s),e}if(!de.issymbol(r))return ht.push(r),0;let n=t;for(;de.iscons(n);){if(r===de.car(n))return ht.push(de.cadr(n)),1;n=de.cddr(n)}return n=u1.get_binding(r),ht.push(n),r!==n&&(ht.push(t),e=$f(),e===0&&(ht.pop(),ht.push(r))),e}function t3(e,t){let r=0;return e=c1.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(n=>(ht.push(n),ht.push(t),r+=$f(),ht.pop())),c1.check_tensor_dimensions(e),ht.push(e),r}});var d1=N(Gf=>{"use strict";Object.defineProperty(Gf,"__esModule",{value:!0});Gf.Eval_zero=void 0;var r3=Pt(),Bf=w(),n3=B(),s3=j();function i3(e){n3.push(o3(e))}Gf.Eval_zero=i3;function o3(e){let t=Array(Bf.MAXDIM).fill(0),r=1,n=0;if(Bf.iscons(e))for(let s of e.tail()){let i=s3.evaluate_integer(s);if(i<1||isNaN(i))return Bf.Constants.zero;r*=i,t[n++]=i}if(n===0)return Bf.Constants.zero;e=r3.alloc_tensor(r),e.tensor.ndim=n;for(let s=0;s<n;s++)e.tensor.dim[s]=t[s];return e}});var j=N(ci=>{"use strict";Object.defineProperty(ci,"__esModule",{value:!0});ci.Eval_predicate=ci.Eval=ci.evaluate_integer=void 0;var m1=Db(),a3=Pt(),b=w(),ui=Oe(),Pe=B(),ka=dt(),l3=Re(),u3=dn(),c3=ge(),f3=Lm(),d3=Km(),m3=wv(),_3=Lv(),b3=kv(),g3=Pv(),y3=xm(),v3=Dv(),p3=Lo(),q3=t_(),E3=r_(),Xi=Z(),x3=Vv(),h3=Xv(),A3=Wv(),O3=ip(),_1=g_(),T3=lc(),M3=qi(),N3=wm(),I3=sl(),S3=Ti(),R3=pp(),w3=$s(),L3=p_(),C3=Dm(),b1=xp(),k3=Vp(),P3=Zc(),D3=Sn(),$3=$i(),U3=mc(),B3=x_(),G3=Pd(),cb=eq(),F3=iq(),j3=G_(),z3=gq(),Y3=l_(),V3=u_(),Z3=il(),X3=yi(),g1=fo(),H3=nl(),Q3=kn(),W3=vq(),J3=qq(),K3=hq(),eP=pi(),tP=O_(),rP=Tq(),nP=Ml(),y1=Ks(),sP=Hl(),v1=Sl(),Ff=se(),iP=Mq(),oP=Iq(),aP=Ld(),lP=Rq(),uP=Cq(),jf=oe(),cP=I_(),fP=kq(),dP=Dq(),mP=ee(),_P=Fq(),bP=ls(),gP=Vq(),zf=b_(),yP=uc(),p1=Ot(),vP=Xq(),Pa=Nn(),pP=Hq(),qP=Yu(),EP=ol(),xP=Ho(),hP=ms(),AP=Pm(),OP=Wq(),TP=R_(),MP=Jq(),NP=ei(),IP=rs(),SP=w_(),q1=en(),RP=Kq(),wP=r1(),LP=n1(),CP=a1(),E1=Et(),ks=l1(),kP=jm(),x1=f1(),PP=d1();function fb(e){return Xi.nativeInt(je(e))}ci.evaluate_integer=fb;function je(e){let t;ui.check_esc_flag(),e==null&&b.breakpoint,!b.defs.evaluatingAsFloats&&Ff.isfloating(e)&&(t=!0,b.defs.evaluatingAsFloats=!0);let r;switch(e.k){case b.CONS:$P(e),r=Pe.pop();break;case b.NUM:r=b.defs.evaluatingAsFloats?Xi.double(Xi.convert_rational_to_double(e)):e;break;case b.DOUBLE:case b.STR:r=e;break;case b.TENSOR:E1.Eval_tensor(e),r=Pe.pop();break;case b.SYM:DP(e),r=Pe.pop();break;default:ui.stop("atom?")}return t&&(b.defs.evaluatingAsFloats=!1),r}ci.Eval=je;function DP(e){if(b.iskeyword(e)){Pe.push(je(jf.makeList(e,b.symbol(b.LAST))));return}else if(e===b.symbol(b.PI)&&b.defs.evaluatingAsFloats){Pe.push(b.Constants.piAsDouble);return}let t=ka.get_binding(e);if(b.DEBUG&&console.log(`looked up: ${e} which contains: ${t}`),Pe.push(t),e!==t){let r=b.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.indexOf(e);if(r!==-1){let n="";for(let s=r;s<b.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.length;s++)n+=b.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated[s].printname+" -> ";n+=e.printname,ui.stop("recursive evaluation of symbols: "+n);return}b.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.push(e),Pe.push(je(Pe.pop())),b.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.pop()}}function $P(e){let t=b.car(e);if(b.car(t)===b.symbol(b.EVAL)){x1.Eval_user_function(e);return}switch(b.issymbol(t)||ui.stop("cons?"),ka.symnum(t)){case b.ABS:return u3.Eval_abs(e);case b.ADD:return c3.Eval_add(e);case b.ADJ:return f3.Eval_adj(e);case b.AND:return ks.Eval_and(e);case b.ARCCOS:return m3.Eval_arccos(e);case b.ARCCOSH:return _3.Eval_arccosh(e);case b.ARCSIN:return b3.Eval_arcsin(e);case b.ARCSINH:return g3.Eval_arcsinh(e);case b.ARCTAN:return y3.Eval_arctan(e);case b.ARCTANH:return v3.Eval_arctanh(e);case b.ARG:return p3.Eval_arg(e);case b.BESSELJ:return q3.Eval_besselj(e);case b.BESSELY:return E3.Eval_bessely(e);case b.BINDING:return UP(e);case b.BINOMIAL:return x3.Eval_binomial(e);case b.CEILING:return h3.Eval_ceiling(e);case b.CHECK:return BP(e);case b.CHOOSE:return A3.Eval_choose(e);case b.CIRCEXP:return O3.Eval_circexp(e);case b.CLEAR:return _1.Eval_clear(e);case b.CLEARALL:return _1.Eval_clearall();case b.CLEARPATTERNS:return zf.Eval_clearpatterns();case b.CLOCK:return T3.Eval_clock(e);case b.COEFF:return M3.Eval_coeff(e);case b.COFACTOR:return N3.Eval_cofactor(e);case b.CONDENSE:return I3.Eval_condense(e);case b.CONJ:return S3.Eval_conj(e);case b.CONTRACT:return R3.Eval_contract(e);case b.COS:return w3.Eval_cos(e);case b.COSH:return L3.Eval_cosh(e);case b.DECOMP:return C3.Eval_decomp(e);case b.DEGREE:return P3.Eval_degree(e);case b.DEFINT:return k3.Eval_defint(e);case b.DENOMINATOR:return D3.Eval_denominator(e);case b.DERIVATIVE:return $3.Eval_derivative(e);case b.DET:return GP(e);case b.DIM:return FP(e);case b.DIRAC:return B3.Eval_dirac(e);case b.DIVISORS:return jP(e);case b.DO:return zP(e);case b.DOT:return y1.Eval_inner(e);case b.EIGEN:return cb.Eval_eigen(e);case b.EIGENVAL:return cb.Eval_eigenval(e);case b.EIGENVEC:return cb.Eval_eigenvec(e);case b.ERF:return F3.Eval_erf(e);case b.ERFC:return j3.Eval_erfc(e);case b.EVAL:return YP(e);case b.EXP:return VP(e);case b.EXPAND:return z3.Eval_expand(e);case b.EXPCOS:return Y3.Eval_expcos(e);case b.EXPSIN:return V3.Eval_expsin(e);case b.FACTOR:return Z3.Eval_factor(e);case b.FACTORIAL:return ZP(e);case b.FACTORPOLY:return XP(e);case b.FILTER:return H3.Eval_filter(e);case b.FLOATF:return Q3.Eval_float(e);case b.APPROXRATIO:return d3.Eval_approxratio(e);case b.FLOOR:return W3.Eval_floor(e);case b.FOR:return J3.Eval_for(e);case b.FUNCTION:return b1.Eval_function_reference(e);case b.GAMMA:return K3.Eval_gamma(e);case b.GCD:return eP.Eval_gcd(e);case b.HERMITE:return HP(e);case b.HILBERT:return QP(e);case b.IMAG:return nP.Eval_imag(e);case b.INDEX:return WP(e);case b.INNER:return y1.Eval_inner(e);case b.INTEGRAL:return sP.Eval_integral(e);case b.INV:return KP(e);case b.INVG:return eD(e);case b.ISINTEGER:return tD(e);case b.ISPRIME:return iP.Eval_isprime(e);case b.LAGUERRE:return oP.Eval_laguerre(e);case b.LCM:return aP.Eval_lcm(e);case b.LEADING:return lP.Eval_leading(e);case b.LEGENDRE:return uP.Eval_legendre(e);case b.LOG:return cP.Eval_log(e);case b.LOOKUP:return fP.Eval_lookup(e);case b.MOD:return dP.Eval_mod(e);case b.MULTIPLY:return mP.Eval_multiply(e);case b.NOT:return ks.Eval_not(e);case b.NROOTS:return _P.Eval_nroots(e);case b.NUMBER:return nD(e);case b.NUMERATOR:return bP.Eval_numerator(e);case b.OPERATOR:return sD(e);case b.OR:return ks.Eval_or(e);case b.OUTER:return gP.Eval_outer(e);case b.PATTERN:return zf.Eval_pattern(e);case b.PATTERNSINFO:return zf.Eval_patternsinfo();case b.POLAR:return yP.Eval_polar(e);case b.POWER:return p1.Eval_power(e);case b.PRIME:return vP.Eval_prime(e);case b.PRINT:return Pa.Eval_print(e);case b.PRINT2DASCII:return Pa.Eval_print2dascii(e);case b.PRINTFULL:return Pa.Eval_printcomputer(e);case b.PRINTLATEX:return Pa.Eval_printlatex(e);case b.PRINTLIST:return Pa.Eval_printlist(e);case b.PRINTPLAIN:return Pa.Eval_printhuman(e);case b.PRODUCT:return pP.Eval_product(e);case b.QUOTE:return iD(e);case b.QUOTIENT:return qP.Eval_quotient(e);case b.RANK:return oD(e);case b.RATIONALIZE:return EP.Eval_rationalize(e);case b.REAL:return xP.Eval_real(e);case b.ROUND:return OP.Eval_round(e);case b.YYRECT:return hP.Eval_rect(e);case b.ROOTS:return AP.Eval_roots(e);case b.SETQ:return aD(e);case b.SGN:return TP.Eval_sgn(e);case b.SILENTPATTERN:return zf.Eval_silentpattern(e);case b.SIMPLIFY:return NP.Eval_simplify(e);case b.SIN:return IP.Eval_sin(e);case b.SINH:return SP.Eval_sinh(e);case b.SHAPE:return MP.Eval_shape(e);case b.SQRT:return uD(e);case b.STOP:return cD();case b.SUBST:return fD(e);case b.SUM:return RP.Eval_sum(e);case b.SYMBOLSINFO:return ka.Eval_symbolsinfo();case b.TAN:return wP.Eval_tan(e);case b.TANH:return LP.Eval_tanh(e);case b.TAYLOR:return CP.Eval_taylor(e);case b.TEST:return ks.Eval_test(e);case b.TESTEQ:return ks.Eval_testeq(e);case b.TESTGE:return ks.Eval_testge(e);case b.TESTGT:return ks.Eval_testgt(e);case b.TESTLE:return ks.Eval_testle(e);case b.TESTLT:return ks.Eval_testlt(e);case b.TRANSPOSE:return kP.Eval_transpose(e);case b.UNIT:return dD(e);case b.ZERO:return PP.Eval_zero(e);default:return x1.Eval_user_function(e)}}function UP(e){Pe.push(ka.get_binding(b.cadr(e)))}function BP(e){let t=Ff.isZeroLikeOrNonZeroLikeOrUndetermined(b.cadr(e));t==null?Pe.push(e):Xi.push_integer(Number(t))}function GP(e){let t=je(b.cadr(e));Pe.push(U3.det(t))}function FP(e){let t=je(b.cadr(e)),r=b.iscons(b.cddr(e))?fb(b.caddr(e)):1;b.istensor(t)?r<1||r>t.tensor.ndim?Pe.push(e):Xi.push_integer(t.tensor.dim[r-1]):Pe.push(b.Constants.one)}function jP(e){Pe.push(G3.divisors(je(b.cadr(e))))}function zP(e){for(Pe.push(b.car(e)),e=b.cdr(e);b.iscons(e);)Pe.pop(),Pe.push(je(b.car(e))),e=b.cdr(e)}function YP(e){let t=je(b.cadr(e));for(e=b.cddr(e);b.iscons(e);)t=q1.subst(t,je(b.car(e)),je(b.cadr(e))),e=b.cddr(e);Pe.push(je(t))}function VP(e){Pe.push(l3.exponential(je(b.cadr(e))))}function ZP(e){Pe.push(X3.factorial(je(b.cadr(e))))}function XP(e){e=b.cdr(e);let t=je(b.car(e));e=b.cdr(e);let r=je(b.car(e)),n=g1.factorpoly(t,r);b.iscons(e)&&(n=e.tail().reduce((s,i)=>g1.factorpoly(s,je(i)),n)),Pe.push(n)}function HP(e){let t=je(b.caddr(e)),r=je(b.cadr(e));Pe.push(tP.hermite(r,t))}function QP(e){Pe.push(rP.hilbert(je(b.cadr(e))))}function WP(e){let t=JP(e);Pe.push(t)}function JP(e){let t=e;e=b.cdr(e);let r=je(b.car(e));if(b.isNumericAtom(r)&&ui.stop("trying to access a scalar as a tensor"),!b.istensor(r))return t;let n=[r];for(e=b.cdr(e);b.iscons(e);){if(n.push(je(b.car(e))),!Ff.isintegerorintegerfloat(n[n.length-1]))return t;e=b.cdr(e)}return m1.index_function(n)}function KP(e){let t=je(b.cadr(e));Pe.push(v1.inv(t))}function eD(e){let t=je(b.cadr(e));Pe.push(v1.invg(t))}function tD(e){e=je(b.cadr(e));let t=rD(e);Pe.push(t)}function rD(e){return b.isrational(e)?Ff.isinteger(e)?b.Constants.one:b.Constants.zero:b.isdouble(e)?Math.floor(e.d)===e.d?b.Constants.one:b.Constants.zero:jf.makeList(b.symbol(b.ISINTEGER),e)}function nD(e){e=je(b.cadr(e));let t=e.k===b.NUM||e.k===b.DOUBLE?b.Constants.one:b.Constants.zero;Pe.push(t)}function sD(e){let t=b.iscons(e)?e.tail().map(je):[],r=jf.makeList(b.symbol(b.OPERATOR),...t);Pe.push(r)}function iD(e){Pe.push(b.cadr(e))}function oD(e){e=je(b.cadr(e));let t=b.istensor(e)?Xi.integer(e.tensor.ndim):b.Constants.zero;Pe.push(t)}function aD(e){if(b.caadr(e)===b.symbol(b.INDEX)){lD(e);return}if(b.iscons(b.cadr(e))){b1.define_user_function(e);return}b.issymbol(b.cadr(e))||ui.stop("symbol assignment: error in symbol");let t=je(b.caddr(e));ka.set_binding(b.cadr(e),t),Pe.push(b.symbol(b.NIL))}function lD(e){let t=b.cadadr(e);console.log(`p4: ${t}`),b.issymbol(t)||ui.stop("indexed assignment: expected a symbol name");let r=b.defs.tos;Pe.push(je(b.caddr(e)));let n=b.cdadr(e);b.iscons(n)&&Pe.push_all([...n].map(je)),m1.set_component(b.defs.tos-r);let s=Pe.pop();ka.set_binding(t,s),Pe.push(b.symbol(b.NIL))}function uD(e){let t=je(b.cadr(e));Pe.push(p1.power(t,Xi.rational(1,2)))}function cD(){ui.stop("user stop")}function fD(e){let t=je(b.cadr(e)),r=je(b.caddr(e)),n=je(b.cadddr(e));Pe.push(je(q1.subst(n,r,t)))}function dD(e){let t=fb(b.cadr(e));if(isNaN(t)){Pe.push(e);return}if(t<1){Pe.push(e);return}e=a3.alloc_tensor(t*t),e.tensor.ndim=2,e.tensor.dim[0]=t,e.tensor.dim[1]=t;for(let r=0;r<t;r++)e.tensor.elem[t*r+r]=b.Constants.one;E1.check_tensor_dimensions(e),Pe.push(e)}function mD(e){return b.car(e)===b.symbol(b.SETQ)&&(e=jf.makeList(b.symbol(b.TESTEQ),b.cadr(e),b.caddr(e))),je(e)}ci.Eval_predicate=mD});var ge=N(Xn=>{"use strict";Object.defineProperty(Xn,"__esModule",{value:!0});Xn.subtract=Xn.add_all=Xn.add=Xn.Eval_add=void 0;var le=w(),_D=Oe(),bD=B(),h1=Re(),A1=Z(),gD=j(),db=se(),yD=oe(),O1=ee(),vD=Nn(),pD=Et(),ru=0;function qD(e){let t=[];e=le.cdr(e);for(let r of e){let n=gD.Eval(r);Yf(t,n)}bD.push(mb(t))}Xn.Eval_add=qD;function mb(e){if(le.DEBUG)for(let t of e)console.log(vD.print_list(t));for(let t=0;t<10&&!(e.length<2||(ru=0,e.sort(xD),ru===0));t++)hD(e);switch(e.length){case 0:return le.Constants.Zero();case 1:return e[0];default:return e.unshift(le.symbol(le.ADD)),yD.makeList(...e)}}var ED=0;function xD(e,t){if(ED++,le.isNumericAtom(e)&&le.isNumericAtom(t))return ru=1,0;if(le.istensor(e)&&le.istensor(t)){if(e.tensor.ndim<t.tensor.ndim)return-1;if(e.tensor.ndim>t.tensor.ndim)return 1;for(let n=0;n<e.tensor.ndim;n++){if(e.tensor.dim[n]<t.tensor.dim[n])return-1;if(e.tensor.dim[n]>t.tensor.dim[n])return 1}return ru=1,0}le.ismultiply(e)&&(e=le.cdr(e),le.isNumericAtom(le.car(e))&&(e=le.cdr(e),le.cdr(e)===le.symbol(le.NIL)&&(e=le.car(e)))),le.ismultiply(t)&&(t=le.cdr(t),le.isNumericAtom(le.car(t))&&(t=le.cdr(t),le.cdr(t)===le.symbol(le.NIL)&&(t=le.car(t))));let r=h1.cmp_expr(e,t);return r===0&&(ru=1),r}function hD(e){let t=0;for(;t<e.length-1;){_D.check_esc_flag();let r,n,s=e[t],i=e[t+1];if(le.istensor(s)&&le.istensor(i)){r=pD.tensor_plus_tensor(s,i),r!==le.symbol(le.NIL)&&(e.splice(t,2,r),t--),t++;continue}if(le.istensor(s)||le.istensor(i)){t++;continue}if(le.isNumericAtom(s)&&le.isNumericAtom(i)){r=A1.add_numbers(s,i),db.isZeroAtomOrTensor(r)?e.splice(t,2):e.splice(t,2,r),t--,t++;continue}if(le.isNumericAtom(s)||le.isNumericAtom(i)){t++;continue}r=le.Constants.One(),n=le.Constants.One();let l=0;if(le.ismultiply(s)&&(s=le.cdr(s),l=1,le.isNumericAtom(le.car(s))&&(r=le.car(s),s=le.cdr(s),le.cdr(s)===le.symbol(le.NIL)&&(s=le.car(s),l=0))),le.ismultiply(i)&&(i=le.cdr(i),le.isNumericAtom(le.car(i))&&(n=le.car(i),i=le.cdr(i),le.cdr(i)===le.symbol(le.NIL)&&(i=le.car(i)))),!h1.equal(s,i)){t++;continue}if(r=A1.add_numbers(r,n),db.isZeroAtomOrTensor(r)){e.splice(t,2),t--,t++;continue}let u=l?new le.Cons(le.symbol(le.MULTIPLY),s):s;e.splice(t,2,O1.multiply(r,u)),t--,t++}}function Yf(e,t){le.isadd(t)?e.push(...t.tail()):db.isZeroAtom(t)||e.push(t)}function T1(e,t){let r=[];return Yf(r,e),Yf(r,t),mb(r)}Xn.add=T1;function AD(e){let t=[];for(let r of e)Yf(t,r);return mb(t)}Xn.add_all=AD;function OD(e,t){return T1(e,O1.negate(t))}Xn.subtract=OD});var Et=N(pt=>{"use strict";Object.defineProperty(pt,"__esModule",{value:!0});pt.copy_tensor=pt.power_tensor=pt.compare_tensors=pt.d_tensor_scalar=pt.d_scalar_tensor=pt.d_tensor_tensor=pt.is_square_matrix=pt.check_tensor_dimensions=pt.scalar_times_tensor=pt.tensor_times_scalar=pt.tensor_plus_tensor=pt.Eval_tensor=void 0;var Hn=Pt(),Gt=w(),_b=Oe(),TD=B(),M1=Re(),MD=ge(),ND=Z(),bb=$i(),ID=j(),SD=Ks(),RD=Sl(),wD=se(),gb=oe(),N1=ee();function LD(e){Qn(e);let{nelem:t,ndim:r}=e.tensor,n=Hn.alloc_tensor(t);n.tensor.ndim=r,n.tensor.dim=Array.from(e.tensor.dim),Qn(n),n.tensor.elem=e.tensor.elem.map(s=>ID.Eval(s)),Qn(e),Qn(n),TD.push(zD(n))}pt.Eval_tensor=LD;function CD(e,t){if(e.tensor.ndim!==t.tensor.ndim||e.tensor.dim.some((c,d)=>c!==t.tensor.dim[d]))return Gt.symbol(Gt.NIL);let{nelem:r,ndim:n}=e.tensor,s=Hn.alloc_tensor(r);s.tensor.ndim=n,s.tensor.dim=Array.from(e.tensor.dim);let i=e.tensor.elem,l=t.tensor.elem,u=s.tensor.elem;for(let c=0;c<r;c++)u[c]=MD.add(i[c],l[c]);return s}pt.tensor_plus_tensor=CD;function kD(e,t){let{ndim:r,nelem:n}=e.tensor,s=Hn.alloc_tensor(n);return s.tensor.ndim=r,s.tensor.dim=Array.from(e.tensor.dim),s.tensor.elem=e.tensor.elem.map(i=>N1.multiply(i,t)),s}pt.tensor_times_scalar=kD;function PD(e,t){let{ndim:r,nelem:n}=t.tensor,s=Hn.alloc_tensor(n);return s.tensor.ndim=r,s.tensor.dim=Array.from(t.tensor.dim),s.tensor.elem=t.tensor.elem.map(i=>N1.multiply(e,i)),s}pt.scalar_times_tensor=PD;function Qn(e){if(e.tensor.nelem!==e.tensor.elem.length)return console.log("something wrong in tensor dimensions"),Gt.breakpoint}pt.check_tensor_dimensions=Qn;function DD(e){return Gt.istensor(e)&&e.tensor.ndim===2&&e.tensor.dim[0]===e.tensor.dim[1]}pt.is_square_matrix=DD;function $D(e,t){let{ndim:r,nelem:n}=e.tensor;if(r+1>=Gt.MAXDIM)return gb.makeList(Gt.symbol(Gt.DERIVATIVE),e,t);let s=Hn.alloc_tensor(n*t.tensor.nelem);s.tensor.ndim=r+1,s.tensor.dim=[...e.tensor.dim,t.tensor.dim[0]];let i=e.tensor.elem,l=t.tensor.elem,u=s.tensor.elem;for(let c=0;c<n;c++)for(let d=0;d<t.tensor.nelem;d++)u[c*t.tensor.nelem+d]=bb.derivative(i[c],l[d]);return s}pt.d_tensor_tensor=$D;function UD(e,t){let r=Hn.alloc_tensor(t.tensor.nelem);return r.tensor.ndim=1,r.tensor.dim[0]=t.tensor.dim[0],r.tensor.elem=t.tensor.elem.map(n=>bb.derivative(e,n)),r}pt.d_scalar_tensor=UD;function BD(e,t){let r=Hn.alloc_tensor(e.tensor.nelem);return r.tensor.ndim=e.tensor.ndim,r.tensor.dim=[...e.tensor.dim],r.tensor.elem=e.tensor.elem.map(n=>bb.derivative(n,t)),r}pt.d_tensor_scalar=BD;function GD(e,t){if(e.tensor.ndim<t.tensor.ndim)return-1;if(e.tensor.ndim>t.tensor.ndim)return 1;for(let r=0;r<e.tensor.ndim;r++){if(e.tensor.dim[r]<t.tensor.dim[r])return-1;if(e.tensor.dim[r]>t.tensor.dim[r])return 1}for(let r=0;r<e.tensor.nelem;r++)if(!M1.equal(e.tensor.elem[r],t.tensor.elem[r]))return M1.lessp(e.tensor.elem[r],t.tensor.elem[r])?-1:1;return 0}pt.compare_tensors=GD;function FD(e,t){let r=e.tensor.ndim-1;if(e.tensor.dim[0]!==e.tensor.dim[r])return gb.makeList(Gt.symbol(Gt.POWER),e,t);let n=ND.nativeInt(t);if(isNaN(n))return gb.makeList(Gt.symbol(Gt.POWER),e,t);if(n===0){e.tensor.ndim!==2&&_b.stop("power(tensor,0) with tensor rank not equal to 2"),n=e.tensor.dim[0],e=Hn.alloc_tensor(n*n),e.tensor.ndim=2,e.tensor.dim[0]=n,e.tensor.dim[1]=n;for(let l=0;l<n;l++)e.tensor.elem[n*l+l]=Gt.Constants.one;return Qn(e),e}let s=e;n<0&&(n=-n,s=RD.inv(s));let i=s;for(let l=1;l<n&&(i=SD.inner(i,s),!wD.isZeroAtomOrTensor(i));l++);return i}pt.power_tensor=FD;function jD(e){let t=Hn.alloc_tensor(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=[...e.tensor.dim],t.tensor.elem=[...e.tensor.elem],Qn(e),Qn(t),t}pt.copy_tensor=jD;function zD(e){if(!Gt.istensor(e))return e;let t=e.tensor.elem[0];if(e.tensor.elem.some(i=>!YD(t,i))&&_b.stop("Cannot promote tensor due to inconsistent tensor components."),!Gt.istensor(t))return e;let r=e.tensor.ndim+t.tensor.ndim;r>Gt.MAXDIM&&_b.stop("tensor rank > "+Gt.MAXDIM);let n=e.tensor.nelem*t.tensor.nelem,s=Hn.alloc_tensor(n);return s.tensor.ndim=r,s.tensor.dim=[...e.tensor.dim,...t.tensor.dim],s.tensor.elem=[].concat(...e.tensor.elem.map(i=>i.tensor.elem)),Qn(t),Qn(s),s}function YD(e,t){if(!Gt.istensor(e)&&!Gt.istensor(t))return!0;if(!Gt.istensor(e)||!Gt.istensor(t)||e.tensor.ndim!==t.tensor.ndim)return!1;for(let r=0;r<e.tensor.ndim;r++)if(e.tensor.dim[r]!==t.tensor.dim[r])return!1;return!0}});var Pt=N(Vf=>{"use strict";Object.defineProperty(Vf,"__esModule",{value:!0});Vf.alloc_tensor=void 0;var VD=Et(),I1=w();function ZD(e){let t=new I1.Tensor;for(let r=0;r<e;r++)t.tensor.elem[r]=I1.Constants.zero;return VD.check_tensor_dimensions(t),t}Vf.alloc_tensor=ZD});var Re=N(qt=>{"use strict";Object.defineProperty(qt,"__esModule",{value:!0});qt.sort=qt.sort_stack=qt.square=qt.exponential=qt.yyexpand=qt.length=qt.cmp_expr=qt.sign=qt.lessp=qt.equal=qt.zero_matrix=qt.new_string=void 0;var XD=Pt(),Ge=w(),S1=cs(),HD=B(),R1=dt(),w1=Z(),QD=j(),L1=Ot(),WD=Et();function JD(e){HD.push(new Ge.Str(e.toString()))}qt.new_string=JD;function KD(e,t){let r=XD.alloc_tensor(e*t);return r.ndim=2,r.dim[0]=e,r.dim[1]=t,r}qt.zero_matrix=KD;function e$(e,t){return Da(e,t)===0}qt.equal=e$;function t$(e,t){return Da(e,t)<0}qt.lessp=t$;function Zf(e){return e<0?-1:e>0?1:0}qt.sign=Zf;function Da(e,t){let r=0;if(e===t)return 0;if(e===Ge.symbol(Ge.NIL))return-1;if(t===Ge.symbol(Ge.NIL))return 1;if(Ge.isNumericAtom(e)&&Ge.isNumericAtom(t))return Zf(w1.compare_numbers(e,t));if(Ge.isNumericAtom(e))return-1;if(Ge.isNumericAtom(t))return 1;if(Ge.isstr(e)&&Ge.isstr(t))return Zf(S1.strcmp(e.str,t.str));if(Ge.isstr(e))return-1;if(Ge.isstr(t))return 1;if(Ge.issymbol(e)&&Ge.issymbol(t))return Zf(S1.strcmp(R1.get_printname(e),R1.get_printname(t)));if(Ge.issymbol(e))return-1;if(Ge.issymbol(t))return 1;if(Ge.istensor(e)&&Ge.istensor(t))return WD.compare_tensors(e,t);if(Ge.istensor(e))return-1;if(Ge.istensor(t))return 1;for(;Ge.iscons(e)&&Ge.iscons(t);){if(r=Da(Ge.car(e),Ge.car(t)),r!==0)return r;e=Ge.cdr(e),t=Ge.cdr(t)}return Ge.iscons(t)?-1:Ge.iscons(e)?1:0}qt.cmp_expr=Da;function r$(e){return Ge.iscons(e)?[...e].length:0}qt.length=r$;function n$(e){return Ge.doexpand(QD.Eval,e)}qt.yyexpand=n$;function s$(e){return L1.power(Ge.symbol(Ge.E),e)}qt.exponential=s$;function i$(e){return L1.power(e,w1.integer(2))}qt.square=i$;function o$(e){let t=Ge.defs.tos-e,r=Ge.defs.stack.slice(t,t+e);r.sort(Da),Ge.defs.stack=Ge.defs.stack.slice(0,t).concat(r).concat(Ge.defs.stack.slice(t+e))}qt.sort_stack=o$;function a$(e){e.sort(Da)}qt.sort=a$});var br=N(fi=>{"use strict";Object.defineProperty(fi,"__esModule",{value:!0});fi.findPossibleExponentialForm=fi.findPossibleClockForm=fi.Find=void 0;var Xf=se(),l$=Re(),nr=w();function nu(e,t){if(l$.equal(e,t))return!0;if(nr.istensor(e)){for(let r=0;r<e.tensor.nelem;r++)if(nu(e.tensor.elem[r],t))return!0;return!1}return nr.iscons(e)?[...e].some(r=>nu(r,t)):!1}fi.Find=nu;function yb(e,t){if(Xf.isimaginaryunit(e))return!1;if(nr.ispower(e)&&!Xf.isinteger(nr.caddr(t))&&nu(nr.cadr(e),nr.Constants.imaginaryunit)||nr.ispower(e)&&Xf.equaln(nr.cadr(e),-1)&&!Xf.isinteger(nr.caddr(t)))return!0;if(nr.istensor(e)){for(let r=0;r<e.tensor.nelem;r++)if(yb(e.tensor.elem[r],t))return!0;return!1}return nr.iscons(e)?[...e].some(r=>yb(r,t)):!1}fi.findPossibleClockForm=yb;function vb(e){if(nr.ispower(e)&&nr.cadr(e)===nr.symbol(nr.E))return nu(nr.caddr(e),nr.Constants.imaginaryunit);if(nr.istensor(e)){for(let t=0;t<e.tensor.nelem;t++)if(vb(e.tensor.elem[t]))return!0;return!1}return nr.iscons(e)?[...e].some(vb):!1}fi.findPossibleExponentialForm=vb});var se=N(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.isnpi=Q.isquarterturn=Q.isimaginaryunit=Q.isfloating=Q.isMinusSqrtThreeOverTwo=Q.isSqrtThreeOverTwo=Q.isminusoneoversqrttwo=Q.isoneoversqrttwo=Q.isminusoneovertwo=Q.isoneovertwo=Q.equalq=Q.equaln=Q.isfraction=Q.isoneover=Q.isNumberOneOverSomething=Q.isintegerfactor=Q.issymbolic=Q.isnegative=Q.iseveninteger=Q.iscomplexnumber=Q.iscomplexnumberdouble=Q.isimaginarynumber=Q.isnegativeterm=Q.ispolyexpandedform=Q.isunivarpolyfactoredorexpandedform=Q.isposint=Q.isnonnegativeinteger=Q.isintegerorintegerfloat=Q.isinteger=Q.isone=Q.isminusone=Q.isplusone=Q.isplustwo=Q.ispositivenumber=Q.isnegativenumber=Q.isZeroLikeOrNonZeroLikeOrUndetermined=Q.isZeroAtomOrTensor=Q.isZeroAtom=void 0;var T=w(),$a=br(),dr=Re(),u$=dn(),Hf=Z(),C1=j(),c$=kn(),f$=tn(),k1=ee(),su=!1;function P1(e){switch(e.k){case T.NUM:if(T.MZERO(e.q.a))return!0;break;case T.DOUBLE:if(e.d===0)return!0;break}return!1}Q.isZeroAtom=P1;function d$(e){return T.istensor(e)?e.tensor.elem.every(t=>iu(t)):!1}function iu(e){return P1(e)||d$(e)}Q.isZeroAtomOrTensor=iu;function m$(e){let t=C1.Eval_predicate(e);if(iu(t))return!1;if(T.isNumericAtomOrTensor(t))return!0;if(t=c$.zzfloat(t),iu(t))return!1;if(T.isNumericAtomOrTensor(t))return!0;if($a.Find(t,T.Constants.imaginaryunit)){if(t=C1.Eval_predicate(u$.absValFloat(t)),iu(t))return!1;if(T.isNumericAtomOrTensor(t))return!0}return null}Q.isZeroLikeOrNonZeroLikeOrUndetermined=m$;function Qf(e){switch(e.k){case T.NUM:if(T.MSIGN(e.q.a)===-1)return!0;break;case T.DOUBLE:if(e.d<0)return!0;break}return!1}Q.isnegativenumber=Qf;function _$(e){switch(e.k){case T.NUM:if(T.MSIGN(e.q.a)===1)return!0;break;case T.DOUBLE:if(e.d>0)return!0;break}return!1}Q.ispositivenumber=_$;function b$(e){switch(e.k){case T.NUM:if(T.MEQUAL(e.q.a,2)&&T.MEQUAL(e.q.b,1))return!0;break;case T.DOUBLE:if(e.d===2)return!0;break}return!1}Q.isplustwo=b$;function D1(e){switch(e.k){case T.NUM:if(T.MEQUAL(e.q.a,1)&&T.MEQUAL(e.q.b,1))return!0;break;case T.DOUBLE:if(e.d===1)return!0;break}return!1}Q.isplusone=D1;function pb(e){switch(e.k){case T.NUM:if(T.MEQUAL(e.q.a,-1)&&T.MEQUAL(e.q.b,1))return!0;break;case T.DOUBLE:if(e.d===-1)return!0;break}return!1}Q.isminusone=pb;function g$(e){return D1(e)||pb(e)}Q.isone=g$;function Hi(e){return e.k===T.NUM&&T.MEQUAL(e.q.b,1)}Q.isinteger=Hi;function y$(e){return e.k===T.DOUBLE?e.d===Math.round(e.d):Hi(e)}Q.isintegerorintegerfloat=y$;function v$(e){return T.isrational(e)&&T.MEQUAL(e.q.b,1)&&T.MSIGN(e.q.a)===1}Q.isnonnegativeinteger=v$;function Wf(e){return Hi(e)&&T.MSIGN(e.q.a)===1}Q.isposint=Wf;function p$(e,t){if(t==null&&(t=f$.guess(e)),E$(e,t)&&q$($a.Find(e,T.symbol(T.SYMBOL_X)),$a.Find(e,T.symbol(T.SYMBOL_Y)),$a.Find(e,T.symbol(T.SYMBOL_Z)))===1)return t}Q.isunivarpolyfactoredorexpandedform=p$;function q$(...e){return e.reduce((t,r)=>t+Number(r),0)}function E$(e,t){return x$(e,t)}function x$(e,t){return T.ismultiply(e)?e.tail().every(r=>{let n=$1(r,t);return T.DEBUG&&(console.log(`ispolyfactoredorexpandedform_factor testing ${r}`),n&&console.log(`... tested negative:${r}`)),n}):$1(e,t)}function $1(e,t){return T.ispower(e)?(T.DEBUG&&console.log("ispolyfactoredorexpandedform_power (isposint(caddr(p)) "+(Wf(T.caddr(e)),T.DEBUG?console.log("ispolyfactoredorexpandedform_power ispolyexpandedform_expr(cadr(p), x)) "+Jf(T.cadr(e),t)):void 0)),Wf(T.caddr(e))&&Jf(T.cadr(e),t)):(T.DEBUG&&console.log(`ispolyfactoredorexpandedform_power not a power, testing if this is exp form: ${e}`),Jf(e,t))}function h$(e,t){return $a.Find(e,t)?Jf(e,t):!1}Q.ispolyexpandedform=h$;function Jf(e,t){return T.isadd(e)?e.tail().every(r=>U1(r,t)):U1(e,t)}function U1(e,t){return T.ismultiply(e)?e.tail().every(r=>B1(r,t)):B1(e,t)}function B1(e,t){return dr.equal(e,t)?!0:T.ispower(e)&&dr.equal(T.cadr(e),t)?Wf(T.caddr(e)):!$a.Find(e,t)}function qb(e){return Qf(e)||T.ismultiply(e)&&Qf(T.cadr(e))}Q.isnegativeterm=qb;function G1(e){return T.ispower(e)&&T.isrational(T.car(T.cdr(T.cdr(e))))&&Qf(T.car(T.cdr(e)))?(su&&console.log(`hasNegativeRationalExponent: ${e} has imaginary component`),!0):(su&&console.log(`hasNegativeRationalExponent: ${e} has NO imaginary component`),!1)}function F1(e){return T.ismultiply(e)&&dr.length(e)===3&&T.isdouble(T.cadr(e))&&G1(T.caddr(e))||dr.equal(e,T.Constants.imaginaryunit)}function Eb(e){return T.ismultiply(e)&&dr.length(e)===3&&T.isNumericAtom(T.cadr(e))&&dr.equal(T.caddr(e),T.Constants.imaginaryunit)||dr.equal(e,T.Constants.imaginaryunit)||G1(T.caddr(e))?(su&&console.log(`isimaginarynumber: ${e} is imaginary number`),!0):(su&&console.log(`isimaginarynumber: ${e} isn't an imaginary number`),!1)}Q.isimaginarynumber=Eb;function A$(e){return T.isadd(e)&&dr.length(e)===3&&T.isdouble(T.cadr(e))&&F1(T.caddr(e))||F1(e)}Q.iscomplexnumberdouble=A$;function O$(e){return su&&T.breakpoint,T.isadd(e)&&dr.length(e)===3&&T.isNumericAtom(T.cadr(e))&&Eb(T.caddr(e))||Eb(e)?(T.DEBUG&&console.log(`iscomplexnumber: ${e} is imaginary number`),!0):(T.DEBUG&&console.log(`iscomplexnumber: ${e} is imaginary number`),!1)}Q.iscomplexnumber=O$;function T$(e){return Hi(e)&&e.q.a.isEven()}Q.iseveninteger=T$;function M$(e){return T.isadd(e)&&qb(T.cadr(e))||qb(e)}Q.isnegative=M$;function j1(e){return T.issymbol(e)?!0:T.iscons(e)?[...e].some(j1):!1}Q.issymbolic=j1;function N$(e){return Hi(e)||T.ispower(e)&&Hi(T.cadr(e))&&Hi(T.caddr(e))}Q.isintegerfactor=N$;function I$(e){return z1(e)&&T.MEQUAL(e.q.a.abs(),1)}Q.isNumberOneOverSomething=I$;function S$(e){return T.ispower(e)&&pb(T.caddr(e))}Q.isoneover=S$;function z1(e){return e.k===T.NUM&&!T.MEQUAL(e.q.b,1)}Q.isfraction=z1;function Kf(e,t){switch(e.k){case T.NUM:return T.MEQUAL(e.q.a,t)&&T.MEQUAL(e.q.b,1);case T.DOUBLE:return e.d===t;default:return!1}}Q.equaln=Kf;function ed(e,t,r){switch(e.k){case T.NUM:return T.MEQUAL(e.q.a,t)&&T.MEQUAL(e.q.b,r);case T.DOUBLE:return e.d===t/r;default:return!1}}Q.equalq=ed;function xb(e){return ed(e,1,2)}Q.isoneovertwo=xb;function Y1(e){return ed(e,-1,2)}Q.isminusoneovertwo=Y1;function V1(e){return T.ispower(e)&&Kf(T.cadr(e),2)&&ed(T.caddr(e),-1,2)}Q.isoneoversqrttwo=V1;function R$(e){return T.ismultiply(e)&&Kf(T.cadr(e),-1)&&V1(T.caddr(e))&&dr.length(e)===3}Q.isminusoneoversqrttwo=R$;function w$(e){return T.ismultiply(e)&&xb(T.cadr(e))&&Z1(T.caddr(e))&&dr.length(e)===3}Q.isSqrtThreeOverTwo=w$;function L$(e){return T.ismultiply(e)&&Y1(T.cadr(e))&&Z1(T.caddr(e))&&dr.length(e)===3}Q.isMinusSqrtThreeOverTwo=L$;function Z1(e){return T.ispower(e)&&Kf(T.cadr(e),3)&&xb(T.caddr(e))}function X1(e){return e.k===T.DOUBLE||e===T.symbol(T.FLOATF)?!0:T.iscons(e)?[...e].some(X1):!1}Q.isfloating=X1;function C$(e){return dr.equal(e,T.Constants.imaginaryunit)}Q.isimaginaryunit=C$;function k$(e){let t=0;if(!T.ismultiply(e))return 0;if(dr.equal(T.cadr(e),T.Constants.imaginaryunit))return T.caddr(e)!==T.symbol(T.PI)||dr.length(e)!==3?0:2;if(!T.isNumericAtom(T.cadr(e))||!dr.equal(T.caddr(e),T.Constants.imaginaryunit)||T.cadddr(e)!==T.symbol(T.PI)||dr.length(e)!==4)return 0;let r=Hf.nativeInt(k1.multiply(T.cadr(e),Hf.integer(2)));if(isNaN(r))return 0;switch(r<1&&(t=1,r=-r),r%4){case 0:r=1;break;case 1:r=t?4:3;break;case 2:r=2;break;case 3:r=t?3:4}return r}Q.isquarterturn=k$;function P$(e){let t=0;return e===T.symbol(T.PI)?2:!T.ismultiply(e)||!T.isNumericAtom(T.cadr(e))||T.caddr(e)!==T.symbol(T.PI)||dr.length(e)!==3||(t=Hf.nativeInt(k1.multiply(T.cadr(e),Hf.integer(2))),isNaN(t))?0:(t<0?t=4- -t%4:t=1+(t-1)%4,t)}Q.isnpi=P$});var cs=N(Rt=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.yn=Rt.jn=Rt.append=Rt.__range__=Rt.isalnumorunderscore=Rt.isalpha=Rt.isdigit=Rt.isspace=Rt.clear_term=Rt.doubleToReasonableString=Rt.strcmp=void 0;var H1=Oe(),D$=Z(),$$=se(),Wn=w(),Q1=dt(),U$=oe();function B$(e,t){return e===t?0:e>t?1:-1}Rt.strcmp=B$;function G$(e){let t;if(Wn.defs.codeGen||Wn.defs.fullDoubleOutput)return""+e;if($$.isZeroAtomOrTensor(Q1.get_binding(Wn.symbol(Wn.FORCE_FIXED_PRINTOUT))))t=""+e,Wn.defs.printMode===Wn.PRINTMODE_LATEX?/\d*\.\d*e.*/gm.test(t)?t=t.replace(/e(.*)/gm,"\\mathrm{e}{$1}"):t=t.replace(/(\d+)e(.*)/gm,"$1.0\\mathrm{e}{$2}"):/\d*\.\d*e.*/gm.test(t)?t=t.replace(/e(.*)/gm,"*10^($1)"):t=t.replace(/(\d+)e(.*)/gm,"$1.0*10^($2)");else{let r=D$.nativeInt(Q1.get_binding(Wn.symbol(Wn.MAX_FIXED_PRINTOUT_DIGITS)));t=""+e.toFixed(r),t=t.replace(/(\.\d*?[1-9])0+$/gm,"$1"),t=t.replace(/\.0+$/gm,""),t.indexOf(".")===-1&&(t+=".0"),parseFloat(t)!==e&&(t=e.toFixed(r)+"...")}return t}Rt.doubleToReasonableString=G$;function F$(){}Rt.clear_term=F$;function j$(e){return e==null?!1:e===" "||e==="	"||e===`
`||e==="\v"||e==="\f"||e==="\r"}Rt.isspace=j$;function W1(e){return e==null?!1:/^\d+$/.test(e)}Rt.isdigit=W1;function z$(e){return e==null?!1:e.search(/[^A-Za-z]/)===-1}Rt.isalpha=z$;function Y$(e){return e==null?!1:e.search(/[^A-Za-z_]/)===-1}function V$(e){return e==null?!1:Y$(e)||W1(e)}Rt.isalnumorunderscore=V$;function Z$(e,t,r){let n=[],s=e<t,i=r?s?t+1:t-1:t;for(let l=e;s?l<i:l>i;s?l++:l--)n.push(l);return n}Rt.__range__=Z$;function X$(e,t){let r=[];return Wn.iscons(e)&&r.push(...e),Wn.iscons(t)&&r.push(...t),U$.makeList(...r)}Rt.append=X$;function H$(e,t){H1.stop("Not implemented")}Rt.jn=H$;function Q$(e,t){H1.stop("Not implemented")}Rt.yn=Q$});var J1=N(td=>{"use strict";Object.defineProperty(td,"__esModule",{value:!0});td.qadd=void 0;var hb=w(),W$=Z(),J$=fm(),K$=Do(),ou=_n();function eU(e,t){let r=ou.mmul(e.q.a,t.q.b),n=ou.mmul(e.q.b,t.q.a),s=J$.madd(r,n);if(hb.MZERO(s))return hb.Constants.zero;let i=ou.mmul(e.q.b,t.q.b),l=K$.mgcd(s,i);l=W$.makeSignSameAs(l,i);let u=ou.mdiv(s,l),c=ou.mdiv(i,l);return new hb.Num(u,c)}td.qadd=eU});var K1=N(sd=>{"use strict";Object.defineProperty(sd,"__esModule",{value:!0});sd.qdiv=void 0;var rd=w(),tU=Oe(),rU=Z(),nU=Do(),nd=_n();function sU(e,t){if(rd.MZERO(t.q.a)&&tU.stop("divide by zero"),rd.MZERO(e.q.a))return rd.Constants.zero;let r=nd.mmul(e.q.a,t.q.b),n=nd.mmul(e.q.b,t.q.a),s=nU.mgcd(r,n);return s=rU.makeSignSameAs(s,n),new rd.Num(nd.mdiv(r,s),nd.mdiv(n,s))}sd.qdiv=sU});var eE=N(ad=>{"use strict";Object.defineProperty(ad,"__esModule",{value:!0});ad.qmul=void 0;var id=w(),iU=Z(),oU=Do(),od=_n();function aU(e,t){if(id.MZERO(e.q.a)||id.MZERO(t.q.a))return id.Constants.zero;let r=od.mmul(e.q.a,t.q.a),n=od.mmul(e.q.b,t.q.b),s=oU.mgcd(r,n);return s=iU.makeSignSameAs(s,n),new id.Num(od.mdiv(r,s),od.mdiv(n,s))}ad.qmul=aU});var Z=N(re=>{"use strict";var lU=re&&re.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(re,"__esModule",{value:!0});re.bignum_factorial=re.bignum_float=re.pop_number=re.nativeDouble=re.pop_double=re.gcd_numbers=re.print_number=re.bignum_scan_float=re.bignum_scan_integer=re.nativeInt=re.pop_integer=re.rational=re.push_rational=re.double=re.push_double=re.integer=re.push_integer=re.convert_rational_to_double=re.bignum_power_number=re.mp_denominator=re.mp_numerator=re.bignum_truncate=re.negate_number=re.compare_numbers=re.invert_number=re.divide_numbers=re.multiply_numbers=re.add_numbers=re.makePositive=re.makeSignSameAs=re.setSignTo=re.isSmall=re.mint=void 0;var Zt=lU(Ps()),me=w(),uU=vu(),cU=cs(),ld=Oe(),Qi=B(),Ua=se(),tE=Do(),ud=_n(),rE=Nu(),fU=ee(),dU=J1(),mU=K1(),_U=eE();function bU(e){return Zt.default(e)}re.mint=bU;function nE(e){return e.geq(Number.MIN_SAFE_INTEGER)&&e.leq(Number.MAX_SAFE_INTEGER)}re.isSmall=nE;function cd(e,t){if(e.isPositive()){if(t<0)return e.multiply(Zt.default(-1))}else if(t>0)return e.multiply(Zt.default(-1));return e}re.setSignTo=cd;function Ab(e,t){if(e.isPositive()){if(t.isNegative())return e.multiply(Zt.default(-1))}else if(t.isPositive())return e.multiply(Zt.default(-1));return e}re.makeSignSameAs=Ab;function gU(e){return e.isNegative()?e.multiply(Zt.default(-1)):e}re.makePositive=gU;function yU(e,t){if(me.isrational(e)&&me.isrational(t))return dU.qadd(e,t);let r=me.isdouble(e)?e.d:hn(e),n=me.isdouble(t)?t.d:hn(t);return Ob(r+n)}re.add_numbers=yU;function vU(e,t){if(me.isrational(e)&&me.isrational(t))return _U.qmul(e,t);let r=me.isdouble(e)?e.d:hn(e),n=me.isdouble(t)?t.d:hn(t);return new me.Double(r*n)}re.multiply_numbers=vU;function pU(e,t){if(me.isrational(e)&&me.isrational(t))return mU.qdiv(e,t);Ua.isZeroAtomOrTensor(t)&&ld.stop("divide by zero");let r=me.isdouble(e)?e.d:hn(e),n=me.isdouble(t)?t.d:hn(t);return new me.Double(r/n)}re.divide_numbers=pU;function qU(e){if(Ua.isZeroAtomOrTensor(e)&&ld.stop("divide by zero"),me.isdouble(e))return new me.Double(1/e.d);let t=Zt.default(e.q.a),r=Zt.default(e.q.b);return r=Ab(r,t),t=cd(t,1),new me.Num(r,t)}re.invert_number=qU;function EU(e,t){let r=ud.mmul(e.q.a,t.q.b),n=ud.mmul(e.q.b,t.q.a);return uU.mcmp(r,n)}function xU(e,t){if(me.isrational(e)&&me.isrational(t))return EU(e,t);let r=me.isdouble(e)?e.d:hn(e),n=me.isdouble(t)?t.d:hn(t);return r<n?-1:r>n?1:0}re.compare_numbers=xU;function hU(e){if(Ua.isZeroAtomOrTensor(e))return e;switch(e.k){case me.NUM:return new me.Num(Zt.default(e.q.a.multiply(Zt.default.minusOne)),Zt.default(e.q.b));case me.DOUBLE:return new me.Double(-e.d);default:ld.stop("bug caught in mp_negate_number")}}re.negate_number=hU;function AU(e){let t=ud.mdiv(e.q.a,e.q.b);return new me.Num(t)}re.bignum_truncate=AU;function OU(e){return me.isrational(e)?new me.Num(Zt.default(e.q.a)):me.Constants.one}re.mp_numerator=OU;function TU(e){return me.isrational(e)?new me.Num(Zt.default(e.q.b)):me.Constants.one}re.mp_denominator=TU;function MU(e,t){let r=rE.mpow(e.q.a,Math.abs(t)),n=rE.mpow(e.q.b,Math.abs(t));if(t<0){let s=r;r=n,n=s,r=Ab(r,n),n=cd(n,1)}return new me.Num(r,n)}re.bignum_power_number=MU;function hn(e){e.q==null&&me.breakpoint;let t=e.q.a.divmod(e.q.b);return t.quotient.toJSNumber()+t.remainder.toJSNumber()/e.q.b.toJSNumber()}re.convert_rational_to_double=hn;function NU(e){me.DEBUG&&console.log(`pushing integer ${e}`),Qi.push(sE(e))}re.push_integer=NU;function sE(e){return new me.Num(Zt.default(e))}re.integer=sE;function iE(e){Qi.push(Ob(e))}re.push_double=iE;function Ob(e){return new me.Double(e)}re.double=Ob;function IU(e,t){Qi.push(oE(e,t))}re.push_rational=IU;function oE(e,t){return new me.Num(Zt.default(e),Zt.default(t))}re.rational=oE;function SU(){let e=Qi.pop();return aE(e)}re.pop_integer=SU;function aE(e){let t=NaN;switch(e.k){case me.NUM:Ua.isinteger(e)&&nE(e.q.a)&&(t=e.q.a.toJSNumber());break;case me.DOUBLE:me.DEBUG&&console.log("popping integer but double is found"),Math.floor(e.d)===e.d&&(me.DEBUG&&console.log("...although it's an integer"),t=e.d);break}return t}re.nativeInt=aE;function RU(e){let t=0,r=e[t];(r==="+"||r==="-")&&t++;let n=Zt.default(e.substring(t)),s=new me.Num(n);r==="-"&&(s=fU.negate(s)),Qi.push(s)}re.bignum_scan_integer=RU;function wU(e){iE(parseFloat(e))}re.bignum_scan_float=wU;function LU(e,t){let r="",n="",s="";switch(e.k){case me.NUM:var i=e.q.a.toString();t||i[0]==="-"&&(i=i.substring(1)),me.defs.printMode===me.PRINTMODE_LATEX&&Ua.isfraction(e)&&(i="\\frac{"+i+"}{"),r+=i,Ua.isfraction(e)&&(me.defs.printMode!==me.PRINTMODE_LATEX&&(r+="/"),n=e.q.b.toString(),me.defs.printMode===me.PRINTMODE_LATEX&&(n+="}"),r+=n);break;case me.DOUBLE:i=cU.doubleToReasonableString(e.d),t||i[0]==="-"&&(i=i.substring(1)),r+=i;break}return r}re.print_number=LU;function CU(e,t){let r=tE.mgcd(e.q.a,t.q.a),n=tE.mgcd(e.q.b,t.q.b);return new me.Num(cd(r,1),n)}re.gcd_numbers=CU;function kU(){let e=Qi.pop();return lE(e)}re.pop_double=kU;function lE(e){let t=0;switch(e.k){case me.NUM:t=hn(e);break;case me.DOUBLE:({d:t}=e);break;default:t=0}return t}re.nativeDouble=lE;function PU(){let e=Qi.pop();return me.isNumericAtom(e)||ld.stop("not a number"),e}re.pop_number=PU;function DU(e){let t=hn(e);return new me.Double(t)}re.bignum_float=DU;function $U(e){return new me.Num(UU(e))}re.bignum_factorial=$U;function UU(e){let t;if(e===0||e===1)return t=Zt.default(1),t;t=Zt.default(2);let r=Zt.default(0);if(3<=e)for(let n=3;n<=e;n++)r=Zt.default(n),t=ud.mmul(t,r);return t}});var Bm=N(Ga=>{"use strict";Object.defineProperty(Ga,"__esModule",{value:!0});Ga.polyform=Ga.bake=void 0;var ze=w(),BU=Z(),GU=qi(),di=se(),au=oe();function uE(e){return ze.doexpand(FU,e)}Ga.bake=uE;function FU(e){let t=di.ispolyexpandedform(e,ze.symbol(ze.SYMBOL_S)),r=di.ispolyexpandedform(e,ze.symbol(ze.SYMBOL_T)),n=di.ispolyexpandedform(e,ze.symbol(ze.SYMBOL_X)),s=di.ispolyexpandedform(e,ze.symbol(ze.SYMBOL_Y)),i=di.ispolyexpandedform(e,ze.symbol(ze.SYMBOL_Z)),l;return t&&!r&&!n&&!s&&!i?l=Ba(e,ze.symbol(ze.SYMBOL_S)):!t&&r&&!n&&!s&&!i?l=Ba(e,ze.symbol(ze.SYMBOL_T)):!t&&!r&&n&&!s&&!i?l=Ba(e,ze.symbol(ze.SYMBOL_X)):!t&&!r&&!n&&s&&!i?l=Ba(e,ze.symbol(ze.SYMBOL_Y)):!t&&!r&&!n&&!s&&i?l=Ba(e,ze.symbol(ze.SYMBOL_Z)):ze.iscons(e)&&ze.car(e)!==ze.symbol(ze.FOR)?l=au.makeList(ze.car(e),...e.tail().map(uE)):l=e,l}function cE(e,t){return di.ispolyexpandedform(e,t)?Ba(e,t):ze.iscons(e)?au.makeList(ze.car(e),...e.tail().map(r=>cE(r,t))):e}Ga.polyform=cE;function Ba(e,t){let r=GU.coeff(e,t),n=[];for(let s=r.length-1;s>=0;s--){let i=r[s];n.push(...jU(s,i,t))}return n.length>1?new ze.Cons(ze.symbol(ze.ADD),au.makeList(...n)):n[0]}function jU(e,t,r){if(di.isZeroAtomOrTensor(t))return[];if(e===0)return ze.isadd(t)?t.tail():[t];let n=[];return ze.ismultiply(t)?n.push(...t.tail()):di.equaln(t,1)||n.push(t),e===1?n.push(r):n.push(au.makeList(ze.symbol(ze.POWER),r,BU.integer(e))),n.length>1?[au.makeList(ze.symbol(ze.MULTIPLY),...n)]:n}});var Oe=N(mr=>{"use strict";Object.defineProperty(mr,"__esModule",{value:!0});mr.computeResultsAndJavaScriptFromAlgebra=mr.computeDependenciesFromAlgebra=mr.check_esc_flag=mr.top_level_eval=mr.check_stack=mr.run=mr.findDependenciesInScript=mr.stop=void 0;var wt=B(),zU=Bm(),Tb=g_(),YU=j(),lu=se(),fE=Nn(),VU=jd(),dE=Vs(),ZU=ei(),fd=en(),h=w(),dd=Vl(),Br=dt();function Wi(e){h.defs.errorMessage+="Stop: ",h.defs.errorMessage+=e;let t=h.defs.errorMessage;throw h.defs.errorMessage="",wt.moveTos(0),new Error(t)}mr.stop=Wi;function Mb(e,t=!1){h.DEBUG&&console.log(`stringToBeParsed: ${e}`);let r=new Date().getTime(),n=!0;h.defs.codeGen=!0,h.defs.symbolsDependencies={},h.defs.symbolsHavingReassignments=[],h.defs.symbolsInExpressionsWithoutAssignments=[],h.defs.patternHasBeenFound=!1;let s=0,i="",l="",u=0,c={affectsVariables:[],affectedBy:[]},d=e;for(;;){try{h.defs.errorMessage="",Fa(),h.DEBUG&&console.log("findDependenciesInScript: scanning"),u=dE.scan(e.substring(s)),h.DEBUG&&console.log("scanned"),wt.pop(),Fa()}catch(H){h.PRINTOUTRESULT&&console.log(H),h.defs.errorMessage=H+"",h.reset_after_error();break}if(u===0)break;s+=u}let _="";h.DEBUG&&console.log("all local dependencies ----------------"),_+="All local dependencies: ";for(let H in h.defs.symbolsDependencies){let Se=h.defs.symbolsDependencies[H];h.DEBUG&&console.log(`variable ${H} depends on: `),c.affectsVariables.push(H),_+=" variable "+H+" depends on: ";for(let it of Array.from(Se))h.DEBUG&&console.log(`    ${it}`),it[0]!=="'"&&c.affectedBy.push(it),_+=it+", ";_+="; "}_+=". ",h.DEBUG&&console.log("Symbols with reassignments ----------------"),_+="Symbols with reassignments: ";for(let H of Array.from(h.defs.symbolsHavingReassignments))c.affectedBy.indexOf(H)===-1&&(c.affectedBy.push(H),_+=H+", ");_+=". ",h.DEBUG&&console.log("Symbols in expressions without assignments ----------------"),_+="Symbols in expressions without assignments: ";for(let H of Array.from(h.defs.symbolsInExpressionsWithoutAssignments))c.affectedBy.indexOf(H)===-1&&(c.affectedBy.push(H),_+=H+", ");_+=". ",c.affectedBy.push("PATTERN_DEPENDENCY"),h.defs.patternHasBeenFound&&(c.affectsVariables.push("PATTERN_DEPENDENCY"),_+=" - PATTERN_DEPENDENCY inserted - "),h.DEBUG&&console.log("All dependencies recursively ----------------"),_+="All dependencies recursively: ";let L=["",""],R="",C="";if(h.defs.errorMessage===""&&!t){try{i="",l="",L=_E(e,!0),i="",l=""}catch(H){let Se=H;h.PRINTOUTRESULT&&console.log(Se),h.defs.errorMessage=Se.toString(),dd.init()}if(h.defs.errorMessage==="")for(let H in h.defs.symbolsDependencies){h.defs.codeGen=!0,h.DEBUG&&console.log("  variable "+H+" is: "+Br.get_binding(Br.usr_symbol(H)).toString()),h.defs.codeGen=!1,h.DEBUG&&console.log(`  variable ${H} depends on: `),_+=" variable "+H+" depends on: ";var Y=[];let Se=[],it=[];mE(H,Y,[],Se,[],it);for(let xe of Array.from(Se))h.DEBUG&&console.log(`    --> cycle through ${xe}`);for(let xe of Array.from(Y))h.DEBUG&&console.log(`    ${xe}`),_+=xe+", ";_+="; ";for(let xe of Array.from(it))_+=" "+xe+", ";h.DEBUG&&console.log(`  code generation:${H} is: ${Br.get_binding(Br.usr_symbol(H))}`),wt.push(Br.get_binding(Br.usr_symbol(H)));let ct=[],Ye=[];for(let xe of Array.from(Y))if(xe[0]==="'"){let We=xe.substring(1),_t=Br.usr_symbol(We),hr=Br.usr_symbol("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE"+We);ct.push(_t),Ye.push(hr),wt.push(fd.subst(wt.pop(),_t,hr)),h.DEBUG&&console.log(`after substitution: ${wt.top()}`)}try{wt.push(ZU.simplifyForCodeGeneration(wt.pop()))}catch(xe){h.PRINTOUTRESULT&&console.log(xe),h.defs.errorMessage=xe+"",dd.init()}for(let xe=0;xe<ct.length;xe++)wt.push(fd.subst(wt.pop(),Ye[xe],ct[xe]));if(Tb.clearRenamedVariablesToAvoidBindingToExternalScope(),h.defs.errorMessage===""){let xe=wt.pop(),We=[];Br.collectUserSymbols(xe,We),i="",l="",h.defs.codeGen=!0;let _t=xe.toString();h.defs.codeGen=!1;let hr=h.defs.printMode;h.defs.printMode=h.PRINTMODE_LATEX;let _r=xe.toString();if(h.defs.printMode=hr,Se.indexOf(H)!==-1)R+="// "+H+" is part of a cyclic dependency, no code generated.",C+="#"+H+" is part of a cyclic dependency, no code generated.";else if(We=We.filter(At=>h.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(At+"")===-1),We=We.filter(At=>Y.indexOf(At+"")!==-1||Y.indexOf("'"+At+"")!==-1),We.length!==0){let At="(";for(let Fr of Array.from(We))Fr.printname!==H&&(At+=Fr.printname+", ");At=At.replace(/, $/gm,""),At+=")",R+=H+" = function "+At+" { return ( "+_t+" ); }",C+=H+At+" = "+_r}else R+=H+" = "+_t+";",C+=H+" = "+_r;R+=`
`,C+=`
`,h.DEBUG&&console.log(`    ${R}`)}}}return R=R.replace(/\n$/gm,""),C=C.replace(/\n$/gm,""),h.defs.symbolsDependencies={},h.defs.symbolsHavingReassignments=[],h.defs.patternHasBeenFound=!1,h.defs.symbolsInExpressionsWithoutAssignments=[],h.DEBUG&&console.log(`testable string: ${_}`),md&&console.log(`findDependenciesInScript time for: ${d} : ${new Date().getTime()-r}ms`),[_,L[0],R,C,L[1],h.defs.errorMessage,c]}mr.findDependenciesInScript=Mb;function mE(e,t,r,n,s,i){if(r.push(e),h.defs.symbolsDependencies[s[s.length-1]]!=null&&h.defs.symbolsDependencies[s[s.length-1]].indexOf("'"+e)!==-1){h.DEBUG&&console.log("can't keep following the chain of "+e+" because it's actually a variable bound to a parameter"),t.indexOf("'"+e)===-1&&t.indexOf(e)===-1&&t.push(e);return}if(s.push(e),h.defs.symbolsDependencies[e]==null)t.indexOf(e)===-1&&t.push(e);else for(let l of Array.from(h.defs.symbolsDependencies[e]))if(s.indexOf(l)!==-1){h.DEBUG&&console.log("  found cycle:");let u="";for(let c of Array.from(s))n.indexOf(c)===-1&&n.push(c),h.DEBUG&&console.log(c+" --> "),u+=c+" --> ";h.DEBUG&&console.log(` ... then ${l} again`),u+=" ... then "+l+" again",i.push(u),n.indexOf(l)===-1&&n.push(l)}else mE(l,t,r,n,s,i),s.pop()}var XU="\\rlap{\\large\\color{red}\\bigtriangleup}{\\ \\ \\tiny\\color{red}!}";function Nb(e){return e=e.replace(/\n/g,""),e=e.replace(/_/g,"} \\_ \\text{"),e=e.replace(new RegExp(String.fromCharCode(h.transpose_unicode),"g"),"}{}^{T}\\text{"),e=e.replace(new RegExp(String.fromCharCode(h.dotprod_unicode),"g"),"}\\cdot \\text{"),e=e.replace("Stop:","}  \\quad \\text{Stop:"),e=e.replace("->","}  \\rightarrow \\text{"),e=e.replace("?","}\\enspace "+XU+" \\enspace  \\text{"),e="$$\\text{"+e.replace(/\n/g,"")+"}$$",e}function Ib(e){return e=e.replace(new RegExp(String.fromCharCode(8901),"g"),String.fromCharCode(h.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(8226),"g"),String.fromCharCode(h.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(12539),"g"),String.fromCharCode(h.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(55296),"g"),String.fromCharCode(h.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(65381),"g"),String.fromCharCode(h.dotprod_unicode)),e}var md=!1;function _E(e,t=!1){let r,n,s,i=new Date().getTime();e=Ib(e),h.defs.inited||(h.defs.inited=!0,dd.init());let l=0,u=0,c="",d="",_,L;for(;;){try{h.defs.errorMessage="",Fa(),l=dE.scan(e.substring(u)),r=wt.pop(),Fa()}catch(C){h.PRINTOUTRESULT&&console.log(C),c+=C.message,t&&(d+=Nb(C.message)),h.reset_after_error();break}if(l===0)break;u+=l,wt.push(r);let R=!1;try{h.defs.stringsEmittedByUserPrintouts="",bE(),n=wt.pop(),Fa(),h.isstr(n)&&(h.DEBUG&&console.log(n.str),h.DEBUG&&console.log(`
`)),n===h.symbol(h.NIL)?(L=h.defs.stringsEmittedByUserPrintouts,t&&(_="$$"+h.defs.stringsEmittedByUserPrintouts+"$$")):(L=fE.print_expr(n),L+=`
`,t&&(_="$$"+fE.collectLatexStringFromReturnValue(n)+"$$",h.DEBUG&&console.log(`collectedLatexResult: ${_}`))),c+=L,t&&(d+=_),h.PRINTOUTRESULT&&(h.DEBUG&&console.log("printline"),h.DEBUG&&console.log(L)),h.PRINTOUTRESULT&&(h.DEBUG&&console.log("display:"),VU.print2dascii(n)),t&&(d+=`
`)}catch(C){R=!0,L=C.message,t&&(_=Nb(C.message)),h.PRINTOUTRESULT&&console.log(L),c+=L,L!==""&&(c+=`
`),t&&(d+=_,d+=`
`),dd.init()}}if(c[c.length-1]===`
`&&(c=c.substring(0,c.length-1)),t&&d[d.length-1]===`
`&&(d=d.substring(0,d.length-1)),t?(h.DEBUG&&console.log(`allReturnedLatexStrings: ${d}`),s=[c,d]):s=c,md){let R="run time on: "+e+" : "+(new Date().getTime()-i)+"ms";console.log(R)}return c="",d="",s}mr.run=_E;function Fa(){h.defs.tos!==0&&(h.breakpoint,Wi("stack error")),h.defs.frame!==h.TOS&&(h.breakpoint,Wi("frame error")),h.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.length!==0&&(h.breakpoint,Wi("symbols evaluation still ongoing?")),h.defs.evaluatingAsFloats&&(h.breakpoint,Wi("numeric evaluation still ongoing?")),h.defs.evaluatingPolar&&(h.breakpoint,Wi("evaluation of polar still ongoing?"))}mr.check_stack=Fa;function bE(){h.DEBUG&&console.log("#### top level eval"),h.defs.trigmode=0;let e=h.symbol(h.AUTOEXPAND);h.defs.expanding=!lu.isZeroAtomOrTensor(Br.get_binding(e));let t=wt.top();wt.push(YU.Eval(wt.pop()));let r=wt.top();if(r!==h.symbol(h.NIL)){if(Br.set_binding(h.symbol(h.LAST),r),!lu.isZeroAtomOrTensor(Br.get_binding(h.symbol(h.BAKE)))){let n=zU.bake(wt.pop());r=n,wt.push(n)}(t===h.symbol(h.SYMBOL_I)||t===h.symbol(h.SYMBOL_J))&&lu.isimaginaryunit(r)||(lu.isimaginaryunit(Br.get_binding(h.symbol(h.SYMBOL_J)))?wt.push(fd.subst(wt.pop(),h.Constants.imaginaryunit,h.symbol(h.SYMBOL_J))):lu.isimaginaryunit(Br.get_binding(h.symbol(h.SYMBOL_I)))&&wt.push(fd.subst(wt.pop(),h.Constants.imaginaryunit,h.symbol(h.SYMBOL_I))))}}mr.top_level_eval=bE;function HU(){h.defs.esc_flag&&Wi("esc key")}mr.check_esc_flag=HU;function QU(e){let t,r;h.DEBUG&&console.log("computeDependenciesFromAlgebra!!!");let n=e,s=!0;if(h.defs.called_from_Algebra_block=!0,e=Ib(e),!s){h.defs.userSimplificationsInListForm=[];let i="";for(let l of Array.from(h.defs.userSimplificationsInListForm))i+="silentpattern("+h.car(l)+","+h.car(h.cdr(l))+","+h.car(h.cdr(h.cdr(l)))+`)
`;[t,r]=Tb.do_clearall(),e=i+e,h.DEBUG&&console.log("codeFromAlgebraBlock including patterns: "+e)}if(h.DEBUG){console.log("computeDependenciesFromAlgebra: patterns in the list --------------- ");for(let i of Array.from(h.defs.userSimplificationsInListForm))console.log(h.car(i)+","+h.cdr(i)+")");console.log("...end of list --------------- ")}return h.defs.called_from_Algebra_block=!1,Mb(e,!0)[6]}mr.computeDependenciesFromAlgebra=QU;function WU(e){let t,r,n,s,i,l,u,c,d,_=e,L=!0;h.defs.called_from_Algebra_block=!0;let R=new Date().getTime();md&&console.log(" --------- computeResultsAndJavaScriptFromAlgebra input: "+e+" at: "+new Date),e=Ib(e);let C=e;if(h.DEBUG){console.log("computeResultsAndJavaScriptFromAlgebra: patterns in the list --------------- ");for(i of Array.from(h.defs.userSimplificationsInListForm))console.log(h.car(i)+","+h.cdr(i)+")");console.log("...end of list --------------- ")}if(!L){h.defs.userSimplificationsInListForm=[];let Y="";for(i of Array.from(h.defs.userSimplificationsInListForm))Y+="silentpattern("+h.car(i)+","+h.car(h.cdr(i))+","+h.car(h.cdr(h.cdr(i)))+`)
`;[t,r]=Tb.do_clearall(),e=Y+e,h.DEBUG&&console.log("codeFromAlgebraBlock including patterns: "+e)}return[d,c,n,u,l,h.defs.errorMessage,s]=Mb(e),h.defs.called_from_Algebra_block=!1,(u!==""||h.defs.errorMessage!=="")&&(c+=`
`+u,h.defs.errorMessage!==""&&(c+=`
`+h.defs.errorMessage),c=c.replace(/\n/g,`

`),l+=`
$$`+u+"$$",h.defs.errorMessage!==""&&(l+=Nb(h.defs.errorMessage)),l=l.replace(/\n/g,`

`)),l=l.replace(/\n*/,""),l=l.replace(/\$\$\$\$\n*/g,""),n=n.replace(/Math\./g,""),n=n.replace(/\n/g,`

`),md&&console.log("computeResultsAndJavaScriptFromAlgebra time (total time from notebook and back) for: "+C+" : "+(new Date().getTime()-R)+"ms"),{code:n,result:l,latexResult:l,dependencyInfo:s}}mr.computeResultsAndJavaScriptFromAlgebra=WU});var B=N(Ft=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.dupl=Ft.swap=Ft.restore=Ft.save=Ft.pop_n_items=Ft.pop=Ft.top=Ft.moveTos=Ft.push_all=Ft.push=void 0;var _d=Oe(),ne=w(),gE=0;function ja(e){return e==null&&ne.breakpoint,e===ne.symbol(ne.NIL)&&(gE++,ne.DEBUG&&console.log(`pushing symbol(NIL) #${gE}`)),ne.defs.tos>=ne.defs.frame&&_d.stop("stack overflow"),ne.defs.stack[ne.defs.tos++]=e}Ft.push=ja;function JU(e){for(;e.length>0;)ja(e.shift())}Ft.push_all=JU;function KU(e){if(ne.defs.tos<=e){ne.defs.tos=e;return}for(;ne.defs.tos>e;)ne.defs.stack[ne.defs.tos]=null,ne.defs.tos--}Ft.moveTos=KU;function yE(){return ne.defs.stack[ne.defs.tos-1]}Ft.top=yE;function uu(){ne.defs.tos===0&&(ne.breakpoint,_d.stop("stack underflow")),yE()==null&&ne.breakpoint;let e=ne.defs.stack[--ne.defs.tos];return ne.defs.stack[ne.defs.tos]=null,e}Ft.pop=uu;function eB(e){let t=[];for(let r=0;r<e;r++)t.push(uu());return t}Ft.pop_n_items=eB;function tB(){let e,t,r,n,s,i,l,u,c,d;ne.defs.frame-=10,ne.defs.frame<ne.defs.tos&&(ne.breakpoint,_d.stop("frame overflow, circular reference?")),ne.defs.stack[ne.defs.frame+0]=e,ne.defs.stack[ne.defs.frame+1]=t,ne.defs.stack[ne.defs.frame+2]=r,ne.defs.stack[ne.defs.frame+3]=n,ne.defs.stack[ne.defs.frame+4]=s,ne.defs.stack[ne.defs.frame+5]=i,ne.defs.stack[ne.defs.frame+6]=l,ne.defs.stack[ne.defs.frame+7]=u,ne.defs.stack[ne.defs.frame+8]=c,ne.defs.stack[ne.defs.frame+9]=d}Ft.save=tB;function rB(){let e,t,r,n,s,i,l,u,c,d;return ne.defs.frame>ne.TOS-10&&_d.stop("frame underflow"),e=ne.defs.stack[ne.defs.frame+0],t=ne.defs.stack[ne.defs.frame+1],r=ne.defs.stack[ne.defs.frame+2],n=ne.defs.stack[ne.defs.frame+3],s=ne.defs.stack[ne.defs.frame+4],i=ne.defs.stack[ne.defs.frame+5],l=ne.defs.stack[ne.defs.frame+6],u=ne.defs.stack[ne.defs.frame+7],c=ne.defs.stack[ne.defs.frame+8],d=ne.defs.stack[ne.defs.frame+9],ne.defs.frame+=10}Ft.restore=rB;function nB(){let e=uu(),t=uu();ja(e),ja(t)}Ft.swap=nB;function sB(){let e=uu();return ja(e),ja(e)}Ft.dupl=sB});var w=N(o=>{"use strict";var iB=o&&o.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o,"__esModule",{value:!0});o.evalFloats=o.evalPolar=o.doexpand=o.noexpand=o.Constants=o.$=o.reset_after_error=o.MEQUAL=o.MZERO=o.MSIGN=o.isidentitymatrix=o.isinv=o.istranspose=o.isinnerordot=o.isfactorial=o.ispower=o.ismultiply=o.isadd=o.caddaddr=o.cdddaddr=o.caddadr=o.cddaddr=o.cadaddr=o.caddddr=o.cddddr=o.cadddr=o.cdaddr=o.caddar=o.cadadr=o.caaddr=o.cdddr=o.cddar=o.cdadr=o.cadar=o.caddr=o.caadr=o.cddr=o.cdar=o.cadr=o.caar=o.cdr=o.car=o.iskeyword=o.issymbol=o.isNumericAtomOrTensor=o.istensor=o.isstr=o.isNumericAtom=o.isdouble=o.isrational=o.iscons=o.symbol=o.dotprod_unicode=o.transpose_unicode=o.isSymbolReclaimable=o.binding=o.symtab=o.logbuf=o.mtotal=o.primetab=o.parse_time_simplifications=o.predefinedSymbolsInGlobalScope_doNotTrackInDependencies=o.MAXDIM=o.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE=o.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES=o.MAXPRIMETAB=o.TOS=o.E=o.C6=o.C5=o.C4=o.C3=o.C2=o.C1=o.SYMBOL_X_UNDERSCORE=o.SYMBOL_B_UNDERSCORE=o.SYMBOL_A_UNDERSCORE=o.SYMBOL_IDENTITY_MATRIX=o.SYMBOL_Z=o.SYMBOL_Y=o.SYMBOL_X=o.SYMBOL_T=o.SYMBOL_S=o.SYMBOL_R=o.SYMBOL_N=o.SYMBOL_J=o.SYMBOL_I=o.SYMBOL_D=o.SYMBOL_C=o.SYMBOL_B=o.SYMBOL_A=o.PI=o.VERSION=o.SECRETX=o.METAX=o.METAB=o.METAA=o.DRAWX=o.YYE=o.MAX_FIXED_PRINTOUT_DIGITS=o.FORCE_FIXED_PRINTOUT=o.TRACE=o.ASSUME_REAL_VARIABLES=o.BAKE=o.AUTOEXPAND=o.LAST_PLAIN_PRINT=o.LAST_LIST_PRINT=o.LAST_LATEX_PRINT=o.LAST_FULL_PRINT=o.LAST_2DASCII_PRINT=o.LAST_PRINT=o.LAST=o.NIL=o.ZERO=o.UNIT=o.TRANSPOSE=o.TESTLT=o.TESTLE=o.TESTGT=o.TESTGE=o.TESTEQ=o.TEST=o.TAYLOR=o.TANH=o.TAN=o.SYMBOLSINFO=o.SUM=o.SUBST=o.STOP=o.SQRT=o.SHAPE=o.SINH=o.SIN=o.SIMPLIFY=o.SILENTPATTERN=o.SGN=o.SETQ=o.ROOTS=o.YYRECT=o.ROUND=o.REAL=o.RATIONALIZE=o.RANK=o.QUOTIENT=o.QUOTE=o.PRODUCT=o.PRINTPLAIN=o.PRINTLIST=o.PRINTLATEX=o.PRINTFULL=o.PRINT2DASCII=o.PRINT=o.PRINT_LEAVE_X_ALONE=o.PRINT_LEAVE_E_ALONE=o.PRIME=o.POWER=o.POLAR=o.PATTERNSINFO=o.PATTERN=o.OUTER=o.OR=o.OPERATOR=o.NUMERATOR=o.NUMBER=o.NROOTS=o.NOT=o.MULTIPLY=o.MOD=o.LOOKUP=o.LOG=o.LEGENDRE=o.LEADING=o.LCM=o.LAGUERRE=o.ISPRIME=o.ISINTEGER=o.INVG=o.INV=o.INTEGRAL=o.INNER=o.INDEX=o.IMAG=o.HILBERT=o.HERMITE=o.GCD=o.GAMMA=o.FUNCTION=o.FOR=o.FLOOR=o.FLOATF=o.FILTER=o.FACTORPOLY=o.FACTORIAL=o.FACTOR=o.EXPSIN=o.EXPCOS=o.EXPAND=o.EXP=o.EVAL=o.ERFC=o.ERF=o.EIGENVEC=o.EIGENVAL=o.EIGEN=o.DSOLVE=o.DRAW=o.DOT=o.DO=o.DIVISORS=o.DIRAC=o.DIM=o.DET=o.DERIVATIVE=o.DENOMINATOR=o.DEGREE=o.DEFINT=o.DECOMP=o.COSH=o.COS=o.CONTRACT=o.CONJ=o.CONDENSE=o.COFACTOR=o.COEFF=o.CLOCK=o.CLEARPATTERNS=o.CLEARALL=o.CLEAR=o.CIRCEXP=o.CHOOSE=o.CHECK=o.CEILING=o.BINOMIAL=o.BINDING=o.BESSELY=o.BESSELJ=o.ATOMIZE=o.ARG=o.ARCTANH=o.ARCTAN=o.ARCSINH=o.ARCSIN=o.ARCCOSH=o.ARCCOS=o.APPROXRATIO=o.AND=o.ADJ=o.ADD=o.ABS=o.SYM=o.TENSOR=o.STR=o.DOUBLE=o.NUM=o.CONS=o.Sym=o.Tensor=o.Str=o.Double=o.Num=o.Cons=o.BaseAtom=o.avoidCalculatingPowersIntoArctans=o.do_simplify_nested_radicals=o.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication=o.defs=o.PRINTMODE_LIST=o.PRINTMODE_HUMAN=o.PRINTMODE_COMPUTER=o.PRINTMODE_2DASCII=o.PRINTMODE_LATEX=o.PRINTOUTRESULT=o.DEBUG=o.NSYM=o.version=o.breakpoint=void 0;var bd=iB(Ps()),oB=B(),vE=Nn(),aB=dt();function pE(){}o.breakpoint=pE;o.version="1.3.1";o.NSYM=1e3;o.DEBUG=!1;o.PRINTOUTRESULT=!1;o.PRINTMODE_LATEX="PRINTMODE_LATEX";o.PRINTMODE_2DASCII="PRINTMODE_2DASCII";o.PRINTMODE_COMPUTER="PRINTMODE_COMPUTER";o.PRINTMODE_HUMAN="PRINTMODE_HUMAN";o.PRINTMODE_LIST="PRINTMODE_LIST";var qE=class{constructor(){this.printMode=o.PRINTMODE_COMPUTER,this.recursionLevelNestedRadicalsRemoval=0,this.errorMessage="",this.symbolsDependencies={},this.symbolsHavingReassignments=[],this.symbolsInExpressionsWithoutAssignments=[],this.patternHasBeenFound=!1,this.inited=!1,this.chainOfUserSymbolsNotFunctionsBeingEvaluated=[],this.stringsEmittedByUserPrintouts="",this.called_from_Algebra_block=!1,this.tos=0,this.expanding=!1,this.evaluatingAsFloats=!1,this.evaluatingPolar=!1,this.esc_flag=!1,this.trigmode=0,this.stack=[],this.frame=0,this.out_count=0,this.test_flag=!1,this.codeGen=!1,this.userSimplificationsInListForm=[],this.userSimplificationsInStringForm=[],this.fullDoubleOutput=!1}};o.defs=new qE;o.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication=!0;o.do_simplify_nested_radicals=!0;o.avoidCalculatingPowersIntoArctans=!0;var mi=class{toString(){return vE.print_expr(this)}toLatexString(){return vE.collectLatexStringFromReturnValue(this)}};o.BaseAtom=mi;var gd=class extends mi{constructor(t,r){super();this.k=o.CONS,this.cons={car:t,cdr:r}}*[Symbol.iterator](){let t=this;for(;Ya(t);)yield $e(t),t=_e(t)}tail(){return Ya(this.cons.cdr)?[...this.cons.cdr]:[]}map(t){let r=$e(this),n=_e(this);return Ya(n)&&(n=n.map(t)),new gd(t(r),n)}};o.Cons=gd;var cu=class extends mi{constructor(t,r=bd.default.one){super();this.a=t,this.b=r,this.q=this,this.k=o.NUM}};o.Num=cu;var za=class extends mi{constructor(t){super();this.d=t,this.k=o.DOUBLE}};o.Double=za;var EE=class extends mi{constructor(t){super();this.str=t,this.k=o.STR}};o.Str=EE;var xE=class extends mi{constructor(){super(...arguments);this.tensor=this,this.k=o.TENSOR,this.ndim=0,this.dim=[],this.elem=[]}get nelem(){return this.elem.length}};o.Tensor=xE;var hE=class extends mi{constructor(t){super();this.printname=t,this.k=o.SYM}};o.Sym=hE;o.CONS=0;o.NUM=1;o.DOUBLE=2;o.STR=3;o.TENSOR=4;o.SYM=5;var q=0;o.ABS=q++;o.ADD=q++;o.ADJ=q++;o.AND=q++;o.APPROXRATIO=q++;o.ARCCOS=q++;o.ARCCOSH=q++;o.ARCSIN=q++;o.ARCSINH=q++;o.ARCTAN=q++;o.ARCTANH=q++;o.ARG=q++;o.ATOMIZE=q++;o.BESSELJ=q++;o.BESSELY=q++;o.BINDING=q++;o.BINOMIAL=q++;o.CEILING=q++;o.CHECK=q++;o.CHOOSE=q++;o.CIRCEXP=q++;o.CLEAR=q++;o.CLEARALL=q++;o.CLEARPATTERNS=q++;o.CLOCK=q++;o.COEFF=q++;o.COFACTOR=q++;o.CONDENSE=q++;o.CONJ=q++;o.CONTRACT=q++;o.COS=q++;o.COSH=q++;o.DECOMP=q++;o.DEFINT=q++;o.DEGREE=q++;o.DENOMINATOR=q++;o.DERIVATIVE=q++;o.DET=q++;o.DIM=q++;o.DIRAC=q++;o.DIVISORS=q++;o.DO=q++;o.DOT=q++;o.DRAW=q++;o.DSOLVE=q++;o.EIGEN=q++;o.EIGENVAL=q++;o.EIGENVEC=q++;o.ERF=q++;o.ERFC=q++;o.EVAL=q++;o.EXP=q++;o.EXPAND=q++;o.EXPCOS=q++;o.EXPSIN=q++;o.FACTOR=q++;o.FACTORIAL=q++;o.FACTORPOLY=q++;o.FILTER=q++;o.FLOATF=q++;o.FLOOR=q++;o.FOR=q++;o.FUNCTION=q++;o.GAMMA=q++;o.GCD=q++;o.HERMITE=q++;o.HILBERT=q++;o.IMAG=q++;o.INDEX=q++;o.INNER=q++;o.INTEGRAL=q++;o.INV=q++;o.INVG=q++;o.ISINTEGER=q++;o.ISPRIME=q++;o.LAGUERRE=q++;o.LCM=q++;o.LEADING=q++;o.LEGENDRE=q++;o.LOG=q++;o.LOOKUP=q++;o.MOD=q++;o.MULTIPLY=q++;o.NOT=q++;o.NROOTS=q++;o.NUMBER=q++;o.NUMERATOR=q++;o.OPERATOR=q++;o.OR=q++;o.OUTER=q++;o.PATTERN=q++;o.PATTERNSINFO=q++;o.POLAR=q++;o.POWER=q++;o.PRIME=q++;o.PRINT_LEAVE_E_ALONE=q++;o.PRINT_LEAVE_X_ALONE=q++;o.PRINT=q++;o.PRINT2DASCII=q++;o.PRINTFULL=q++;o.PRINTLATEX=q++;o.PRINTLIST=q++;o.PRINTPLAIN=q++;o.PRODUCT=q++;o.QUOTE=q++;o.QUOTIENT=q++;o.RANK=q++;o.RATIONALIZE=q++;o.REAL=q++;o.ROUND=q++;o.YYRECT=q++;o.ROOTS=q++;o.SETQ=q++;o.SGN=q++;o.SILENTPATTERN=q++;o.SIMPLIFY=q++;o.SIN=q++;o.SINH=q++;o.SHAPE=q++;o.SQRT=q++;o.STOP=q++;o.SUBST=q++;o.SUM=q++;o.SYMBOLSINFO=q++;o.TAN=q++;o.TANH=q++;o.TAYLOR=q++;o.TEST=q++;o.TESTEQ=q++;o.TESTGE=q++;o.TESTGT=q++;o.TESTLE=q++;o.TESTLT=q++;o.TRANSPOSE=q++;o.UNIT=q++;o.ZERO=q++;o.NIL=q++;o.LAST=q++;o.LAST_PRINT=q++;o.LAST_2DASCII_PRINT=q++;o.LAST_FULL_PRINT=q++;o.LAST_LATEX_PRINT=q++;o.LAST_LIST_PRINT=q++;o.LAST_PLAIN_PRINT=q++;o.AUTOEXPAND=q++;o.BAKE=q++;o.ASSUME_REAL_VARIABLES=q++;o.TRACE=q++;o.FORCE_FIXED_PRINTOUT=q++;o.MAX_FIXED_PRINTOUT_DIGITS=q++;o.YYE=q++;o.DRAWX=q++;o.METAA=q++;o.METAB=q++;o.METAX=q++;o.SECRETX=q++;o.VERSION=q++;o.PI=q++;o.SYMBOL_A=q++;o.SYMBOL_B=q++;o.SYMBOL_C=q++;o.SYMBOL_D=q++;o.SYMBOL_I=q++;o.SYMBOL_J=q++;o.SYMBOL_N=q++;o.SYMBOL_R=q++;o.SYMBOL_S=q++;o.SYMBOL_T=q++;o.SYMBOL_X=q++;o.SYMBOL_Y=q++;o.SYMBOL_Z=q++;o.SYMBOL_IDENTITY_MATRIX=q++;o.SYMBOL_A_UNDERSCORE=q++;o.SYMBOL_B_UNDERSCORE=q++;o.SYMBOL_X_UNDERSCORE=q++;o.C1=q++;o.C2=q++;o.C3=q++;o.C4=q++;o.C5=q++;o.C6=q++;var FF=q++;o.E=o.YYE;o.TOS=1e5;o.MAXPRIMETAB=1e4;o.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES=5;o.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE=10;o.MAXDIM=24;o.predefinedSymbolsInGlobalScope_doNotTrackInDependencies=["rationalize","abs","e","i","pi","sin","ceiling","cos","roots","integral","derivative","defint","sqrt","eig","cov","deig","dcov","float","floor","product","root","round","sum","test","unit"];o.parse_time_simplifications=!0;o.primetab=function(){let e=[2],t=3;for(;e.length<o.MAXPRIMETAB;){let r=0,n=Math.sqrt(t);for(;r<e.length&&e[r]<=n;){if(t%e[r]==0){r=-1;break}r++}r!==-1&&e.push(t),t+=2}return e[o.MAXPRIMETAB]=0,e}();var lB=!1;o.mtotal=0;o.logbuf="";o.symtab=[];o.binding=[];o.isSymbolReclaimable=[];o.transpose_unicode=7488;o.dotprod_unicode=183;function Gr(e){return o.symtab[e]}o.symbol=Gr;function Ya(e){return e.k===o.CONS}o.iscons=Ya;function AE(e){return e.k===o.NUM}o.isrational=AE;function OE(e){return e.k===o.DOUBLE}o.isdouble=OE;function TE(e){return AE(e)||OE(e)}o.isNumericAtom=TE;function uB(e){return e.k===o.STR}o.isstr=uB;function ME(e){return e.k===o.TENSOR}o.istensor=ME;function NE(e){if(TE(e)||e===Gr(o.SYMBOL_IDENTITY_MATRIX))return!0;if(!ME(e))return!1;let t=e.tensor.nelem,r=e.tensor.elem;for(let n=0;n<t;n++)if(!NE(r[n]))return!1;return!0}o.isNumericAtomOrTensor=NE;function IE(e){return e.k===o.SYM}o.issymbol=IE;function cB(e){return IE(e)&&aB.symnum(e)<o.NIL}o.iskeyword=cB;function $e(e){return Ya(e)?e.cons.car:Gr(o.NIL)}o.car=$e;function _e(e){return Ya(e)?e.cons.cdr:Gr(o.NIL)}o.cdr=_e;function fB(e){return $e($e(e))}o.caar=fB;function dB(e){return $e(_e(e))}o.cadr=dB;function mB(e){return _e($e(e))}o.cdar=mB;function _B(e){return _e(_e(e))}o.cddr=_B;function bB(e){return $e($e(_e(e)))}o.caadr=bB;function gB(e){return $e(_e(_e(e)))}o.caddr=gB;function yB(e){return $e(_e($e(e)))}o.cadar=yB;function vB(e){return _e($e(_e(e)))}o.cdadr=vB;function pB(e){return _e(_e($e(e)))}o.cddar=pB;function qB(e){return _e(_e(_e(e)))}o.cdddr=qB;function EB(e){return $e($e(_e(_e(e))))}o.caaddr=EB;function xB(e){return $e(_e($e(_e(e))))}o.cadadr=xB;function hB(e){return $e(_e(_e($e(e))))}o.caddar=hB;function AB(e){return _e($e(_e(_e(e))))}o.cdaddr=AB;function OB(e){return $e(_e(_e(_e(e))))}o.cadddr=OB;function TB(e){return _e(_e(_e(_e(e))))}o.cddddr=TB;function MB(e){return $e(_e(_e(_e(_e(e)))))}o.caddddr=MB;function NB(e){return $e(_e($e(_e(_e(e)))))}o.cadaddr=NB;function IB(e){return _e(_e($e(_e(_e(e)))))}o.cddaddr=IB;function SB(e){return $e(_e(_e($e(_e(e)))))}o.caddadr=SB;function RB(e){return _e(_e(_e($e(_e(_e(e))))))}o.cdddaddr=RB;function wB(e){return $e(_e(_e($e(_e(_e(e))))))}o.caddaddr=wB;function LB(e){return $e(e)===Gr(o.ADD)}o.isadd=LB;function CB(e){return $e(e)===Gr(o.MULTIPLY)}o.ismultiply=CB;function kB(e){return $e(e)===Gr(o.POWER)}o.ispower=kB;function PB(e){return $e(e)===Gr(o.FACTORIAL)}o.isfactorial=PB;function DB(e){return $e(e)===Gr(o.INNER)||$e(e)===Gr(o.DOT)}o.isinnerordot=DB;function $B(e){return $e(e)===Gr(o.TRANSPOSE)}o.istranspose=$B;function UB(e){return $e(e)===Gr(o.INV)}o.isinv=UB;function BB(e){return e===Gr(o.SYMBOL_IDENTITY_MATRIX)}o.isidentitymatrix=BB;function GB(e){return e.isPositive()?1:e.isZero()?0:-1}o.MSIGN=GB;function FB(e){return e.isZero()}o.MZERO=FB;function jB(e,t){return e==null,e.equals(t)}o.MEQUAL=jB;function zB(){oB.moveTos(0),o.defs.esc_flag=!1,lB=!1,o.defs.frame=o.TOS,o.defs.evaluatingAsFloats=!1,o.defs.evaluatingPolar=!1}o.reset_after_error=zB;o.$={};var xr=class{static One(){return o.defs.evaluatingAsFloats?xr.oneAsDouble:xr.one}static NegOne(){return o.defs.evaluatingAsFloats?xr.negOneAsDouble:xr.negOne}static Zero(){return o.defs.evaluatingAsFloats?xr.zeroAsDouble:xr.zero}static Pi(){return o.defs.evaluatingAsFloats?xr.piAsDouble:Gr(o.PI)}};o.Constants=xr;xr.one=new cu(bd.default(1));xr.oneAsDouble=new za(1);xr.negOne=new cu(bd.default(-1));xr.negOneAsDouble=new za(-1);xr.zero=new cu(bd.default(0));xr.zeroAsDouble=new za(0);xr.piAsDouble=new za(Math.PI);function YB(e,...t){let r=o.defs.expanding;o.defs.expanding=!1;try{return e(...t)}finally{o.defs.expanding=r}}o.noexpand=YB;function VB(e,...t){let r=o.defs.expanding;o.defs.expanding=!0;try{return e(...t)}finally{o.defs.expanding=r}}o.doexpand=VB;function ZB(e,...t){let r=o.defs.evaluatingPolar;o.defs.evaluatingPolar=!0;try{return e(...t)}finally{o.defs.evaluatingPolar=r}}o.evalPolar=ZB;function XB(e,...t){let r=o.defs.evaluatingAsFloats;o.defs.evaluatingAsFloats=!0;try{return e(...t)}finally{o.defs.evaluatingAsFloats=r}}o.evalFloats=XB});var LE=N(Va=>{"use strict";Object.defineProperty(Va,"__esModule",{value:!0});Va.exec=Va.parse=void 0;var yd=Oe(),Ji=B(),SE=Z(),HB=oe(),QB=Vs(),Ki=w(),WB=Vl(),RE=dt();Ki.defs.inited||(Ki.defs.inited=!0,WB.init());function wE(e){typeof e=="string"?QB.scan(e):typeof e=="number"?e%1==0?SE.push_integer(e):SE.push_double(e):e instanceof Ki.BaseAtom?Ji.push(e):(console.warn("unknown argument type",e),Ji.push(Ki.symbol(Ki.NIL)))}function JB(e){let t;try{wE(e),t=Ji.pop(),yd.check_stack()}catch(r){throw Ki.reset_after_error(),r}return t}Va.parse=JB;function KB(e,...t){let r,n=RE.get_binding(RE.usr_symbol(e));yd.check_stack(),Ji.push(n);for(let i of Array.from(t))wE(i);HB.list(1+t.length);let s=Ji.pop();Ji.push(s);try{yd.top_level_eval(),r=Ji.pop(),yd.check_stack()}catch(i){throw Ki.reset_after_error(),i}return r}Va.exec=KB});var kE=N(qd=>{"use strict";Object.defineProperty(qd,"__esModule",{value:!0});var Ie=w(),e4=br(),t4=Vl(),Za=B(),vd=dt(),Sb=LE(),jt=se(),CE=Re(),r4=Vs(),pd=Km(),n4=Hl(),s4=Oe(),z={};z.version=Ie.version;z.isadd=Ie.isadd;z.ismultiply=Ie.ismultiply;z.ispower=Ie.ispower;z.isfactorial=Ie.isfactorial;z.car=Ie.car;z.cdr=Ie.cdr;z.caar=Ie.caar;z.cadr=Ie.cadr;z.cdar=Ie.cdar;z.cddr=Ie.cddr;z.caadr=Ie.caadr;z.caddr=Ie.caddr;z.cadar=Ie.cadar;z.cdadr=Ie.cdadr;z.cddar=Ie.cddar;z.cdddr=Ie.cdddr;z.caaddr=Ie.caaddr;z.cadadr=Ie.cadadr;z.caddar=Ie.caddar;z.cdaddr=Ie.cdaddr;z.cadddr=Ie.cadddr;z.cddddr=Ie.cddddr;z.caddddr=Ie.caddddr;z.cadaddr=Ie.cadaddr;z.cddaddr=Ie.cddaddr;z.caddadr=Ie.caddadr;z.cdddaddr=Ie.cdddaddr;z.caddaddr=Ie.caddaddr;z.symbol=Ie.symbol;z.iscons=Ie.iscons;z.isrational=Ie.isrational;z.isdouble=Ie.isdouble;z.isNumericAtom=Ie.isNumericAtom;z.isstr=Ie.isstr;z.istensor=Ie.istensor;z.issymbol=Ie.issymbol;z.iskeyword=Ie.iskeyword;z.CONS=Ie.CONS;z.NUM=Ie.NUM;z.DOUBLE=Ie.DOUBLE;z.STR=Ie.STR;z.TENSOR=Ie.TENSOR;z.SYM=Ie.SYM;z.approxRadicals=pd.approxRadicals;z.approxRationalsOfLogs=pd.approxRationalsOfLogs;z.approxAll=pd.approxAll;z.testApprox=pd.testApprox;z.make_hashed_itab=n4.make_hashed_itab;z.isZeroAtomOrTensor=jt.isZeroAtomOrTensor;z.isnegativenumber=jt.isnegativenumber;z.isplusone=jt.isplusone;z.isminusone=jt.isminusone;z.isinteger=jt.isinteger;z.isnonnegativeinteger=jt.isnonnegativeinteger;z.isposint=jt.isposint;z.isnegativeterm=jt.isnegativeterm;z.isimaginarynumber=jt.isimaginarynumber;z.iscomplexnumber=jt.iscomplexnumber;z.iseveninteger=jt.iseveninteger;z.isnegative=jt.isnegative;z.issymbolic=jt.issymbolic;z.isintegerfactor=jt.isintegerfactor;z.isoneover=jt.isoneover;z.isfraction=jt.isfraction;z.isoneoversqrttwo=jt.isoneoversqrttwo;z.isminusoneoversqrttwo=jt.isminusoneoversqrttwo;z.isfloating=jt.isfloating;z.isimaginaryunit=jt.isimaginaryunit;z.isquarterturn=jt.isquarterturn;z.isnpi=jt.isnpi;z.equal=CE.equal;z.length=CE.length;z.scan=r4.scan;z.Find=e4.Find;z.dupl=Za.dupl;z.swap=Za.swap;z.restore=Za.restore;z.save=Za.save;z.push=Za.push;z.pop=Za.pop;z.get_binding=vd.get_binding;z.set_binding=vd.set_binding;z.usr_symbol=vd.usr_symbol;z.collectUserSymbols=vd.collectUserSymbols;z.init=t4.init;z.exec=Sb.exec;z.parse=Sb.parse;z.run=s4.run;var i4=["abs","add","adj","and","approxratio","arccos","arccosh","arcsin","arcsinh","arctan","arctanh","arg","atomize","besselj","bessely","binding","binomial","ceiling","check","choose","circexp","clear","clearall","clearpatterns","clock","coeff","cofactor","condense","conj","contract","cos","cosh","decomp","defint","deg","denominator","det","derivative","dim","dirac","divisors","do","dot","draw","dsolve","eigen","eigenval","eigenvec","erf","erfc","eval","exp","expand","expcos","expsin","factor","factorial","factorpoly","filter","float","floor","for","Gamma","gcd","hermite","hilbert","imag","component","inner","integral","inv","invg","isinteger","isprime","laguerre","lcm","leading","legendre","log","mod","multiply","not","nroots","number","numerator","operator","or","outer","pattern","patternsinfo","polar","power","prime","print","print2dascii","printcomputer","printlatex","printlist","printhuman","product","quote","quotient","rank","rationalize","real","rect","roots","round","equals","shape","sgn","silentpattern","simplify","sin","sinh","sqrt","stop","subst","sum","symbolsinfo","tan","tanh","taylor","test","testeq","testge","testgt","testle","testlt","transpose","unit","zero"];Array.from(i4).map(e=>z[e]=Sb.exec.bind(qd,e));qd.default=z});var PE=HE(kE());globalThis.Algebrite=PE.default;})();
//# sourceMappingURL=algebrite.bundle-for-browser-min.js.map